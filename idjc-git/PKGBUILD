# Contributor: Tobias Luther <tobias [at] tonstrom [dot] de>

pkgname=idjc-git
pkgver=20120201
pkgrel=1
pkgdesc="A graphical shoutcast and icecast client that runs under GTK+ and the JACK audio connection kit. In short, it's an Internet radio app for making a live radio show."
arch=(i686 x86_64)
url="http://idjc.sourceforge.net/"
depends=('python2' 'jack' 'pygtk' 'lame' 'mutagen' 'flac' 'faad2' 'libsamplerate' 'libshout' 'vorbis-tools' 'libsndfile' 'ffmpeg' 'libmad' 
'speex' 'dbus-python')
makedepends=('pkgconfig' 'git' 'imagemagick')
optdepends=('patchage' 'qjackctl')
conflicts=('idjc')

_gitroot="git://idjc.git.sourceforge.net/gitroot/idjc/idjc"
_gitname="idjc"

md5sums=('eeb2c55443f753f9244eaac006cce132')
license=('GPLv3')

build()
{
  msg "Connecting to GIT server...."

  if [ -d $_gitname ] ; then
    cd $_gitname && git pull origin
    msg "The local files are updated."
  else
    git clone $_gitroot $_gitname
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  rm -rf "$srcdir/$_gitname-build"
  git clone -l "$srcdir/$_gitname" "$srcdir/$_gitname-build"
  cd "$srcdir/$_gitname-build"
	
        
        ./env-up 
        ./configure --prefix=/usr CFLAGS="-O2" PYTHON="/usr/bin/python2"
              make || return 1
                make DESTDIR=$pkgdir install
        cd $pkgdir/usr/bin
	sed -i -e 's/python22.7/python2/' idjc
}


