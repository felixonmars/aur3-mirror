# Maintainer: Thiago Coutinho <root ＠ thiagoc · net>
# Contributor: Marti Raudsepp <marti@juffo.org>
# Contributor: Sonny Piers <sonny <AT> fastmail <DOT> net>
# Submitter: sputnick <gilles.quenot <AT> gmail <DOT> com>

pkgname=pjsua
pkgver=2.2.1
pkgrel=1
pkgdesc="Open source command line SIP user agent"
arch=(i686 x86_64)
url="http://www.pjsip.org/pjsua.htm"
depends=(ffmpeg)
license=('GPL')
source=(http://www.pjsip.org/release/$pkgver/pjproject-$pkgver.tar.bz2)
 
build() {
  cd $srcdir/pjproject-$pkgver
  # make -j breaks the build
  export MAKEFLAGS=
  ./configure --prefix=/usr
  #make dep
  # workaround to work with latest ffmpeg
  sed -i "s/enum CodecID/enum AVCodecID/g" pjmedia/src/pjmedia/ffmpeg_util.c
  sed -i "s/enum CodecID/enum AVCodecID/g" pjmedia/src/pjmedia/ffmpeg_util.h
  make
}
package() {
  cd $srcdir/pjproject-$pkgver
  make DESTDIR=$pkgdir install
  install -D -m755 pjsip-apps/bin/pjsua-*gnu $pkgdir/usr/bin/pjsua
}
md5sums=('6ed4bb7750c827dc1d881e209a3b62db')
