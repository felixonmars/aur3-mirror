# Maintainer: Joel Teichroeb <joel@teichroeb.net>

pkgname=libxkbcommon-git
pkgver=20121023
pkgrel=1
pkgdesc="A library to handle keyboard descriptions."
url="http://xkbcommon.org/"
arch=(i686 x86_64)
license=('custom')
makedepends=('git' 'xorg-util-macros')
provides=('libxkbcommon')
replaces=('libxkbcommon')
conflicts=('libxkbcommon')
options=(!libtool)

_gitroot="git://anongit.freedesktop.org/xorg/lib/libxkbcommon"
_gitname="libxkbcommon"

build() {
	msg 'Connecting to git.freedesktop.org GIT server....'

	if [ -d ${_gitname} ] ; then
		cd ${_gitname} && git pull origin master
	else
		git clone ${_gitroot} --depth 1
	fi
	msg 'GIT checkout done or server timeout'
	msg 'Starting make...'

	# Cleanup and prepare the build dir
	rm -rf ${srcdir}/build
	cp -r ${srcdir}/${_gitname} ${srcdir}/build
	cd ${srcdir}/build

	./autogen.sh --prefix=/usr
	make
}

package() {
	cd ${srcdir}/build

	make DESTDIR=${pkgdir} install
}
