# Maintainer: Chris Brannon <cmbrannon79@gmail.com>
# Contributor: giniu <gginiu@gmail.com>

pkgname=python-foolscap-i2p
pkgver=0.6.4
pkgrel=1
pkgdesc="RPC protocol for Python and Twisted over the I2P network"
url="http://foolscap.lothar.com"
license=('MIT')
arch=('any')
conflicts=("python-foolscap")
provides=("python-foolscap")
options=(!emptydirs)

depends=('twisted'
         'python2'
         'python2-pyopenssl')
makedepends=('python2-distribute')

#Local copy of the patch will be kept in the source in case kytv or the inproxy dies
_patchver="${pkgver}-r3"
source=("http://foolscap.lothar.com/releases/foolscap-${pkgver}.tar.gz"
        "http://foolscap.lothar.com/releases/foolscap-${pkgver}.tar.gz.asc"
        "http://killyourtv.i2p.to/tahoe-lafs/patches/foolscap-i2p-${_patchver}.patch"
        "foolscap-i2p-${_patchver}.patch")

sha256sums=('74b283dd68a3c9d68ebf4e9b4ebf5cfb37480915b6a808ac930fe858a66f8d99'
            'b43da5e62edf04bf08acf060b3c01f97ac6d148bdcbffe95d42f39931c39feed'
            '5cb7ba3da1b598cbce1648d620cca6a529b254328b1706cb826b0b5698aba127'
            '5cb7ba3da1b598cbce1648d620cca6a529b254328b1706cb826b0b5698aba127')

build() {
    cd "$srcdir/foolscap-$pkgver"
    patch -Np1 -i ${srcdir}/foolscap-i2p-${_patchver}.patch
    python2 setup.py install --prefix=/usr --root="$pkgdir" --optimize=1
}

package() {
  cd "$srcdir/foolscap-$pkgver"
  install -Dm644 LICENSE "$pkgdir/usr/share/licenses/${pkgname}/LICENSE"
}
