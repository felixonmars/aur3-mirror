pkgname=tome4
pkgver='1.0.0beta33'
pkgrel=1
pkgdesc="An open-source, single-player, role-playing roguelike game set in the world of Eyal."
arch=('i686' 'x86_64')
url="http://tome.te4.org/"
license=('GPL3')
depends=('mesa' 'sdl-hg' 'sdl_image' 'sdl_ttf' 'sdl_mixer' 'openal')
makedepends=('premake4')
options=(!makeflags)
source=("http://te4.org/dl/t-engine/t-engine4-src-${pkgver}.tar.bz2"
        'tome4'
        'premake4.patch'
        'te4core.patch')
md5sums=('8ffdb001426a297aa1026c8b46cc71dd'
         '3b1f65ee2f52c2fbf5f732db229e879a'
         '17ad27a102a798a80701ea5b660825b0'
         '69a3e198f58d7bfd1676a05fee4c43e0')

build() {
    cd "${srcdir}/t-engine4-src-$pkgver"

    patch -p2 < "${srcdir}/premake4.patch"
    patch -p2 < "${srcdir}/te4core.patch"

    premake4 gmake
    make
}
package() {
    cd "${srcdir}/t-engine4-src-$pkgver"

    install -d "${pkgdir}/opt/tome4/"

    cp -r bootstrap/ game/ CONTRIBUTING COPYING CREDITS bin/Debug/t-engine \
        "${pkgdir}/opt/tome4/"

    install -Dm755 "${srcdir}/${pkgname}" "${pkgdir}/usr/bin/${pkgname}"
}
