# Maintainer: Dan Serban
# Contributor: D. Can Celasun <dcelasun[at]gmail[dot]com>

pkgname=plank-bzr
pkgver=latest
pkgrel=1
pkgdesc="A stupidly simple dock"
arch=(i686 x86_64)
url=https://launchpad.net/plank
license=(GPL)
depends=(bamf-bin glib2 gtk2 libgee libunique libwnck libx11)
makedepends=(bamf-bin bzr dbus-glib gnome-common intltool vala)
install=plank-bzr.install

_bzrtrunk=lp:plank
_bzrmod=plank

build()
{
  msg "Connecting to Launchpad..."
  if [ -d ${_bzrmod} ]; then
    bzr up ${_bzrmod}
    msg2 "The local files have been updated."
  else
    bzr co ${_bzrtrunk} ${_bzrmod}
  fi
  msg2 "BZR checkout done or server timeout"
  [ -d ${_bzrmod}-build ] && rm -r ${_bzrmod}-build
  cp -a ${_bzrmod} ${_bzrmod}-build
  cd ${_bzrmod}-build
  ./autogen.sh
  make
  make DESTDIR="${pkgdir}" install
  cd "${pkgdir}"/usr
  mv local/* .
  rm -r local
}

