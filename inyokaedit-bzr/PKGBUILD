# Maintainer: Markus Holtermann <aur@markusholtermann.eu>
pkgname=inyokaedit-bzr
pkgver=20120404
pkgrel=1
pkgdesc='A small markup editor for Inyoka articles (http://ubuntuusers.de/inyoka/). It includes syntax highlighting, offline preview, downloading raw text of existing articles...'
arch=('i686' 'x86_64')
url='https://launchpad.net/inyokaedit/'
license=('GPL3')
depends=('hunspell' 'qtwebkit' 'wget')
makedepends=('bzr' 'gcc')
source=()
md5sums=()
conflicts=('inyokaedit')

_bzr_url="http://bazaar.launchpad.net/~elthoro/inyokaedit/trunk"
_pkgname=inyokaedit

build() {
    bzr export $pkgname-$pkgver $_bzr_url
    cd "$srcdir/$pkgname-$pkgver"
    qmake
    make
}

package() {
    cd "$srcdir/$pkgname-$pkgver"
    install -d $pkgdir/usr/bin
    install -d $pkgdir/usr/share/$_pkgname
    install -d $pkgdir/usr/share/pixmaps/
    install -d $pkgdir/usr/share/applications
    install -d $pkgdir/usr/share/man/{man1,de/man1}
    cp -rf iWikiLinks $pkgdir/usr/share/$_pkgname/iWikiLinks
    cp -rf images $pkgdir/usr/share/$_pkgname/
    cp -rf lang $pkgdir/usr/share/$_pkgname/
    gzip -9 -c man/man1/inyokaedit.1 > $pkgdir/usr/share/man/man1/inyokaedit.1.gz
    gzip -9 -c man/de/man1/inyokaedit.1 > $pkgdir/usr/share/man/de/man1/inyokaedit.1.gz
    cp images/inyokaedit_64x64.png $pkgdir/usr/share/pixmaps/inyokaedit_64x64.png
    cp inyokaedit.desktop $pkgdir/usr/share/applications/inyokaedit.desktop
    cp GetInyokaStyles $pkgdir/usr/share/$_pkgname/
    cp inyokaedit $pkgdir/usr/bin/inyokaedit
}
