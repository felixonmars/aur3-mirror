# Maintainer: Bidossessi Sodonon

pkgname=openerp
pkgver=6.1
pkgrel=1
pkgdesc="Advanced OpenSource ERP and CRM server"
url=http://openerp.com/
arch=(i686 x86_64)
license=(GPLv3)
conflicts=('openerp-server' 'openerp-web')
depends=('postgresql' 'python2-dateutil' 'python2-feedparser' 'python-imaging' 'python-gdata' 'python2-ldap' 'python2-lxml' 'python2-mako' 'python-openid' 'python2-psycopg2' 'python-babel' 'python-pychart' 'pydot' 'python2-pyparsing' 'python-reportlab' 'python2' 'python-simplejson' 'python2-pytz' 'python2-vatnumber' 'python2-vobject' 'python-pywebdav' 'python2-werkzeug' 'python2-xlwt' 'python2-yaml' 'zsi')
source=(
"http://nightly.openerp.com/${pkgver}/releases/openerp-${pkgver}-${pkgrel}.tar.gz"
openerp.rc
openerp.confd
)
install=openerp.install

build()
{
  cd ${srcdir}/${pkgname}-${pkgver}-${pkgrel}
  mkdir ${pkgdir}/etc/{rc.d,conf.d,openerp,logrotate.d} -p
  install -Dm 755 ${srcdir}/openerp.rc ${pkgdir}/etc/rc.d/openerp-server
  install -Dm 644 ${srcdir}/openerp.confd ${pkgdir}/etc/conf.d/openerp-server

  python2 setup.py install --root="${pkgdir}"
  #install -Dm 644 ${pkgdir}/usr/share/doc/${pkgname}-${pkgver}/openerp.logrotate ${pkgdir}/etc/logrotate.d/
  cp ${srcdir}/${pkgname}-${pkgver}-${pkgrel}/install/openerp-server.conf ${pkgdir}/etc/openerp/
  cp ${srcdir}/${pkgname}-${pkgver}-${pkgrel}/install/openerp-server.logrotate ${pkgdir}/etc/logrotate.d/openerp-server
  #mv ${pkgdir}/usr/share/doc/${pkgname}-${pkgver} ${pkgdir}/usr/share/doc/${pkgname}
  #cd "${pkgdir}"/usr/bin
  #sed -i 's/cd .*pkg/cd /' openerp
}

md5sums=('a2ab3ba38611135fab69b8bd8a7e0e19'
         'e7dc5e9b048ea206b02634587a9a7e45'
         'f88d49de3dae4bbe4f0a41ebb53e52ff')
