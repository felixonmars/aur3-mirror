# Maintainer: ValHue <vhuelamo_at_gmail_dot_com>

pkgname=multisystem
pkgver=1.0248
pkgrel=4
pkgdesc="A GUI tool to create a usb system that can boot multiple distro's"
url="http://liveusb.info/dotclear/index.php"
arch=('i686' 'x86_64')
license=('GPL3')
depends=('hdparm' 'unzip' 'xxd' 'gvfs' 'dosfstools' 'cdrkit' 'grub-bios' 'sudo' 'gksu' 'lsb-release' 'zenity'  'xterm' 'gtkdialog' 'xdotool' 'wmctrl' 'qemu-kvm' 'lsof' 'imagemagick' 'syslinux' 'cryptsetup' 'rsync' 'mtools' 'squashfs-tools')
optdepends=('fatresize: The FAT16/FAT32 non-destructive resizer.')
source=("http://liveusb.info/multisystem/${pkgname}.tar.bz2" 'update-grub2' 'multisystem-liveusb.desktop' 'multisystem-vbox.desktop')
md5sums=('3c10ce5fb4ee373dafbe3b663811b8bb'
         '9363ccaa6f7cd907e48b76d5acb24319'   
         'fcbd4d83f639d89675210236fb62f885'
         '45b2d475a24af0a4a3554d29e7cbe0fc')

build() {
    cd "${srcdir}/${pkgname}"

    sed -i '/fatresize/d' dependances.txt
    sed -i '227,236d' gui_multisystem.sh

    mkdir -p ${pkgdir}/usr/local/share/${pkgname}
    mv * ${pkgdir}/usr/local/share/${pkgname}
    mkdir -p ${pkgdir}/usr/share/applications
    mkdir -p ${pkgdir}/usr/local/share/pixmaps
    mkdir -p ${pkgdir}/bin

    cp ${srcdir}/*.desktop ${pkgdir}/usr/share/applications
    cp ${srcdir}/update-grub2 ${pkgdir}/bin
    cp ${pkgdir}/usr/local/share/${pkgname}/img/*.png ${pkgdir}/usr/local/share/pixmaps
    cp ${pkgdir}/usr/local/share/${pkgname}/pixmaps/multisystem-liveusb.png ${pkgdir}/usr/local/share/pixmaps
    cp ${pkgdir}/usr/local/share/${pkgname}/pixmaps/multisystem-vbox.png ${pkgdir}/usr/local/share/pixmaps
}
