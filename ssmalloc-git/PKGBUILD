pkgname=ssmalloc-git
pkgver=7.598c42a
pkgrel=1
pkgdesc="A Low-latency, Locality-conscious Memory Allocator with Stable Performance Scalability"
arch=(x86_64)
url="http://ipads.se.sjtu.edu.cn/ssmalloc"
license=('BSD')
depends=()
makedepends=()
source=('ssmalloc::git://github.com/Naruil/SSMalloc.git')
md5sums=('SKIP')

pkgver() {
  cd $srcdir/ssmalloc
  # ssmalloc repo does not have any git tags yet
  echo $(git rev-list --count master).$(git rev-parse --short master) 
}

build() {
  cd $srcdir/ssmalloc
  make
}

package() {
  cd $srcdir/ssmalloc
  mkdir -p $pkgdir/usr/lib
  install libssmalloc.a $pkgdir/usr/lib
  install libssmalloc.so $pkgdir/usr/lib
  #make install DESTDIR=$pkgdir
} 

