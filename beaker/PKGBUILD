# PKGBUILD made by: Gris Ge <cnfourt@gmail.com>
pkgname="beaker"
pkgver="0.6.10_4"
pkgrel="4"
pkgdesc="An automated testing framework proposed for Fedora. Successor to RHTS"
arch=('i686' 'x86_64')
makedepends=('git' 'make' 'turbogears>=1.1.1' 'python2-distribute' 'kid' 'python-lxml' 
            'python2-xmltramp' 'python2-ldap' 'python-sphinx')
url="https://fedorahosted.org/beaker"
license=('GPL')
depends=('python2>=2.7' 'turbogears>=1.1.1' 'python-kobo>=0.3' 'python-lxml>=2.2.8' 'krb5>=1.9.1' 'python2-krbv' 'python2-distribute')
source=('beaker_python2.patch')
md5sums=('9805dcd37007a4ef77eeffc150aae596')

build() {
	cd $srcdir
    if [ ! -d beaker_full ]
        then
            git clone git://git.fedorahosted.org/git/beaker.git beaker_full
        else
            cd beaker_full
            git pull
    fi
    #echo git finished
    cd $srcdir/beaker_full
    #echo build archive
    git archive --format=tar $pkgname-${pkgver//_/-} > $srcdir/$pkgname-${pkgver//_/-}.tar
    mkdir -p $srcdir/beaker
    cd $srcdir/beaker
    #pwd
    tar xfv $srcdir/$pkgname-${pkgver//_/-}.tar
    #pwd
    patch -p1 -i $srcdir/beaker_python2.patch
    make
    DESTDIR=$pkgdir make install
}

