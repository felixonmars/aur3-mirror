# Maintainer:  Kyle Keen <keenerd at gmail>
# Maintainer:  evr <evanroman at gmail>
# Contributor: Abhishek Dasgupta <abhidg@gmail.com>

pkgname=weather
pkgver=1.5
pkgrel=3
pkgdesc="CLI tool which shows weather forecasts from METAR data"
arch=('any')
url="http://fungi.yuggoth.org/weather/"
depends=('python2')
license=("custom:BSD2")
source=(http://fungi.yuggoth.org/weather/src/$pkgname-$pkgver.tar.gz)
md5sums=('87c7f59bd34a2f62e38a11b81160cd6b')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  sed -i 's|env python|env python2|' *
  echo "# Find more stations at http://aviationweather.gov/adds/metars/stations.txt" > wrc2
  cat weatherrc >> wrc2
  _python_path=$(python2 -c "import sys ; print [p for p in sys.path if p.startswith('/usr/lib/python2.')][0]")
  install -D -m 755 weather ${pkgdir}/usr/bin/weather
  install -D -m 644 weather.py ${pkgdir}${_python_path}/weather.py
  install -D -m 644 wrc2 ${pkgdir}/etc/weatherrc
  install -D -m 644 weather.1 ${pkgdir}/usr/share/man/man1/weather.1
  install -D -m 644 weatherrc.5 ${pkgdir}/usr/share/man/man5/weatherrc.5
  install -D -m 644 LICENSE ${pkgdir}/usr/share/licenses/$pkgname/BSD2
}

