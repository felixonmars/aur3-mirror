# Maintainer: Giuseppe Cal√† <jiveaxe@gmail.com>
# Contributer: giacomogiorgianni@gmail.com 

pkgname=grive
pkgver=0.0.4
pkgrel=1
pkgdesc="Open source Linux client for Google Drive"
arch=('i686' 'x86_64')
url="http://match065.github.com/grive/"
license=('GPL')
categories=('network')
depends=('gcc-libs' 'curl' 'json-c' 'openssl')
makedepends=('cmake' 'cppunit')
options=(!emptydirs)
source=("match065-grive-co1ace7::https://nodeload.github.com/match065/grive/tarball/master")
md5sums=('ee7421969109aa13e46e6df05efb1405')

build() {
  cd "$srcdir/match065-grive-c01ace7"
 
  rm -rf build
 
  mkdir build
 
  cd build
 
  cmake .. -DCMAKE_BUILD_TYPE=Release \
           -DCMAKE_INSTALL_PREFIX=/usr 

  sed -i '5s/-pipe/-pipe -fpermissive/' "$srcdir/match065-grive-c01ace7/build/libgrive/CMakeFiles/unittest.dir/flags.make"
  sed -i '5s/-pipe/-pipe -fpermissive/' "$srcdir/match065-grive-c01ace7/build/libgrive/CMakeFiles/grive.dir/flags.make"
  make
  make DESTDIR="$pkgdir/" install
}
 
#package() {
#    install -dm 755 $pkgdir/usr/bin
#    cp "$srcdir/match065-grive-c01ace7/build/grive" $pkgdir/usr/bin
#}