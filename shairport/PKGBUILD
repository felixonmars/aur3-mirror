# Contributor: Nicolas Qui√©not < niQo at aur > 

pkgname=shairport
pkgver=0.05
pkgrel=2
pkgdesc='ShairPort emulates AirPort Express to receive AirPlay streams'
arch=('i686' 'x86_64')
url='http://www.mafipulation.org/blagoblig/2011/04/08#shairport'
license=('GPL')
makedepends=()
depends=('avahi' 'openssl' 'libao' 'perl-libwww' 'perl-crypt-openssl-rsa' 'perl-io-socket-inet6') 
#install=${pkgname}.install
source=('http://mafipulation.org/static/'${pkgname}'-'${pkgver}'.tar.gz' 'shairport.sh')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  #add -pthread to each "gcc" line in the makefile
  sed -i '/gcc/ s/$/ -pthread/' Makefile
  make || return 1
}

package() {
  cd "$srcdir/$pkgname-$pkgver"

  cd ${pkgdir} ; mkdir -p usr/bin ; mkdir -p opt/shairport ;cd -

  install -Dm755 ../shairport.sh ${pkgdir}/usr/bin/shairport || return 1
  install -Dm755 shairport.pl ${pkgdir}/opt/shairport/ || return 1
  install -Dm755 hairtunes ${pkgdir}/opt/shairport/ || return 1
}

md5sums=('ecc09771cce1df704d6376cd13b67d2d'
         '35f4d91bef01ed080e2116968432714a')
