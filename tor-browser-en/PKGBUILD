# Maintainer: Max Roder <maxroder@web.de>

pkgname=tor-browser-en
pkgver=2.2.33_rc3
pkgrel=3
pkgdesc="Lets you use Tor with Firefox (+ Torbutton, NoScript, HTTPS-Everywhere) without the need to configure anything. English version."
url="https://www.torproject.org/projects/torbrowser.html.en"
arch=('x86_64' 'i686')
license=('GPL')
#depends=('java-environment' 'xulrunner' 'qt' 'cairo-xcb' 'gcc-libs-multilib')
depends=('java-environment')
install='tor-browser-en.install'
if [[ "$CARCH" == 'i686' ]]; then
	source=("https://www.torproject.org/dist/torbrowser/linux/tor-browser-gnu-linux-i686-2.2.33-3-dev-en-US.tar.gz")
	sha256sums=('c3a7cf3a72de7ddacd808508f865209b6733c7ce56aa83ec218148d10ce74a21')
else
	source=("https://www.torproject.org/dist/torbrowser/linux/tor-browser-gnu-linux-x86_64-2.2.33-3-dev-en-US.tar.gz")
	sha256sums=('429194ce4892e26cae1a63616cc20eba03cfcb466bcc2d1457db5569c6a06be2')
fi
source+=(${pkgname}.desktop
		${pkgname}.png)
sha256sums+=('61f7c6a656d7198192573bf84b6487bacdbe5d9bc97e84215e8009a005057545'
            '17fc2f5784d080233aca16e788d62ab6fe3e57cf781b123cfe32767de97d6d3b')
options=('!strip' 'emptydirs')

package() {
	cd ${srcdir}/tor-browser_en-US

	install -d ${pkgdir}/opt/${pkgname}/ ${pkgdir}/usr/bin/

	cp -a * ${pkgdir}/opt/${pkgname}/

	# Desktop stuff
	install -Dm644 ../${pkgname}.desktop ${pkgdir}/usr/share/applications/${pkgname}.desktop
	install -Dm644 ../${pkgname}.png ${pkgdir}/usr/share/pixmaps/${pkgname}.png

	# Wrapper script
	echo "#!/bin/sh" >> ${pkgdir}/usr/bin/${pkgname}
	echo "cd /opt/${pkgname}/; ./start-tor-browser" >> ${pkgdir}/usr/bin/${pkgname}
	chmod +x ${pkgdir}/usr/bin/${pkgname}
}

# vim:set ts=2 sw=2 et:
