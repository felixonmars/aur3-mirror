# Contributor: andreas_baumann <abamann@yahoo.com>
pkgname=xxdiff-hg
pkgver=401
pkgrel=1
pkgdesc="A graphical browser for file and directory differences."
url="http://furius.ca/xxdiff"
license=('GPL')
depends=('qt')
makedepends=('flex>=2.5.31' 'bison' 'python-docutils')
arch=('x86_64' 'i686')
conflicts=('xxdiff')
provides=('xxdiff')

_hgroot='https://hg.furius.ca/public'
_hgrepo='xxdiff'

build() {
	# Update the repo, else clone a new one
	if [ -d $_hgrepo ]; then
		cd $_hgrepo/src
		hg pull -u
	else
		hg clone ${_hgroot}/${_hgrepo}
		cd $_hgrepo
	fi

	cd "$srcdir/xxdiff/src"
	export QMAKE=/usr/bin/qmake
	make -f Makefile.bootstrap || return 1
	make || return 1
}

package() {
	cd "$srcdir/xxdiff/src"
	install -D -m 755 "$srcdir/xxdiff/bin/xxdiff" "$pkgdir/usr/bin/xxdiff"
}
