# Maintainer: Balló György <ballogy@freestart.hu>
pkgname=indicator-sound
pkgver=0.7.9.1
pkgrel=2
pkgdesc="A unified sound menu"
arch=('i686' 'x86_64')
url="https://launchpad.net/indicator-sound"
license=('GPL')
depends=('libpulse>=0.9.19' 'libindicator>=0.3.19' 'libdbusmenu>=0.3.101' 'ido>=0.1.11' 'libnotify>=0.7.0' 'libgee' 'dconf')
true && depends=('libpulse>=0.9.19' 'libindicator3>=0.3.19' 'libdbusmenu-gtk3>=0.3.101' 'ido>=0.1.11' 'libnotify>=0.7.0' 'libgee' 'dconf')
makedepends=('intltool>=0.35.0' 'vala>=0.11.2')
options=(!libtool)
install=$pkgname.install
source=(http://launchpad.net/$pkgname/fourth/$pkgver/+download/$pkgname-$pkgver.tar.gz
        launchpad-export.tar.gz
        not-check-gconf.patch)
md5sums=('8be94d1f1479f0811e6d74f3c05abce0'
         '6cbcb33bd275100ed746dea2221db270'
         'f69640f25a690313c101127b9753407d')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  # Do not check for GConf
  patch -Np1 -i "$srcdir/not-check-gconf.patch"

  # Install updated language files
  echo 'ace af am an ar ast az be bg bn bo br bs ca ca@valencia ckb crh cy cs csb da de dv el en_AU en_CA en_GB eo es et eu fa fi fil fr fur fy gd gl gu gv he hi hr ht hu hy id is it ja ka kk kl km kn ko ku ky lb lld lo lt ltg lv mg mhr mk ml mr ms my nan nb ne nl nn oc os pa pl ps pt pt_BR ro ru sc sco sd si sk sl sml sn sq sr sv ta ta_LK te th tr tt ug uk ur uz vec vi wae zh_CN zh_HK zh_TW' >po/LINGUAS
  rename $pkgname- '' ../po/$pkgname-*.po
  mv -f -t po ../po/*

  autoreconf -fi
  ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var --libexecdir=/usr/lib/$pkgname \
              --disable-static --disable-schemas-compile
  make
}

package() {
  cd "$srcdir/$pkgname-$pkgver"

  make DESTDIR="$pkgdir/" install
}
