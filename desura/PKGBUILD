# Maintainer: Wido <widowild [at] myopera [dot] com>
# Contributor: Wido <widowild [at] myopera [dot] com>

pkgname=desura
pkgver=1
pkgrel=11
pkgdesc="a community driven digital distribution service for gamers, putting the best games, mods and downloadable content from developers at gamers fingertips (BETA)"
url="http://www.desura.com/"
license=('custom: "commercial"')
arch=('i686' 'x86_64')
install=${pkgname}.install
options=()
depends=('gtk2' 'libjpeg6' 'libpng12' 'lsb-release' 'gconf')
optdepends=('nvidia-utils: If you have nvidia graphics'
            'catalyst-utils: If you have ATI graphics'
            'glew1.5: if you have install M.A.R.S - a ridiculous shooter'
            'java-runtime: adds java support.'
            'mono: Free implementation of the .NET platform')
[ "$CARCH" = "x86_64" ] &&  optdepends=('lib32-nvidia-utils: If you have nvidia graphics'
                                        'lib32-catalyst-utils: If you have ATI graphics'
                                        'lib32-curl: if you have install TRAUMA '
                                        'lib32-nss: if you have install TRAUMA'
                                        'glew1.5: if you have install M.A.R.S - a ridiculous shooter'
                                        'java-runtime: adds java support.'
                                        'mono: Free implementation of the .NET platform')

[ "$CARCH" = "i686"   ] && ARCH=i686
[ "$CARCH" = "x86_64" ] && ARCH=x86_64

source=(http://www.desura.com/desura-${ARCH}.tar.gz ${pkgname}.sh ${pkgname}.desktop)
md5sums=('ae99506ddc35db2c4daa9855e42f5716'
         '6f8d2745304da5822762ae84f23e38a2'
         '7b4c336e6dbd5ab4f13cfdac9ea562b4')

[ "$CARCH" = "x86_64" ] && md5sums=('29f124803927c86df2e5bab94ec9e26f'
                                    '6f8d2745304da5822762ae84f23e38a2'
                                    '7b4c336e6dbd5ab4f13cfdac9ea562b4')

build() {
   cd ${srcdir}
   true
}

package(){
  cd ${srcdir}

  # Change Permission
   install -d -m775 -g users \
       ${pkgdir}/opt/${pkgname}/{bin,data,docs,lib}

  # Install Desura
   install -Dm 755 ${srcdir}/${pkgname} \
       ${pkgdir}/opt/${pkgname}/${pkgname}

  # Install Launcher
   install -Dm 755 ${srcdir}/${pkgname}.sh \
       ${pkgdir}/usr/bin/${pkgname}

  # Install Desktop
   install -Dm 644 ${srcdir}/${pkgname}.desktop \
        ${pkgdir}/usr/share/applications/${pkgname}.desktop
}
