# Maintainer: Simon Wydooghe <hyperbaton at gmail dot com>

pkgname=vpcs
pkgver=0.21a
pkgrel=4
pkgdesc="Simulates up to 9 computers for ping/traceroute purposes."
arch=('i686' 'x86_64')
url="http://vpcs.sourceforge.net/"
license=('GPL')
install=vpcs.install
backup=('opt/vpcs/startup.vpc')
makedepends=('p7zip')
source=("${pkgname}_${pkgver}.7z::http://downloads.sourceforge.net/project/${pkgname}/binary/${pkgver}/${pkgname}_${pkgver}.7z" vpcs)
noextract=(${pkgname}_${pkgver}.7z)
md5sums=('dac71bdf9d04a3b7e69fe25b15f1ee5c'
	 '6eab272fbce65baa017d279c8f8c0f70')

package() {
  local _vpcsdir="opt/vpcs"
  local _bindir="usr/bin"
  local _binary="vpcs32"

  cd "${srcdir}"
  echo ">>> Extracting 7zip archive..."
  7z e -o"${pkgname}-${pkgver}" "${pkgname}_${pkgver}.7z" >/dev/null
  echo ">>> Extraction done."
  mkdir -p "${pkgdir}/${_vpcsdir}" "${pkgdir}/${_bindir}"
  cp -L vpcs "${pkgdir}/${_bindir}"
  cd "${pkgname}-${pkgver}"
  cp startup.vpc readme.txt ${pkgdir}/${_vpcsdir}
  if [ $CARCH = "x86_64" ]; then
    _binary="vpcs64"
  fi
  cp ${_binary} ${pkgdir}/${_vpcsdir}/vpcs
  chmod +x ${pkgdir}/${_vpcsdir}/vpcs
}
