# Maintainer: Philip MÃ¼ller <mail at philip.in-aachen dot net>
pkgname=opa-bin  
version=1.0.5
build=2988
pkgver=${version}_${build}
pkgrel=1
pkgdesc="advanced web framework and language"
url="http://www.opalang.org"
arch=('x86_64')
license=('AGPL')
depends=('openssl' 'gdbm' 'tcl' 'tk' 'libx11' 'nodejs')
optdepends=('mongodb: database backend')
provides=(opa)
conflicts=(opa-git)
replaces=()
source_script_name=opa_${version}%2Bbuild${build}_amd64.release.run
source=(http://download.opalang.org/linux/${source_script_name})
md5sums=('51bafa9faef652d67ea17061fe17f6b1')
sha512sums=('e2949f9c1e6623581c2dd3bb46bf10d963c338eabc3fc01abcf4ee54ac29d1e9731ee9c0440cc6664c3b68f3a569ea504ba4cd21331f82467f6fc3f4c66cdc07')

build() {
  cd $srcdir
  chmod +x $source_script_name
}

package() {
  cd $srcdir
  ./$source_script_name --target $srcdir/opa --noexec
  cp -a $srcdir/opa $pkgdir/usr
  $pkgdir/usr/share/opa/install.sh --dir $pkgdir/usr --prefix /usr

  chmod 755 $pkgdir/usr

  rm $pkgdir/usr/install.sh
  rm $pkgdir/usr/share/opa/uninstall.sh
  rm $pkgdir/usr/share/opa/install.sh
}
