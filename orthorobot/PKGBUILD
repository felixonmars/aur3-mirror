# Contributor: Sausageandeggs <sausageandeggs at archlinux dot us>
pkgname=orthorobot
pkgver=1.0
pkgrel=1
pkgdesc='Perspective based puzzle game, where you flatten the view to move across gaps'
arch=('i686' 'x86_64')
url="http://stabyourself.net/orthorobot/"
license=('GPL')
depends=('love' 'unzip')
_gamepkg="${pkgname}-linux.zip"
source=(${pkgname}.sh ${pkgname}.desktop ${_gamepkg}.sha1)

build() {
    cd ${srcdir}
    ## Thanks to andy123 for the wget cmds I shamelessly stole cos they have a stupid way of hosting the game
	wget -qq -O/dev/null http://stabyourself.net/${pkgname}/ --keep-session-cookies --save-cookies temp.cookie
	wget --header="Host: stabyourself.net" \
		--header="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:8.0.1) Gecko/20100101 Firefox/8.0.1" \
		--header="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" \
		--header="Accept-Language: en-us,en;q=0.5" \
		--header="Accept-Encoding: gzip, deflate" \
		--header="Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7" \
		--header="Referer: http://stabyourself.net/${pkgname}/" \
		--load-cookies temp.cookie \
		--header="DNT: 1" --header="Connection: keep-alive" \
		"http://stabyourself.net/dl.php?file=${pkgname}/${_gamepkg}" -cO"${_gamepkg}"
	sha1sum -c ${_gamepkg}.sha1 || return 1
	unzip -o ${srcdir}/${_gamepkg} -d $srcdir/${pkgname}

}

package() {
  cd "$srcdir"
  install -Dm 755 ${pkgname}.sh ${pkgdir}/usr/bin/${pkgname}
  install -Dm 644 ${pkgname}.desktop ${pkgdir}/usr/share/applications/${pkgname}/${pkgname}.desktop
  install -Dm 644 ${pkgname}/Ortho\ Robot.love ${pkgdir}/usr/share/games/${pkgname}/${pkgname}.love
}

md5sums=('d6808988ac2a7fa94f993e1a326e4b98'
         '471b75912eb46f26d72253907ec19e47'
         '5eaf34495b7e0e59dcc6fc6916ef1376')
