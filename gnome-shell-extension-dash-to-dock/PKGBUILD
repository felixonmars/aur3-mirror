# Maintainer: Christopher Kroo√ü <didi2002 at web.de>
pkgname=gnome-shell-extension-dash-to-dock
pkgver=20130414
pkgrel=2
pkgdesc="Transform the dash into an intellihide dock"
arch=('any')
url="https://github.com/micheleg/dash-to-dock/"
license=('GPL')
makedepends=('git' 'gnome-common' 'intltool')
conflicts=('gnome-shell-extensions-git')
_gitroot="https://github.com/micheleg/dash-to-dock.git"
_gitname="dash-to-dock"

build() {
	cd "$srcdir"
	msg "Connecting to GIT server...."

	if [ -d $_gitname ] ; then
		cd $_gitname && git pull origin
		msg "The local files are updated."
	else
		git clone $_gitroot --depth=1 -b gnome-3.7
	fi

	msg "GIT checkout done or server timeout"

	cd "$srcdir/$_gitname"
	sed -i 's/INSTALLBASE = ~\/.local\/share\/gnome-shell\/extensions/INSTALLBASE = ${DESTDIR}/' Makefile 
	make
}

package() {
	cd "$srcdir/$_gitname"
	mkdir -p "${pkgdir}/usr/share/gnome-shell/extensions" "${pkgdir}/usr/share/glib-2.0/schemas/"
	make DESTDIR=${pkgdir}/usr/share/gnome-shell/extensions install
	install -m644 "schemas/org.gnome.shell.extensions.dash-to-dock.gschema.xml" "${pkgdir}/usr/share/glib-2.0/schemas/org.gnome.shell.extensions.dash-to-dock.gschema.xml"
}
