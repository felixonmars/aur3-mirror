# Maintainer: Krzysztof Wloch <wloszekk@gmail.com>
# Contributor: Luke McCarthy <luke@iogopro.co.uk>
pkgname=fasm
pkgver=1.70.01
pkgrel=1
pkgdesc="A fast and small assembler for x86 and x86-64"
url="http://flatassembler.net/"
license=('custom')
depends=('glibc')
arch=('i686' 'x86_64')
source=("http://flatassembler.net/fasm-$pkgver.tgz")
options=('!strip')
#flat assembler 1.70.01 for Linux
#size: 237 kilobytes
#last update: 30 Apr 2012 20:15:21 UTC
md5sums=('cc77669bf16a50509b3c7c3d15fd3937')

build() {
  cd "$srcdir/fasm"
  install -d $pkgdir/usr/bin
  install -d $pkgdir/usr/share/$pkgname
  install -d $pkgdir/usr/share/licenses/$pkgname
  #echo install -m 755 -t $pkgdir/usr/bin/ fasm
  install -m 755 -t $pkgdir/usr/bin/ fasm
  local s
  for s in listing prepsrc symbols; do
    ./fasm tools/libc/$s.asm $s.o
    gcc -m32 -o $s $s.o
    install -D $s $pkgdir/usr/bin/fasm-$s
  done
  install -m 644 -t $pkgdir/usr/share/licenses/$pkgname/ license.txt
  cp -R fasm.txt whatsnew.txt examples tools source $pkgdir/usr/share/$pkgname/
}
