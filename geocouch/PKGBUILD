# Maintainer: Leif Warner <abimelech@gmail.com>
pkgname=geocouch
pkgver=1.2.0
pkgrel=1
pkgdesc="A CouchDB add-on to support geospatial indexing and queries."
arch=('i686' 'x86_64')
url="http://github.com/couchbase/geocouch"
license=('APACHE')
depends=('couchdb')
source=('https://github.com/couchbase/geocouch/tarball/couchbase_1.2.0_geo')
install=geocouch.install
md5sums=('f1611b857003daffe6690d7c41fe73f6')

build() {
    cd $srcdir/couchbase-geocouch-f755673
    export COUCH_SRC=/usr/lib/couchdb/erlang/lib/couch-1.2.0a-/include/
    make 
}

package(){
    cd "$srcdir/couchbase-geocouch-f755673"
    install -d -m755 -o couchdb -g daemon $pkgdir/etc/couchdb/local.d
    install -m644 -o couchdb -g daemon etc/couchdb/local.d/geocouch.ini $pkgdir/etc/couchdb/local.d/geocouch.ini
    install -d $pkgdir/usr/share/couchdb/www/script/test
    install -t $pkgdir/usr/share/couchdb/www/script/test share/www/script/test/* 
    install -d $pkgdir/usr/lib/couchdb/erlang/lib/geocouch/ebin
    install -t $pkgdir/usr/lib/couchdb/erlang/lib/geocouch/ebin build/* 
}
