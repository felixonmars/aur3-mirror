# Contributor: Nicolas Quienot   <niQo(at)aur>
# Contributor: Dustin Mays       <dork.fish.wat(at)gmail(dot)com>
# Contributor: Kenny Stocoff     <sogenfallen(at)hotmail(dot)com>
# Contributor: Prurigro          <prurigro(at)gmail(dot)com>

pkgname=libgpod-git
pkgver=20110518
pkgrel=2
pkgdesc="A shared library used to access the contents of an iPod"
url="http://www.gtkpod.org/wiki/Libgpod"
arch=(i686 x86_64)
license=('LGPL')
depends=('gtk2' 'libxml2' 'sg3_utils' 'libplist')
makedepends=('perlxml' 'swig' 'git' 'intltool' 'gtk-doc')
options=(!libtool)
conflicts=('libgpod')
replaces=('libgpod')
provides=('libgpod=0.8.0')
source=()
md5sums=()

_gitroot=git://gtkpod.git.sourceforge.net/gitroot/gtkpod/libgpod
_gitname=libgpod

build(){
	pushd ${srcdir} || return 1
		msg "Connecting to libgpod GIT server..." || return 1
		if [ -d ${srcdir}/${_gitname} ] ; then
			pushd ${_gitname} || return 1
				if [ -f Makefile ] ; then
					make clean || return 1
				fi || return 1
				git pull origin || return 1
				msg "Update Complete!" || return 1
			popd || return 1
		else
			git clone ${_gitroot} || return 1
			msg "Download Complete!" || return 1
		fi || return 1
		pushd ${_gitname} || return 1
			sh autogen.sh --prefix=/usr || return 1
			make || return 1
			make DESTDIR=${startdir}/pkg install || return 1
		popd || return 1
	popd || return 1
	if [ -d ${pkgdir}/tmp ]; then
		rmdir ${pkgdir}/tmp || return 1
	fi || return 1
}
