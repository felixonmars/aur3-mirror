# Contributor: Yarema aka Knedlyk <yupadmin@gmail.com>
_pkgname=radiotray
pkgname=${_pkgname}-hg
pkgver=456
pkgrel=1
pkgdesc="An online radio streaming player that runs on a Linux system tray."
arch=(any)
url="http://radiotray.sourceforge.net/"
license=(GPL)
depends=('pyxdg' 'gstreamer0.10' 'gstreamer0.10-base' 'gstreamer0.10-base-plugins' 'gstreamer0.10-python' 'pygtk' \
	'python-lxml' 'pygobject' 'python2-pyinotify' 'dbus-python' 'python-notify' \
	'gstreamer0.10-good' 'gstreamer0.10-good-plugins' 'gstreamer0.10-ffmpeg' 'python-lxml')
optdepends=('gstreamer0.10-bad' 'gstreamer0.10-bad-plugins')
makedepends=('mercurial')
provides=(radiotray)
conflicts=('radiotray' 'radiotray-svn')

_hgroot=http://radiotray.hg.sourceforge.net:8000/hgroot/radiotray/
_hgrepo=radiotray


build() {
	if [ -d $_hgrepo ]; then
		cd $startdir/src/$_hgrepo
		hg pull -u
		else
			hg clone $_hgroot $_hgrepo
			cd $startdir/src/$_hgrepo
	fi
											
	msg "Starting make..."

	rm -rf $srcdir/$_hgrepo-build
	cp -rf $srcdir/$_hgrepo $srcdir/$_hgrepo-build
	cd $srcdir/$_hgrepo-build
	

	python2 setup.py install --root=$pkgdir/ --optimize=1

	chmod +x $pkgdir/usr/bin/radiotray
	find $pkgdir -perm 600 -exec chmod 644 {} \;
}

