# Maintainer: Nikita Nikishin <i.nnikishi@gmail.com>

pkgname=bindery
pkgver=20120225
pkgrel=2
pkgdesc="Interactive digital document binding tool for post-processed scanned images"

arch=('any')
url="http://blender3d.github.com/Bindery/"
license=('GPL')

depends=('python' 'pyqt' 'djvulibre' 'minidjvu' 'jbig2enc-git' 'djvubind-hg')
optdepends=('tesseract: OCR engine'
            'cuneiform: OCR engine')

install='bindery.install'

_download_url="https://github.com/Blender3D/Bindery/tarball/master"

build() {
  if [ -f "$pkgname".tar.gz ];
  then
    rm "$pkgname".tar.gz
  fi
  
  wget --no-check-certificate "$_download_url" -O "$pkgname".tar.gz
  tar xvzf "$pkgname".tar.gz
  
  mv Blender3D-Bindery-* $pkgname
}

package() {
  mkdir -p $pkgdir/usr/{share,bin}
  mkdir -p $pkgdir/usr/share/{icons,applications}
  
  mv $pkgname $pkgdir/usr/share/
  cp $pkgdir/usr/share/bindery/ui/icons/logo.png $pkgdir/usr/share/icons/bindery.png 
  cp $pkgdir/usr/share/bindery/distro/linux/arch/bindery.desktop $pkgdir/usr/share/applications/
  
  rm -R $pkgdir/usr/share/$pkgname/distro
  
  echo "#/bin/bash" > $pkgdir/usr/bin/bindery
  echo "cd /usr/share/bindery/" >> $pkgdir/usr/bin/bindery
  echo "python main.py" >> $pkgdir/usr/bin/bindery
  
  chmod +x $pkgdir/usr/bin/bindery
}
