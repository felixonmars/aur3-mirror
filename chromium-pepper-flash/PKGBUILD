# Maintainer: Ner0
# Contributor: ava1ar (mail(dot)avatar(at)gmail(dot)com)

pkgname=chromium-pepper-flash
pkgver=11.3.31.208
pkgrel=1
pkgdesc="Google Chrome's Pepper Flash plugin for Chromium (latest development version)"
arch=('i686' 'x86_64')
_arch="$CARCH"
[ "$CARCH" = 'i686' ] && _arch='i386'
url="http://www.google.com/chrome"
license=('custom:chrome')
optdepends=('pulseaudio-alsa: For PulseAudio users')
install=pepper.install
source=("http://dl.google.com/dl/linux/direct/google-chrome-unstable_current_${_arch}.rpm")
md5sums=('7d7ade4ec987d53af205f54f0298061f')
[ "$CARCH" = 'i686' ] && md5sums=('41a231f9578c7893651d4d231c79a9ca')

[ -f /usr/bin/chromium-browser ] && _default=/etc/chromium-browser/default
[ -f /usr/bin/chromium ] && _default=/etc/chromium/default

package() {
  if [ ! -f "$_default" ]; then
    error "There's no '$_default' file. Reinstall Chromium or create it manually." && return 1
  fi

  install -dm755 "$pkgdir/usr/lib/PepperFlash"
  install -m644 opt/google/chrome/PepperFlash/* "$pkgdir/usr/lib/PepperFlash"
  sed -i "s/flashver=.*/flashver=$pkgver/" "$startdir/pepper.install"
}
