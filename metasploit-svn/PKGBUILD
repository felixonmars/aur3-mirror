# Contributor: ryooichi <ryooichi+arch AT gmail DOT com>
pkgname=metasploit-svn
pkgver=12616
pkgrel=1
pkgdesc="The Metasploit Framework is a development platform for creating security tools and exploits."
arch=('any')
url="http://metasploit.com/"
license=('custom:"Metasploit Framework License v1.2"')
#groups=()
depends=('ruby' 'java-runtime' 'subversion')
makedepends=()
#optdepends=() #sqlite?
provides=('metasploit')
#conflicts=('metasploit3')
#replaces=()
#backup=()
#install=
source=()
md5sums=()
#noextract=()
#_svntrunk=http://metasploit.com/svn/framework3/trunk
#_svntrunk=https://metasploit.com/svn/framework3/trunk
_svntrunk=https://www.metasploit.com/svn/framework3/trunk
_svnmod=metasploit
options=('!strip')

build() {
  if [ -d $srcdir/.svn ]; then
    msg 'Updating...'
    svn up $srcdir
  else
    msg 'Checking out...'
    svn co $_svntrunk $srcdir
  fi
  mkdir -p $pkgdir/usr/{bin,src}
  cd $pkgdir/usr/src
  #svn export $srcdir $_svnmod
  cp -R $srcdir $_svnmod
  cd $pkgdir/usr/bin
  sed -i 's|`dirname $0`|/usr/src/metasploit|g' $pkgdir/usr/src/$_svnmod/msfgui
  ls ../src/$_svnmod/msf* |xargs -n 1 ln -s
  install -Dm644 $pkgdir/usr/src/$_svnmod/README $pkgdir/usr/share/licenses/$pkgname/COPYING
}
# vim:syntax=sh
