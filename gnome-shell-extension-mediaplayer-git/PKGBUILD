# Maintainer: Alucryd <alucryd@gmail.com>
pkgname=gnome-shell-extension-mediaplayer-git
pkgver=20110610
pkgrel=1
pkgdesc="A mediaplayer indicator for the Gnome Shell"
arch=('any')
url="https://github.com/eonpatapon/gnome-shell-extensions-mediaplayer"
license=('GPL3')
depends=('gnome-shell')
makedepends=('git')

_gitroot="https://github.com/eonpatapon/gnome-shell-extensions-mediaplayer.git"
_gitname="gnome-shell-extension-mediaplayer"

build() {
    cd ${srcdir}
    msg "Connecting to the GIT server..."
    if [[ -d ${srcdir}/${_gitname} ]] ; then
    	cd ${_gitname}
    	git pull origin
    	msg "The local files are updated..."
    else
    	git clone ${_gitroot} ${_gitname}
        cd ${_gitname}
    fi
    msg "GIT checkout done."
    ./autogen.sh --prefix=/usr
    make
}

package() {
    cd "$srcdir/${_gitname}"
    make DESTDIR="${pkgdir}" install
    cd $pkgdir/usr/share/gnome-shell/extensions/mediaplayer@patapon.info
    msg "Modifying extension to support player of your choice."
    echo "Please select your mediaplayer :"
    select mp in "Banshee" "Clementine" "MPD" "Quod Libet" "Rhythmbox"; do
         case $mp in
            "Banshee" ) sed -i 's/mpd/banshee/g' extension.js; break;;
            "Clementine" ) sed -i 's/mpd/clementine/g' extension.js; break;;
            "MPD" ) break;;
            "Quod Libet" ) sed -i 's/mpd/quodlibet/g' extension.js; break;;
            "Rhythmbox" ) sed -i 's/mpd/rhythmbox/g' extension.js; break;;
        esac
    done
}

