# Maintainer: bwrsandman <bwrsandman@gmail.com>
pkgname=ogitor-hg
_hgroot="https://bitbucket.org/jacmoe/ogitor"
_hgrepo="ogitor"
pkgver=725.92fddb6edf3b
pkgrel=1
pkgdesc="Scene editing framework for Ogre3D"
arch=('i686' 'x86_64')
url='http://www.ogitor.org'
license=('LGPL')
depends=('ogre>=1.9' 'qt4')
makedepends=('cmake' 'mercurial' 'unzip')
conflicts=('ogitor')
provides=('ogitor')

source=(${_hgrepo}::hg+${_hgroot}
        https://bitbucket.org/jacmoe/ogitor/downloads/media.zip
        https://bitbucket.org/jacmoe/ogitor/downloads/projects.zip)
md5sums=('SKIP'
         'c43578ed01e383a0eebd0719ae4241f8'
         'b93a9391b3d6e4d835e6a9bfffb3e6e9')

pkgver() {
  cd ${_hgrepo}
  echo "$(hg identify -n).$(hg identify -i)"
}

build() {
  cd ${srcdir}
  if [ -d $_hgrepo-build ]; then
	  rm -rf $_hgrepo-build
  fi
  hg clone $_hgrepo $_hgrepo-build
  cd $_hgrepo-build

  unzip -d RunPath ${srcdir}/media.zip
  unzip -d RunPath ${srcdir}/projects.zip

  cmake . -DCMAKE_INSTALL_PREFIX=/usr
  make 
}

package() {
  make DESTDIR=${pkgdir} install 
}
