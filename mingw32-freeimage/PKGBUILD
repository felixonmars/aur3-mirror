# Maintainer: Sven-Hendrik Haase <sh@lutzhaase.com>
# Contributor: Stefan Husmann <stefan-husmann@t-online.de>
# Contributor: Mihai Militaru <mihai.militaru@gmx.com>
# Contributor: scippio <scippio@berounet.cz>
pkgname=mingw32-freeimage
pkgver=3.15.1
pkgrel=1
pkgdesc="Library project for developers who would like to support popular graphics image formats (mingw32)"
arch=(any)
license=('GPL' 'custom:FIPL')
url="http://freeimage.sourceforge.net/"
depends=('mingw32-gcc')
makedepends=('hd2u')
options=(!strip !buildflags)
source=("http://downloads.sourceforge.net/sourceforge/freeimage/FreeImage${pkgver//./}.zip")
md5sums=('450d2ff278690b0d1d7d7d58fad083cc')

build() {
  cd ${srcdir}/FreeImage
  unset CFLAGS CXXFLAGS LDFLAGS
  make CC="i486-mingw32-gcc" CXX="i486-mingw32-g++" LD="i486-mingw32-g++" RC="i486-mingw32-windres" AR="i486-mingw32-ar" FREEIMAGE_LIBRARY_TYPE="STATIC" -f Makefile.mingw
}

package() {
  cd ${srcdir}/FreeImage
  install -Dm644 Dist/FreeImage.h ${pkgdir}/usr/i486-mingw32/include/FreeImage.h
  install -Dm644 Dist/FreeImage.a ${pkgdir}/usr/i486-mingw32/lib/libfreeimage.a
  #make DESTDIR=${pkgdir} install || return 1
  #make -f Makefile.fip || return 1
  #make -f Makefile.fip DESTDIR=${pkgdir} install || return 1
  #install -Dm644 $srcdir/FreeImage/license-fi.txt \
  #  $pkgdir/usr/share/licenses/$pkgname/license-fi.txt
}
