# Maintainer:  TDY <tdy@gmx.com>
# Contributor: Nicol√°s de la Torre <ndelatorre@gmail.com>

pkgname=ulipad
pkgver=4.0
pkgrel=2
pkgdesc="A flexible coding editor"
arch=('i686' 'x86_64')
url="http://ulipad.googlecode.com/"
license=('GPL')
depends=('wxpython')
optdepends=('psyco:     psyco speed support'
            'pyenchant: spell checking support')
source=(http://ulipad.googlecode.com/files/ulipad.$pkgver.zip
        ulipad.launcher ulipad.desktop)
noextract=(ulipad.$pkgver.zip)
md5sums=('62d7b2feacf2be48eb326d7b56c7027e'
         'abf16499ea904c1689b1a036851fda86'
         'ec7100db9ecca658e800ace09ba2c6b3')

build() {
  cd "$srcdir"
  install -dm755 "$pkgdir/usr/share"
  bsdtar -xf ulipad.$pkgver.zip -C "$pkgdir/usr/share" || return 1
  install -Dm644 ulipad.desktop "$pkgdir/usr/share/applications/ulipad.desktop"
  install -Dm755 ulipad.launcher "$pkgdir/usr/bin/ulipad"
  sed -i "s/VERS=.*/VERS=$pkgver/" "$pkgdir/usr/bin/ulipad"

  find "$pkgdir/usr/share/ulipad" -maxdepth 1 -type f ! -name '*d.[ip]*' -delete
  find "$pkgdir/usr/share/ulipad" -type d -exec chmod 755 '{}' \;
  find "$pkgdir/usr/share/ulipad" -type f -exec chmod 644 '{}' + \
    -exec sed -i 's,env python,&2,' '{}' \;
}
