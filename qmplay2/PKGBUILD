# Contributer: giacomogiorgianni@gmail.com 

pkgname=qmplay2
_name=QMPlay2
pkgver=198
pkgrel=2
pkgdesc="QMPlay2 is a video player,it can plays all formats and stream supported by ffmpeg and libmodplug (including J2B). It has integrated Youtube and Wrzuta.pl browse"
arch=('i686' 'x86_64')
url="http://qt-apps.org/content/show.php/QMPlay2?content=153339"
license=('LGPL')
depends=('qt>=4.7' 'ffmpeg' 'libass' 'libva' 'libxv' 'portaudio' 'pulseaudio')
makedepends=('make')
#install=${pkgname}.install
#changelog=$pkgname.changelog
source=("http://zaps166.sourceforge.net/?counter=QMPlay2&dwn=qmplay2/QMPlay2.tar.bz2")
md5sums=(95a59e87ddfda837b88b32de8e9e292c)

build() {
  cd $srcdir/$_name
  lrelease QMPlay2.pro
  qmake PREFIX=/usr -Wnone
  make || return 1
}

package() {
   mkdir $pkgdir/usr
   sed -i '2s|QMPlay2_gui|qmplay2_gui|' $srcdir/$_name/$_name.desktop
   sed -i '3s|src/gui/icons/QMPlay2.png|/usr/share/pixmaps/QMPlay2.png|' $srcdir/$_name/$_name.desktop
  
  # desktop 
   install -Dm644 $srcdir/$_name/$_name.desktop \
    "$pkgdir/usr/share/applications/$_name.desktop"
 
  # icon
  install -Dm644 $srcdir/$_name/src/gui/icons/$_name.png \
    "$pkgdir/usr/share/pixmaps/$_name.png"
 
   cp -R $srcdir/$_name/app/{bin,lib,share} $pkgdir/usr
   cp -R $srcdir/$_name/lang/*.* $pkgdir/usr/share/$pkgname/lang/
   cp -R $srcdir/$_name/src/modules/Extensions/Scripts $pkgdir/usr/share/qmplay2/BrowserEngine
}
