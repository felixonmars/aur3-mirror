# Contributor: Marcus Carlsson <carlsson.marcus@gmail.com>
# Ported to a stable release by <prurigro@gmail.com>
pkgname=ircd-ratbox
pkgver=3.0.7
pkgrel=1
pkgdesc="ircd-ratbox irc daemon"
url="http://www.ircd-ratbox.org/"
arch=('i686' 'x86_64')
depends=('openssl')
license=('GPL')
source=("http://www.ratbox.org/download/${pkgname}-$pkgver.tar.bz2"
        "ircd")
install='ircd-ratbox.install'
md5sums=('9b6d129038b00ca1194f242e1a21c168'
         'd43dae868ef7359e6030524fdb94cade')

build() {
    cd $srcdir/${pkgname}-$pkgver

    echo "Configurating package..."
    ./configure --prefix=/usr/local/ircd-ratbox \
    --with-confdir=/etc/ircd-ratbox \
    --with-logdir=/var/log/ircd-ratbox \
    --bindir=/usr/sbin \
    --with-nicklen=12 || return 1

    echo "Starting make..."
    make || return 1
    cd contrib/
    make || return 1
    echo "Installing..."
    mkdir -p $pkgdir/etc/ircd-ratbox
    cd $srcdir/${pkgname}-$pkgver
    make DESTDIR=$pkgdir install || return 1

    mkdir -p $pkgdir/usr/local/${pkgname}/modules/contrib/
    cp $srcdir/${pkgname}-$pkgver/contrib/.libs/*.so $pkgdir/usr/local/${pkgname}/modules/contrib/
    install -D -m755 "$srcdir/ircd" "$pkgdir/etc/rc.d/ircd"
}
