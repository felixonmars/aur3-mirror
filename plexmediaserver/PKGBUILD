# Contributor: Arthur <arthur.darcet@m4x.org>
pkgname=plexmediaserver
pkgver=0.9.5.0
pkgrel=2
pkgdesc="Plex Media Server for Linux"
url="http://www.plexapp.com"
arch=('i686' 'x86_64')
license=('closed')
depends=('avahi' 'rsync')
replace=('plex')

install='plexmediaserver.install'

if [ "$CARCH" = "i686" ]; then
	_arch='i386'
	md5sums=('74b8eafa959548566115080d16900af6')
elif [ "$CARCH" = "x86_64" ]; then
	_arch='amd64'
	md5sums=('94280c6aa43b02b3d606d612472b9288')
	depends+=('lib32-libxml2' 'lib32-sqlite3' 'lib32-boost-libs' 'lib32-curl')
fi

source=("http://www.plexapp.com/repo/pool/main/p/plexmediaserver/plexmediaserver_${pkgver}-417b653_${_arch}.deb" 'plexmediaserver')
md5sums+=('0c25cb35d0213bbe8c0c085a13179550')


build() {
	ar -xv plexmediaserver_${pkgver}-417b653_${_arch}.deb || return 1
	tar -zxf data.tar.gz || return 1
}

package(){
	mkdir -p $pkgdir/usr/lib/plexmediaserver
	mkdir -p $pkgdir/etc/rc.d
	
	cp -r usr/lib/plexmediaserver/* $pkgdir/usr/lib/plexmediaserver/
	install -D -m644 etc/default/plexmediaserver $pkgdir/etc/plexmediaserver.conf
	install -D -m755 plexmediaserver $pkgdir/etc/rc.d/
}
