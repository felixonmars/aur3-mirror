# Contributor: Christoph Zeiler <archNOSPAM_at_moonblade.dot.org>
# Contributor : Cedric Mathieu <me.xenom[at]gmail.com>

pkgname=gambatte
pkgver=0.4.1
pkgrel=6
pkgdesc="An accuracy-focused Game Boy Color emulator"
arch=('i686' 'x86_64')
url="http://sourceforge.net/projects/$pkgname/"
license=('GPL')
depends=('gcc-libs' 'sdl' 'zlib')
optdepends=('gambatte-qt: Qt4 frontend')
makedepends=('scons')
source=(http://downloads.sourceforge.net/$pkgname/${pkgname}_src-$pkgver.tar.gz \
	gambatte-0.4.1-gcc44.patch \
	SConstruct.patch \
	$pkgname.desktop)
 
md5sums=('cfe52c33bbb2e719a957bde64427a18c'
	 '25fe84fb82860f13d4bf747450cf5933'
	 'c12f7a9dca2a39c1cdf5344b3807eccb'
	 '0c3a3f1ca7a24758febb7f7344157edd')

build() {
  cd ${pkgname}_src-$pkgver

  patch -p1 -i ../gambatte-0.4.1-gcc44.patch || return 1
  patch -Np0 -i ../SConstruct.patch || return 1


  for i in libgambatte gambatte_sdl; do
	cd $i
	scons CXXFLAGS="${CXXFLAGS}" || return 1
	cd ..
  done
  
  install -Dm755 gambatte_sdl/gambatte_sdl "$pkgdir"/usr/bin/$pkgname
  install -Dm644 libgambatte/libgambatte.so "$pkgdir"/usr/lib/libgambatte.so 
  install -Dm644 gambatte_sdl/man/gambatte_sdl.6 "$pkgdir"/usr/share/man/man6/$pkgname.6
}
