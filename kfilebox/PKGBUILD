# Maintainer: (epsilom) Xavier Corredor <xavier.corredor.llano (a) gmail.com>
# Old-Mantainer: Gonzalo Seguel <gonzaloseguel@gmail.com>

pkgname=kfilebox
pkgver=0.4.7
pkgrel=2
pkgdesc="KDE4 Dropbox client (with own daemon)"
arch=(i686 x86_64)
url="http://kdropbox.deuteros.es"
license=('GPL')
depends=(kdebase-workspace gettext)
provides=(dropbox)
replaces=(kdropbox)
source=(http://downloads.sourceforge.net/project/kdropbox/kfilebox-${pkgver}/Source/${pkgname}-${pkgver}.tar.gz kfilebox.pro)
install=$pkgname.install
md5sums=('7a85e725f49f58a0289504e1a021297e'
         '69ddadaccfb4ac5a7d062ee3251ea42b')

build() {
    cp -r kfilebox.pro ${srcdir}/${pkgname}-${pkgver}/kfilebox.pro
    cd "${srcdir}/${pkgname}-${pkgver}"
    qmake
    make || return 1
}

package() {
    cd "${srcdir}/${pkgname}-${pkgver}"
    make INSTALL_ROOT=${pkgdir} install || return 1
    #install locales
    for language in `ls ${srcdir}/${pkgname}-${pkgver}/locale`
    do
      if [ -e ${srcdir}/${pkgname}-${pkgver}/locale/$language/kfilebox.mo ]; then
	install -m 644 -p -D ${srcdir}/${pkgname}-${pkgver}/locale/$language/kfilebox.mo ${pkgdir}/usr/share/locale/$language/LC_MESSAGES/kfilebox.mo
      fi
    done
}
