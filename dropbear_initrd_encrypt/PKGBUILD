pkgname=dropbear_initrd_encrypt
pkgver=0.9
pkgrel=1
pkgdesc="provides SSH access in initrd to enter root luks passphrase "
arch=(i686 x86_64)
url="https://mw.vc/2009/08/08/luks-pass-over-ssh-archlinux/"
license=('GPL')
depends=('dropbear' 'cryptsetup' 'mkinitcpio-nfs-utils' 'psmisc' 'iproute2')
install=$pkgname.install
source=(dropbear_hook dropbear_install encryptssh_hook encryptssh_install)
md5sums=('1ffcec1d8e9227f65f79836626ffe453'
         '51d2ff30ddbe7e3d3a9696792e9b60dd'
         '39dd7d75248c3cb4ea624dc72a8b5459'
         '9a44a30cd9e5fe51e6bf103f32484ceb')
backup=('lib/initcpio/hooks/dropbear'
        'lib/initcpio/hooks/encryptssh'
        'lib/initcpio/install/dropbear'
        'lib/initcpio/install/encryptssh')

build() {
  install -Dm644 "$srcdir"/dropbear_hook "$pkgdir"/lib/initcpio/hooks/dropbear
  install -Dm644 "$srcdir"/dropbear_install "$pkgdir"/lib/initcpio/install/dropbear
  install -Dm644 "$srcdir"/encryptssh_hook "$pkgdir"/lib/initcpio/hooks/encryptssh
  install -Dm644 "$srcdir"/encryptssh_install "$pkgdir"/lib/initcpio/install/encryptssh
}
