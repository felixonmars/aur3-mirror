From 71b3d5695c990538b7172f33598d46d2d399186f Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 05:33:11 -0400
Subject: [PATCH 01/13] The 1.7.2 update up until things stop merging nicely

---
 core/src/com/watabou/pixeldungeon/Assets.java      |   2 +-
 core/src/com/watabou/pixeldungeon/Badges.java      |   9 +-
 core/src/com/watabou/pixeldungeon/Bones.java       |   1 -
 core/src/com/watabou/pixeldungeon/Challenges.java  |  41 +++
 core/src/com/watabou/pixeldungeon/Chrome.java      |   6 +-
 core/src/com/watabou/pixeldungeon/Dungeon.java     |  24 +-
 .../com/watabou/pixeldungeon/DungeonTilemap.java   |   3 +-
 core/src/com/watabou/pixeldungeon/FogOfWar.java    |   1 -
 .../com/watabou/pixeldungeon/GamesInProgress.java  |   5 +-
 core/src/com/watabou/pixeldungeon/Journal.java     |   1 -
 .../src/com/watabou/pixeldungeon/PixelDungeon.java |  19 +-
 core/src/com/watabou/pixeldungeon/Preferences.java |   3 +-
 core/src/com/watabou/pixeldungeon/Rankings.java    |   1 -
 .../watabou/pixeldungeon/ResultDescriptions.java   |   1 -
 core/src/com/watabou/pixeldungeon/Statistics.java  |   1 -
 .../src/com/watabou/pixeldungeon/actors/Actor.java |  17 +-
 core/src/com/watabou/pixeldungeon/actors/Char.java |  26 +-
 .../watabou/pixeldungeon/actors/blobs/Alchemy.java |   1 -
 .../watabou/pixeldungeon/actors/blobs/Blob.java    |   1 -
 .../pixeldungeon/actors/blobs/ConfusionGas.java    |  51 +++
 .../watabou/pixeldungeon/actors/blobs/Fire.java    |   1 -
 .../watabou/pixeldungeon/actors/blobs/Foliage.java |   1 -
 .../pixeldungeon/actors/blobs/Freezing.java        |   1 -
 .../pixeldungeon/actors/blobs/ParalyticGas.java    |   1 -
 .../pixeldungeon/actors/blobs/Regrowth.java        |   1 -
 .../pixeldungeon/actors/blobs/ToxicGas.java        |   6 +-
 .../actors/blobs/WaterOfAwareness.java             |   1 -
 .../pixeldungeon/actors/blobs/WaterOfHealth.java   |   1 -
 .../actors/blobs/WaterOfTransmutation.java         |   1 -
 .../com/watabou/pixeldungeon/actors/blobs/Web.java |   1 -
 .../pixeldungeon/actors/blobs/WellWater.java       |   1 -
 .../watabou/pixeldungeon/actors/buffs/Amok.java    |   1 -
 .../pixeldungeon/actors/buffs/Awareness.java       |   1 -
 .../pixeldungeon/actors/buffs/Barkskin.java        |   3 +-
 .../pixeldungeon/actors/buffs/Bleeding.java        |   1 -
 .../pixeldungeon/actors/buffs/Blindness.java       |   3 +-
 .../watabou/pixeldungeon/actors/buffs/Buff.java    |   1 -
 .../watabou/pixeldungeon/actors/buffs/Burning.java |   1 -
 .../watabou/pixeldungeon/actors/buffs/Charm.java   |   1 -
 .../watabou/pixeldungeon/actors/buffs/Combo.java   |   1 -
 .../watabou/pixeldungeon/actors/buffs/Cripple.java |   1 -
 .../pixeldungeon/actors/buffs/FlavourBuff.java     |   3 +-
 .../watabou/pixeldungeon/actors/buffs/Frost.java   |   1 -
 .../watabou/pixeldungeon/actors/buffs/Fury.java    |   1 -
 .../pixeldungeon/actors/buffs/GasesImmunity.java   |   1 -
 .../watabou/pixeldungeon/actors/buffs/Hunger.java  |   1 -
 .../pixeldungeon/actors/buffs/Invisibility.java    |   1 -
 .../pixeldungeon/actors/buffs/Levitation.java      |   1 -
 .../watabou/pixeldungeon/actors/buffs/Light.java   |   1 -
 .../pixeldungeon/actors/buffs/MindVision.java      |   1 -
 .../watabou/pixeldungeon/actors/buffs/Ooze.java    |   1 -
 .../pixeldungeon/actors/buffs/Paralysis.java       |   3 +-
 .../watabou/pixeldungeon/actors/buffs/Poison.java  |   5 +-
 .../pixeldungeon/actors/buffs/Regeneration.java    |   8 +-
 .../watabou/pixeldungeon/actors/buffs/Roots.java   |   1 -
 .../watabou/pixeldungeon/actors/buffs/Shadows.java |   1 -
 .../watabou/pixeldungeon/actors/buffs/Sleep.java   |   1 -
 .../watabou/pixeldungeon/actors/buffs/Slow.java    |   3 +-
 .../pixeldungeon/actors/buffs/SnipersMark.java     |   1 -
 .../watabou/pixeldungeon/actors/buffs/Speed.java   |   1 -
 .../watabou/pixeldungeon/actors/buffs/Terror.java  |   1 -
 .../watabou/pixeldungeon/actors/buffs/Vertigo.java |  41 +++
 .../pixeldungeon/actors/buffs/Weakness.java        |   1 -
 .../pixeldungeon/actors/hero/Belongings.java       |   8 +-
 .../com/watabou/pixeldungeon/actors/hero/Hero.java | 189 ++++++-----
 .../pixeldungeon/actors/hero/HeroAction.java       |   8 +-
 .../pixeldungeon/actors/hero/HeroClass.java        |  50 +--
 .../pixeldungeon/actors/hero/HeroSubClass.java     |   7 +-
 .../watabou/pixeldungeon/actors/mobs/Acidic.java   |   1 -
 .../watabou/pixeldungeon/actors/mobs/Albino.java   |   1 -
 .../watabou/pixeldungeon/actors/mobs/Bandit.java   |   1 -
 .../com/watabou/pixeldungeon/actors/mobs/Bat.java  |   1 -
 .../watabou/pixeldungeon/actors/mobs/Bestiary.java |   1 -
 .../watabou/pixeldungeon/actors/mobs/Brute.java    |   1 -
 .../com/watabou/pixeldungeon/actors/mobs/Crab.java |   1 -
 .../watabou/pixeldungeon/actors/mobs/DM300.java    |  11 +-
 .../pixeldungeon/actors/mobs/Elemental.java        |   1 -
 .../com/watabou/pixeldungeon/actors/mobs/Eye.java  |   2 +-
 .../watabou/pixeldungeon/actors/mobs/Gnoll.java    |   1 -
 .../watabou/pixeldungeon/actors/mobs/Golem.java    |   1 -
 .../com/watabou/pixeldungeon/actors/mobs/Goo.java  |   3 +-
 .../com/watabou/pixeldungeon/actors/mobs/King.java |   6 +-
 .../com/watabou/pixeldungeon/actors/mobs/Mob.java  | 351 ++++++++++++---------
 .../com/watabou/pixeldungeon/actors/mobs/Monk.java |   1 -
 .../watabou/pixeldungeon/actors/mobs/Piranha.java  |   1 -
 .../com/watabou/pixeldungeon/actors/mobs/Rat.java  |   1 -
 .../watabou/pixeldungeon/actors/mobs/Scorpio.java  |   3 +-
 .../watabou/pixeldungeon/actors/mobs/Senior.java   |   1 -
 .../watabou/pixeldungeon/actors/mobs/Shaman.java   |   1 -
 .../watabou/pixeldungeon/actors/mobs/Shielded.java |   1 -
 .../watabou/pixeldungeon/actors/mobs/Skeleton.java |   1 -
 .../watabou/pixeldungeon/actors/mobs/Spinner.java  |  33 +-
 .../watabou/pixeldungeon/actors/mobs/Statue.java   |   9 +-
 .../watabou/pixeldungeon/actors/mobs/Succubus.java |   1 -
 .../watabou/pixeldungeon/actors/mobs/Swarm.java    |   3 +-
 .../watabou/pixeldungeon/actors/mobs/Tengu.java    |   3 +-
 .../watabou/pixeldungeon/actors/mobs/Thief.java    |  29 +-
 .../watabou/pixeldungeon/actors/mobs/Warlock.java  |   1 -
 .../watabou/pixeldungeon/actors/mobs/Wraith.java   |   5 +-
 .../com/watabou/pixeldungeon/actors/mobs/Yog.java  |  11 +-
 .../pixeldungeon/actors/mobs/npcs/Blacksmith.java  |   6 +-
 .../pixeldungeon/actors/mobs/npcs/Ghost.java       |  25 +-
 .../watabou/pixeldungeon/actors/mobs/npcs/Imp.java |   3 +-
 .../actors/mobs/npcs/ImpShopkeeper.java            |   1 -
 .../pixeldungeon/actors/mobs/npcs/MirrorImage.java |  18 +-
 .../watabou/pixeldungeon/actors/mobs/npcs/NPC.java |  51 +++
 .../pixeldungeon/actors/mobs/npcs/RatKing.java     |  10 +-
 .../pixeldungeon/actors/mobs/npcs/Shopkeeper.java  |   4 +-
 .../pixeldungeon/actors/mobs/npcs/Wandmaker.java   |   3 +-
 .../watabou/pixeldungeon/effects/BadgeBanner.java  |   4 +-
 .../pixeldungeon/effects/BannerSprites.java        |   7 +-
 .../watabou/pixeldungeon/effects/BlobEmitter.java  |   1 -
 .../watabou/pixeldungeon/effects/CellEmitter.java  |   1 -
 .../watabou/pixeldungeon/effects/CheckedCell.java  |   1 -
 .../com/watabou/pixeldungeon/effects/DeathRay.java |   3 +-
 .../com/watabou/pixeldungeon/effects/Effects.java  |   1 -
 .../com/watabou/pixeldungeon/effects/EmoIcon.java  |   1 -
 .../com/watabou/pixeldungeon/effects/Fireball.java |   1 -
 .../com/watabou/pixeldungeon/effects/Flare.java    |   2 +-
 .../watabou/pixeldungeon/effects/FloatingText.java |   1 -
 .../src/com/watabou/pixeldungeon/effects/Halo.java |   1 -
 .../com/watabou/pixeldungeon/effects/IceBlock.java |   1 -
 .../pixeldungeon/effects/Identification.java       |   1 -
 .../watabou/pixeldungeon/effects/Lightning.java    |   1 -
 .../watabou/pixeldungeon/effects/MagicMissile.java |   1 -
 .../com/watabou/pixeldungeon/effects/Pushing.java  |   1 -
 .../com/watabou/pixeldungeon/effects/Ripple.java   |   1 -
 .../com/watabou/pixeldungeon/effects/Speck.java    |  19 +-
 .../watabou/pixeldungeon/effects/SpellSprite.java  |   1 -
 .../com/watabou/pixeldungeon/effects/Splash.java   |   1 -
 .../watabou/pixeldungeon/effects/TorchHalo.java    |   1 -
 .../com/watabou/pixeldungeon/effects/Wound.java    |   1 -
 .../effects/particles/BloodParticle.java           |   1 -
 .../effects/particles/EarthParticle.java           |   1 -
 .../effects/particles/ElmoParticle.java            |   1 -
 .../effects/particles/EnergyParticle.java          |   1 -
 .../effects/particles/FlameParticle.java           |   1 -
 .../effects/particles/FlowParticle.java            |   1 -
 .../effects/particles/LeafParticle.java            |   1 -
 .../effects/particles/PoisonParticle.java          |   1 -
 .../effects/particles/PurpleParticle.java          |   1 -
 .../effects/particles/ShadowParticle.java          |   1 -
 .../effects/particles/ShaftParticle.java           |   1 -
 .../effects/particles/SnowParticle.java            |   1 -
 .../effects/particles/SparkParticle.java           |   1 -
 .../effects/particles/WebParticle.java             |   1 -
 .../effects/particles/WindParticle.java            |   1 -
 .../effects/particles/WoolParticle.java            |   1 -
 .../src/com/watabou/pixeldungeon/items/Amulet.java |   3 -
 core/src/com/watabou/pixeldungeon/items/Ankh.java  |   1 -
 .../com/watabou/pixeldungeon/items/ArmorKit.java   |   1 -
 .../com/watabou/pixeldungeon/items/DewVial.java    |   1 -
 .../com/watabou/pixeldungeon/items/Dewdrop.java    |   1 -
 .../watabou/pixeldungeon/items/EquipableItem.java  |  41 ++-
 .../com/watabou/pixeldungeon/items/Generator.java  |   3 +-
 core/src/com/watabou/pixeldungeon/items/Gold.java  |   1 -
 core/src/com/watabou/pixeldungeon/items/Heap.java  |   4 +-
 core/src/com/watabou/pixeldungeon/items/Item.java  |  14 +-
 .../pixeldungeon/items/ItemStatusHandler.java      |   1 -
 .../watabou/pixeldungeon/items/KindOfWeapon.java   |  25 +-
 .../watabou/pixeldungeon/items/LloydsBeacon.java   |   1 -
 .../src/com/watabou/pixeldungeon/items/Stylus.java |   1 -
 .../watabou/pixeldungeon/items/TomeOfMastery.java  |   1 -
 core/src/com/watabou/pixeldungeon/items/Torch.java |   1 -
 .../watabou/pixeldungeon/items/Weightstone.java    | 194 ++++++++++++
 .../watabou/pixeldungeon/items/armor/Armor.java    |  38 ++-
 .../pixeldungeon/items/armor/ClassArmor.java       |   5 +-
 .../pixeldungeon/items/armor/ClothArmor.java       |   1 -
 .../pixeldungeon/items/armor/HuntressArmor.java    |   3 +-
 .../pixeldungeon/items/armor/LeatherArmor.java     |   1 -
 .../pixeldungeon/items/armor/MageArmor.java        |   5 +-
 .../pixeldungeon/items/armor/MailArmor.java        |   1 -
 .../pixeldungeon/items/armor/PlateArmor.java       |   1 -
 .../pixeldungeon/items/armor/RogueArmor.java       |   6 +-
 .../pixeldungeon/items/armor/ScaleArmor.java       |   1 -
 .../pixeldungeon/items/armor/WarriorArmor.java     |  47 +--
 .../pixeldungeon/items/armor/glyphs/Affection.java |   1 -
 .../items/armor/glyphs/AntiEntropy.java            |   1 -
 .../pixeldungeon/items/armor/glyphs/Bounce.java    |   1 -
 .../items/armor/glyphs/Displacement.java           |   1 -
 .../items/armor/glyphs/Entanglement.java           |   1 -
 .../items/armor/glyphs/Metabolism.java             |   5 +-
 .../items/armor/glyphs/Multiplicity.java           |   1 -
 .../pixeldungeon/items/armor/glyphs/Potential.java |   1 -
 .../pixeldungeon/items/armor/glyphs/Stench.java    |   1 -
 .../pixeldungeon/items/armor/glyphs/Viscosity.java |   3 +-
 .../com/watabou/pixeldungeon/items/bags/Bag.java   |   6 +-
 .../pixeldungeon/items/bags/ScrollHolder.java      |   1 -
 .../watabou/pixeldungeon/items/bags/SeedPouch.java |   1 -
 .../pixeldungeon/items/bags/WandHolster.java       |   6 +-
 .../pixeldungeon/items/food/ChargrilledMeat.java   |   1 -
 .../com/watabou/pixeldungeon/items/food/Food.java  |   1 -
 .../pixeldungeon/items/food/FrozenCarpaccio.java   |   1 -
 .../pixeldungeon/items/food/MysteryMeat.java       |   3 +-
 .../pixeldungeon/items/food/OverpricedRation.java  |   1 -
 .../com/watabou/pixeldungeon/items/food/Pasty.java |   1 -
 .../watabou/pixeldungeon/items/keys/GoldenKey.java |  10 -
 .../watabou/pixeldungeon/items/keys/IronKey.java   |  19 +-
 .../com/watabou/pixeldungeon/items/keys/Key.java   |  23 +-
 .../pixeldungeon/items/keys/SkeletonKey.java       |  20 +-
 .../watabou/pixeldungeon/items/potions/Potion.java |   1 -
 .../items/potions/PotionOfExperience.java          |   1 -
 .../pixeldungeon/items/potions/PotionOfFrost.java  |   1 -
 .../items/potions/PotionOfHealing.java             |   1 -
 .../items/potions/PotionOfInvisibility.java        |   1 -
 .../items/potions/PotionOfLevitation.java          |   1 -
 .../items/potions/PotionOfLiquidFlame.java         |   1 -
 .../pixeldungeon/items/potions/PotionOfMight.java  |   1 -
 .../items/potions/PotionOfMindVision.java          |   1 -
 .../items/potions/PotionOfParalyticGas.java        |   1 -
 .../pixeldungeon/items/potions/PotionOfPurity.java |   1 -
 .../items/potions/PotionOfStrength.java            |   1 -
 .../items/potions/PotionOfToxicGas.java            |   1 -
 .../pixeldungeon/items/quest/CorpseDust.java       |   1 -
 .../watabou/pixeldungeon/items/quest/DarkGold.java |   1 -
 .../pixeldungeon/items/quest/DriedRose.java        |   1 -
 .../pixeldungeon/items/quest/DwarfToken.java       |   1 -
 .../watabou/pixeldungeon/items/quest/Pickaxe.java  |   1 -
 .../watabou/pixeldungeon/items/quest/RatSkull.java |   1 -
 .../com/watabou/pixeldungeon/items/rings/Ring.java |  41 ++-
 .../pixeldungeon/items/rings/RingOfAccuracy.java   |   1 -
 .../pixeldungeon/items/rings/RingOfDetection.java  |   1 -
 .../pixeldungeon/items/rings/RingOfElements.java   |   1 -
 .../pixeldungeon/items/rings/RingOfEvasion.java    |   1 -
 .../pixeldungeon/items/rings/RingOfHaggler.java    |   1 -
 .../pixeldungeon/items/rings/RingOfHaste.java      |   1 -
 .../pixeldungeon/items/rings/RingOfHerbalism.java  |   1 -
 .../pixeldungeon/items/rings/RingOfMending.java    |   1 -
 .../pixeldungeon/items/rings/RingOfPower.java      |   1 -
 .../pixeldungeon/items/rings/RingOfSatiety.java    |   1 -
 .../pixeldungeon/items/rings/RingOfShadows.java    |   1 -
 .../pixeldungeon/items/rings/RingOfThorns.java     |   1 -
 .../items/scrolls/InventoryScroll.java             |   5 +-
 .../watabou/pixeldungeon/items/scrolls/Scroll.java |   1 -
 .../items/scrolls/ScrollOfChallenge.java           |   1 -
 .../items/scrolls/ScrollOfIdentify.java            |   1 -
 .../items/scrolls/ScrollOfLullaby.java             |   1 -
 .../items/scrolls/ScrollOfMagicMapping.java        |   1 -
 .../items/scrolls/ScrollOfMirrorImage.java         |   1 -
 .../items/scrolls/ScrollOfPsionicBlast.java        |   1 -
 .../items/scrolls/ScrollOfRecharging.java          |   1 -
 .../items/scrolls/ScrollOfRemoveCurse.java         |   1 -
 .../items/scrolls/ScrollOfTeleportation.java       |   1 -
 .../pixeldungeon/items/scrolls/ScrollOfTerror.java |   1 -
 .../items/scrolls/ScrollOfUpgrade.java             |   1 -
 .../items/scrolls/ScrollOfWeaponUpgrade.java       |   1 -
 .../com/watabou/pixeldungeon/items/wands/Wand.java |   8 +-
 .../pixeldungeon/items/wands/WandOfAmok.java       |   9 +-
 .../pixeldungeon/items/wands/WandOfAvalanche.java  |   1 -
 .../pixeldungeon/items/wands/WandOfBlink.java      |   1 -
 .../items/wands/WandOfDisintegration.java          |   1 -
 .../pixeldungeon/items/wands/WandOfFirebolt.java   |   1 -
 .../pixeldungeon/items/wands/WandOfFlock.java      |   5 +-
 .../pixeldungeon/items/wands/WandOfLightning.java  |   4 +-
 .../items/wands/WandOfMagicMissile.java            |   1 -
 .../pixeldungeon/items/wands/WandOfPoison.java     |   5 +-
 .../pixeldungeon/items/wands/WandOfRegrowth.java   |   1 -
 .../pixeldungeon/items/wands/WandOfSlowness.java   |   1 -
 .../items/wands/WandOfTelekinesis.java             |   5 +-
 .../items/wands/WandOfTeleportation.java           |   1 -
 .../watabou/pixeldungeon/items/weapon/Weapon.java  |  23 +-
 .../items/weapon/enchantments/Death.java           |   1 -
 .../items/weapon/enchantments/Fire.java            |   1 -
 .../items/weapon/enchantments/Horror.java          |  10 +-
 .../items/weapon/enchantments/Instability.java     |   1 -
 .../items/weapon/enchantments/Leech.java           |   1 -
 .../items/weapon/enchantments/Luck.java            |   1 -
 .../items/weapon/enchantments/Paralysis.java       |   1 -
 .../items/weapon/enchantments/Piercing.java        |   1 -
 .../items/weapon/enchantments/Poison.java          |   1 -
 .../items/weapon/enchantments/Slow.java            |   1 -
 .../items/weapon/enchantments/Swing.java           |   1 -
 .../pixeldungeon/items/weapon/melee/BattleAxe.java |   1 -
 .../pixeldungeon/items/weapon/melee/Dagger.java    |   1 -
 .../pixeldungeon/items/weapon/melee/Glaive.java    |   1 -
 .../pixeldungeon/items/weapon/melee/Knuckles.java  |   1 -
 .../pixeldungeon/items/weapon/melee/Longsword.java |   1 -
 .../pixeldungeon/items/weapon/melee/Mace.java      |   1 -
 .../items/weapon/melee/MeleeWeapon.java            |  10 +-
 .../items/weapon/melee/Quarterstaff.java           |   2 -
 .../items/weapon/melee/ShortSword.java             |   1 -
 .../pixeldungeon/items/weapon/melee/Spear.java     |   1 -
 .../pixeldungeon/items/weapon/melee/Sword.java     |   1 -
 .../pixeldungeon/items/weapon/melee/WarHammer.java |   1 -
 .../items/weapon/missiles/Boomerang.java           |  21 +-
 .../items/weapon/missiles/CurareDart.java          |   1 -
 .../pixeldungeon/items/weapon/missiles/Dart.java   |   1 -
 .../items/weapon/missiles/IncendiaryDart.java      |   1 -
 .../items/weapon/missiles/Javelin.java             |   1 -
 .../items/weapon/missiles/MissileWeapon.java       |   5 +-
 .../items/weapon/missiles/Shuriken.java            |   1 -
 .../items/weapon/missiles/Tamahawk.java            |   1 -
 .../pixeldungeon/levels/CavesBossLevel.java        |   3 +-
 .../watabou/pixeldungeon/levels/CavesLevel.java    |   1 -
 .../watabou/pixeldungeon/levels/CityBossLevel.java |   3 +-
 .../com/watabou/pixeldungeon/levels/CityLevel.java |   1 -
 .../watabou/pixeldungeon/levels/DeadEndLevel.java  |   1 -
 .../pixeldungeon/levels/HallsBossLevel.java        |   3 -
 .../watabou/pixeldungeon/levels/HallsLevel.java    |   3 -
 .../com/watabou/pixeldungeon/levels/LastLevel.java |   3 -
 .../watabou/pixeldungeon/levels/LastShopLevel.java |   1 -
 .../src/com/watabou/pixeldungeon/levels/Level.java |  21 +-
 .../src/com/watabou/pixeldungeon/levels/Patch.java |   1 -
 .../pixeldungeon/levels/PrisonBossLevel.java       |   7 +-
 .../watabou/pixeldungeon/levels/PrisonLevel.java   |   1 -
 .../watabou/pixeldungeon/levels/RegularLevel.java  |  19 +-
 core/src/com/watabou/pixeldungeon/levels/Room.java |   1 -
 .../pixeldungeon/levels/SewerBossLevel.java        |   3 +-
 .../watabou/pixeldungeon/levels/SewerLevel.java    |   1 -
 .../com/watabou/pixeldungeon/levels/Terrain.java   |   3 +-
 .../pixeldungeon/levels/features/AlchemyPot.java   |   1 -
 .../pixeldungeon/levels/features/Chasm.java        |   1 -
 .../watabou/pixeldungeon/levels/features/Door.java |   1 -
 .../pixeldungeon/levels/features/HighGrass.java    |  34 +-
 .../levels/painters/ArmoryPainter.java             |   4 +-
 .../levels/painters/BlacksmithPainter.java         |   1 -
 .../levels/painters/BossExitPainter.java           |   1 -
 .../pixeldungeon/levels/painters/CryptPainter.java |   4 +-
 .../levels/painters/EntrancePainter.java           |   1 -
 .../pixeldungeon/levels/painters/ExitPainter.java  |   1 -
 .../levels/painters/GardenPainter.java             |   1 -
 .../levels/painters/LaboratoryPainter.java         |   4 +-
 .../levels/painters/LibraryPainter.java            |   4 +-
 .../levels/painters/MagicWellPainter.java          |   1 -
 .../pixeldungeon/levels/painters/Painter.java      |   1 -
 .../levels/painters/PassagePainter.java            |   5 +-
 .../pixeldungeon/levels/painters/PitPainter.java   |   5 +-
 .../pixeldungeon/levels/painters/PoolPainter.java  |   1 -
 .../levels/painters/RatKingPainter.java            |   1 -
 .../pixeldungeon/levels/painters/ShopPainter.java  |   5 +-
 .../levels/painters/StandardPainter.java           |   1 -
 .../levels/painters/StatuePainter.java             |   4 +-
 .../levels/painters/StoragePainter.java            |   3 +-
 .../pixeldungeon/levels/painters/TrapsPainter.java |   1 -
 .../levels/painters/TreasuryPainter.java           |   4 +-
 .../levels/painters/TunnelPainter.java             |   1 -
 .../pixeldungeon/levels/painters/VaultPainter.java |   8 +-
 .../levels/painters/WeakFloorPainter.java          |   1 -
 .../pixeldungeon/levels/traps/AlarmTrap.java       |   1 -
 .../pixeldungeon/levels/traps/FireTrap.java        |   1 -
 .../pixeldungeon/levels/traps/GrippingTrap.java    |   1 -
 .../pixeldungeon/levels/traps/LightningTrap.java   |   1 -
 .../pixeldungeon/levels/traps/ParalyticTrap.java   |   1 -
 .../pixeldungeon/levels/traps/PoisonTrap.java      |   3 +-
 .../pixeldungeon/levels/traps/SummoningTrap.java   |   3 +-
 .../pixeldungeon/levels/traps/ToxicTrap.java       |   1 -
 .../watabou/pixeldungeon/mechanics/Ballistica.java |   3 +-
 .../pixeldungeon/mechanics/ShadowCaster.java       |   1 -
 .../com/watabou/pixeldungeon/plants/Dreamweed.java |  67 ++++
 .../com/watabou/pixeldungeon/plants/Earthroot.java |   1 -
 .../com/watabou/pixeldungeon/plants/Fadeleaf.java  |   1 -
 .../com/watabou/pixeldungeon/plants/Firebloom.java |   1 -
 .../com/watabou/pixeldungeon/plants/Icecap.java    |   6 +-
 .../src/com/watabou/pixeldungeon/plants/Plant.java |   1 -
 .../watabou/pixeldungeon/plants/Sorrowmoss.java    |   3 +-
 .../com/watabou/pixeldungeon/plants/Sungrass.java  |   1 -
 .../watabou/pixeldungeon/scenes/AboutScene.java    |   7 +-
 .../watabou/pixeldungeon/scenes/AmuletScene.java   |   3 +-
 .../watabou/pixeldungeon/scenes/BadgesScene.java   |  14 +-
 .../watabou/pixeldungeon/scenes/CellSelector.java  |   3 +-
 .../com/watabou/pixeldungeon/scenes/GameScene.java |   1 -
 .../pixeldungeon/scenes/InterlevelScene.java       |   4 +-
 .../watabou/pixeldungeon/scenes/IntroScene.java    |   1 -
 .../watabou/pixeldungeon/scenes/PixelScene.java    |   8 +-
 .../watabou/pixeldungeon/scenes/RankingsScene.java |   7 +-
 .../watabou/pixeldungeon/scenes/StartScene.java    | 104 ++----
 .../watabou/pixeldungeon/scenes/SurfaceScene.java  |  34 +-
 .../watabou/pixeldungeon/scenes/TitleScene.java    |  15 +-
 .../watabou/pixeldungeon/sprites/AcidicSprite.java |   1 -
 .../watabou/pixeldungeon/sprites/AlbinoSprite.java |   1 -
 .../watabou/pixeldungeon/sprites/BanditSprite.java |   1 -
 .../watabou/pixeldungeon/sprites/BatSprite.java    |   1 -
 .../pixeldungeon/sprites/BlacksmithSprite.java     |   1 -
 .../watabou/pixeldungeon/sprites/BruteSprite.java  |   1 -
 .../pixeldungeon/sprites/BurningFistSprite.java    |   1 -
 .../watabou/pixeldungeon/sprites/CharSprite.java   |  12 +-
 .../watabou/pixeldungeon/sprites/CrabSprite.java   |   1 -
 .../watabou/pixeldungeon/sprites/DM300Sprite.java  |   1 -
 .../pixeldungeon/sprites/DiscardedItemSprite.java  |   1 -
 .../pixeldungeon/sprites/ElementalSprite.java      |   1 -
 .../watabou/pixeldungeon/sprites/EyeSprite.java    |   1 -
 .../pixeldungeon/sprites/FetidRatSprite.java       |   1 -
 .../watabou/pixeldungeon/sprites/GhostSprite.java  |   1 -
 .../watabou/pixeldungeon/sprites/GnollSprite.java  |   1 -
 .../watabou/pixeldungeon/sprites/GolemSprite.java  |   1 -
 .../watabou/pixeldungeon/sprites/GooSprite.java    |   1 -
 .../watabou/pixeldungeon/sprites/HeroSprite.java   |  56 +++-
 .../watabou/pixeldungeon/sprites/ImpSprite.java    |   1 -
 .../watabou/pixeldungeon/sprites/ItemSprite.java   |   4 +-
 .../pixeldungeon/sprites/ItemSpriteSheet.java      |   4 +-
 .../watabou/pixeldungeon/sprites/KingSprite.java   |   1 -
 .../watabou/pixeldungeon/sprites/LarvaSprite.java  |   1 -
 .../watabou/pixeldungeon/sprites/MirrorSprite.java |   1 -
 .../pixeldungeon/sprites/MissileSprite.java        |   5 +-
 .../watabou/pixeldungeon/sprites/MobSprite.java    |   4 +-
 .../watabou/pixeldungeon/sprites/MonkSprite.java   |   1 -
 .../pixeldungeon/sprites/PiranhaSprite.java        |   1 -
 .../watabou/pixeldungeon/sprites/PlantSprite.java  |   8 +-
 .../pixeldungeon/sprites/RatKingSprite.java        |   1 -
 .../watabou/pixeldungeon/sprites/RatSprite.java    |   1 -
 .../pixeldungeon/sprites/RottingFistSprite.java    |   1 -
 .../pixeldungeon/sprites/ScorpioSprite.java        |   1 -
 .../watabou/pixeldungeon/sprites/SeniorSprite.java |   1 -
 .../watabou/pixeldungeon/sprites/ShamanSprite.java |   1 -
 .../watabou/pixeldungeon/sprites/SheepSprite.java  |   1 -
 .../pixeldungeon/sprites/ShieldedSprite.java       |   1 -
 .../pixeldungeon/sprites/ShopkeeperSprite.java     |   1 -
 .../pixeldungeon/sprites/SkeletonSprite.java       |   1 -
 .../pixeldungeon/sprites/SpinnerSprite.java        |   1 -
 .../watabou/pixeldungeon/sprites/StatueSprite.java |   1 -
 .../pixeldungeon/sprites/SuccubusSprite.java       |   1 -
 .../watabou/pixeldungeon/sprites/SwarmSprite.java  |   1 -
 .../watabou/pixeldungeon/sprites/TenguSprite.java  |   7 +-
 .../watabou/pixeldungeon/sprites/ThiefSprite.java  |   1 -
 .../watabou/pixeldungeon/sprites/UndeadSprite.java |   1 -
 .../pixeldungeon/sprites/WandmakerSprite.java      |   1 -
 .../pixeldungeon/sprites/WarlockSprite.java        |   1 -
 .../watabou/pixeldungeon/sprites/WraithSprite.java |   1 -
 .../watabou/pixeldungeon/sprites/YogSprite.java    |   1 -
 core/src/com/watabou/pixeldungeon/ui/Archs.java    |   9 +-
 .../watabou/pixeldungeon/ui/AttackIndicator.java   |   1 -
 .../com/watabou/pixeldungeon/ui/BadgesList.java    |   1 -
 core/src/com/watabou/pixeldungeon/ui/Banner.java   |   1 -
 .../com/watabou/pixeldungeon/ui/BuffIndicator.java |   2 +-
 .../com/watabou/pixeldungeon/ui/BusyIndicator.java |   1 -
 core/src/com/watabou/pixeldungeon/ui/CheckBox.java |   1 -
 core/src/com/watabou/pixeldungeon/ui/Compass.java  |   1 -
 .../watabou/pixeldungeon/ui/DangerIndicator.java   |   5 +-
 .../com/watabou/pixeldungeon/ui/ExitButton.java    |  73 +++++
 core/src/com/watabou/pixeldungeon/ui/GameLog.java  |   3 +-
 .../com/watabou/pixeldungeon/ui/GoldIndicator.java |   1 -
 .../watabou/pixeldungeon/ui/HealthIndicator.java   |   1 -
 core/src/com/watabou/pixeldungeon/ui/Icons.java    |  23 +-
 core/src/com/watabou/pixeldungeon/ui/ItemSlot.java |   4 +-
 .../com/watabou/pixeldungeon/ui/LootIndicator.java |   1 -
 .../com/watabou/pixeldungeon/ui/PrefsButton.java   |   1 -
 .../src/com/watabou/pixeldungeon/ui/QuickSlot.java |   1 -
 .../src/com/watabou/pixeldungeon/ui/RedButton.java |   1 -
 .../com/watabou/pixeldungeon/ui/ScrollPane.java    |   1 -
 .../com/watabou/pixeldungeon/ui/SimpleButton.java  |   1 -
 .../com/watabou/pixeldungeon/ui/StatusPane.java    |  62 +++-
 core/src/com/watabou/pixeldungeon/ui/Tag.java      |   1 -
 core/src/com/watabou/pixeldungeon/ui/Toast.java    |   1 -
 core/src/com/watabou/pixeldungeon/ui/Toolbar.java  |   1 -
 core/src/com/watabou/pixeldungeon/ui/Window.java   |   1 -
 .../src/com/watabou/pixeldungeon/utils/BArray.java |   1 -
 core/src/com/watabou/pixeldungeon/utils/GLog.java  |   1 -
 core/src/com/watabou/pixeldungeon/utils/Utils.java |   1 -
 .../watabou/pixeldungeon/windows/IconTitle.java    |  10 +-
 .../com/watabou/pixeldungeon/windows/WndBadge.java |   1 -
 .../com/watabou/pixeldungeon/windows/WndBag.java   |   1 -
 .../pixeldungeon/windows/WndBlacksmith.java        |   1 -
 .../watabou/pixeldungeon/windows/WndCatalogus.java |   1 -
 .../pixeldungeon/windows/WndChallenges.java        |  88 ++++++
 .../watabou/pixeldungeon/windows/WndChooseWay.java |   1 -
 .../com/watabou/pixeldungeon/windows/WndClass.java | 198 ++++++++++++
 .../com/watabou/pixeldungeon/windows/WndError.java |   1 -
 .../com/watabou/pixeldungeon/windows/WndGame.java  |  18 +-
 .../com/watabou/pixeldungeon/windows/WndHero.java  |   1 -
 .../com/watabou/pixeldungeon/windows/WndImp.java   |   1 -
 .../watabou/pixeldungeon/windows/WndInfoCell.java  |   1 -
 .../watabou/pixeldungeon/windows/WndInfoItem.java  |   1 -
 .../watabou/pixeldungeon/windows/WndInfoMob.java   |  27 +-
 .../watabou/pixeldungeon/windows/WndInfoPlant.java |   1 -
 .../com/watabou/pixeldungeon/windows/WndItem.java  |   1 -
 .../watabou/pixeldungeon/windows/WndJournal.java   |   1 -
 .../watabou/pixeldungeon/windows/WndMessage.java   |   1 -
 .../watabou/pixeldungeon/windows/WndOptions.java   |   1 -
 .../com/watabou/pixeldungeon/windows/WndQuest.java |   5 +-
 .../watabou/pixeldungeon/windows/WndRanking.java   |  23 +-
 .../watabou/pixeldungeon/windows/WndResurrect.java |   1 -
 .../watabou/pixeldungeon/windows/WndSadGhost.java  |   1 -
 .../watabou/pixeldungeon/windows/WndSettings.java  |  21 +-
 .../com/watabou/pixeldungeon/windows/WndStory.java |   1 -
 .../watabou/pixeldungeon/windows/WndTabbed.java    |   1 -
 .../pixeldungeon/windows/WndTitledMessage.java     |   1 -
 .../watabou/pixeldungeon/windows/WndTradeItem.java |   1 -
 .../watabou/pixeldungeon/windows/WndWandmaker.java |   1 -
 478 files changed, 1985 insertions(+), 1253 deletions(-)
 create mode 100644 core/src/com/watabou/pixeldungeon/Challenges.java
 create mode 100644 core/src/com/watabou/pixeldungeon/actors/blobs/ConfusionGas.java
 create mode 100644 core/src/com/watabou/pixeldungeon/actors/buffs/Vertigo.java
 create mode 100644 core/src/com/watabou/pixeldungeon/actors/mobs/npcs/NPC.java
 create mode 100644 core/src/com/watabou/pixeldungeon/items/Weightstone.java
 create mode 100644 core/src/com/watabou/pixeldungeon/plants/Dreamweed.java
 create mode 100644 core/src/com/watabou/pixeldungeon/ui/ExitButton.java
 create mode 100644 core/src/com/watabou/pixeldungeon/windows/WndChallenges.java
 create mode 100644 core/src/com/watabou/pixeldungeon/windows/WndClass.java

diff --git a/core/src/com/watabou/pixeldungeon/Assets.java b/core/src/com/watabou/pixeldungeon/Assets.java
index a940c77..20c9ceb 100644
--- a/core/src/com/watabou/pixeldungeon/Assets.java
+++ b/core/src/com/watabou/pixeldungeon/Assets.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -39,6 +38,7 @@ public class Assets {
 	public static final String ROGUE	= "rogue.png";
 	public static final String HUNTRESS	= "ranger.png";
 	public static final String AVATARS	= "avatars.png";
+	public static final String PET		= "pet.png";
 	
 	public static final String SURFACE	= "surface.png";
 	
diff --git a/core/src/com/watabou/pixeldungeon/Badges.java b/core/src/com/watabou/pixeldungeon/Badges.java
index ff2f759..142bc89 100644
--- a/core/src/com/watabou/pixeldungeon/Badges.java
+++ b/core/src/com/watabou/pixeldungeon/Badges.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -96,8 +95,7 @@ public class Badges {
 		BOSS_SLAIN_3_SNIPER,
 		BOSS_SLAIN_3_WARDEN,
 		BOSS_SLAIN_3_ALL_SUBCLASSES( 
-			"3rd boss slain by Gladiator, Berserker, Warlock, Battlemage, " +
-			"Freerunner, Assassin, Sniper & Warden", 33, true ),
+			"3rd boss slain by Gladiator, Berserker, Warlock, Battlemage, Freerunner, Assassin, Sniper & Warden", 33, true ),
 		RING_OF_HAGGLER( "Ring of Haggler obtained", 20 ),
 		RING_OF_THORNS( "Ring of Thorns obtained", 21 ),
 		STRENGTH_ATTAINED_1( "13 points of Strength attained", 40 ),
@@ -142,6 +140,7 @@ public class Badges {
 		GAMES_PLAYED_3( "500 games played", 62, true ),
 		GAMES_PLAYED_4( "2000 games played", 63, true ),
 		HAPPY_END( "Happy end", 38 ),
+		CHAMPION( "Challenge won", 39, true ),
 		SUPPORTER( "Thanks for your support!", 31, true );
 		
 		public boolean meta;
@@ -845,6 +844,10 @@ public class Badges {
 		displayBadge( Badge.HAPPY_END );
 	}
 	
+	public static void validateChampion() {
+		displayBadge( Badge.CHAMPION );
+	}
+	
 	private static void displayBadge( Badge badge ) {
 		
 		if (badge == null) {
diff --git a/core/src/com/watabou/pixeldungeon/Bones.java b/core/src/com/watabou/pixeldungeon/Bones.java
index e741b52..d8e6741 100644
--- a/core/src/com/watabou/pixeldungeon/Bones.java
+++ b/core/src/com/watabou/pixeldungeon/Bones.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Challenges.java b/core/src/com/watabou/pixeldungeon/Challenges.java
new file mode 100644
index 0000000..e65ccba
--- /dev/null
+++ b/core/src/com/watabou/pixeldungeon/Challenges.java
@@ -0,0 +1,41 @@
+/*
+ * Copyright (C) 2012-2014  Oleg Dolya
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>
+ */
+package com.watabou.pixeldungeon;
+
+public class Challenges {
+
+	public static final int NO_FOOD				= 1;
+	public static final int NO_ARMOR			= 2;
+	public static final int NO_HEALING			= 4;
+	public static final int NO_HERBALISM		= 8;
+	public static final int SWARM_INTELLIGENCE	= 16;
+	public static final int DARKNESS			= 32;
+	
+	public static final String[] NAMES = {
+		"No food",
+		"No armors",
+		"No healing potions",
+		"No dew, no seeds",
+		"Swarm intelligence",
+		"Darkness"
+	};
+	
+	public static final int[] MASKS = {
+		NO_FOOD, NO_ARMOR, NO_HEALING, NO_HERBALISM, SWARM_INTELLIGENCE, DARKNESS
+	};
+	
+}
diff --git a/core/src/com/watabou/pixeldungeon/Chrome.java b/core/src/com/watabou/pixeldungeon/Chrome.java
index ef6d5d9..3420574 100644
--- a/core/src/com/watabou/pixeldungeon/Chrome.java
+++ b/core/src/com/watabou/pixeldungeon/Chrome.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -31,8 +30,7 @@ public class Chrome {
 		SCROLL,
 		TAB_SET,
 		TAB_SELECTED,
-		TAB_UNSELECTED,
-		SURFACE
+		TAB_UNSELECTED
 	};
 	
 	public static NinePatch get( Type type ) {
@@ -57,8 +55,6 @@ public class Chrome {
 			return new NinePatch( Assets.CHROME, 64, 22, 10, 14, 4, 7, 4, 6 );
 		case TAB_UNSELECTED:
 			return new NinePatch( Assets.CHROME, 74, 22, 10, 14, 4, 7, 4, 6 );
-		case SURFACE:
-			return new NinePatch( Assets.CHROME, 86, 0, 22, 22, 5 );
 		default:
 			return null;
 		}
diff --git a/core/src/com/watabou/pixeldungeon/Dungeon.java b/core/src/com/watabou/pixeldungeon/Dungeon.java
index e94c1fe..c0f2016 100644
--- a/core/src/com/watabou/pixeldungeon/Dungeon.java
+++ b/core/src/com/watabou/pixeldungeon/Dungeon.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -135,6 +134,8 @@ public class Dungeon {
 	
 	public static void init() {
 
+		challenges = PixelDungeon.challenges();
+		
 		Actor.clear();
 		
 		PathFinder.setMapSize( Level.WIDTH, Level.HEIGHT );
@@ -173,6 +174,10 @@ public class Dungeon {
 		StartScene.curClass.initHero( hero );
 	}
 	
+	public static boolean isChallenged( int mask ) {
+		return (challenges & mask) != 0;
+	}
+	
 	public static Level newLevel() {
 		
 		Dungeon.level = null;
@@ -356,6 +361,7 @@ public class Dungeon {
 	private static final String RN_DEPTH_FILE	= "ranger%d.dat";
 	
 	private static final String VERSION		= "version";
+	private static final String CHALLENGES	= "challenges";
 	private static final String HERO		= "hero";
 	private static final String GOLD		= "gold";
 	private static final String DEPTH		= "depth";
@@ -401,6 +407,7 @@ public class Dungeon {
 			Bundle bundle = new Bundle();
 			
 			bundle.put( VERSION, Game.version );
+			bundle.put( CHALLENGES, challenges );
 			bundle.put( HERO, hero );
 			bundle.put( GOLD, gold );
 			bundle.put( DEPTH, depth );
@@ -470,11 +477,7 @@ public class Dungeon {
 			saveGame( gameFile( hero.heroClass ) );
 			saveLevel();
 			
-			GamesInProgress.set( 
-				hero.heroClass,
-				depth, 
-				hero.lvl, 
-				hero.belongings.armor != null ? hero.belongings.armor.tier : 0 );
+			GamesInProgress.set( hero.heroClass, depth, hero.lvl );
 			
 		} else if (WndResurrect.instance != null) {
 			
@@ -496,6 +499,8 @@ public class Dungeon {
 		
 		Bundle bundle = gameBundle( fileName );
 		
+		Dungeon.challenges = bundle.getInt( CHALLENGES );
+		
 		Dungeon.level = null;
 		Dungeon.depth = -1;
 		
@@ -607,7 +612,7 @@ public class Dungeon {
 	public static void preview( GamesInProgress.Info info, Bundle bundle ) {
 		info.depth = bundle.getInt( DEPTH );
 		if (info.depth == -1) {
-			info.depth = bundle.getInt( "maxDepth" );	// <-- It has to be refactored!
+			info.depth = bundle.getInt( "maxDepth" );	// FIXME
 		}
 		Hero.preview( info, bundle.getBundle( HERO ) );
 	}
@@ -620,6 +625,11 @@ public class Dungeon {
 	}
 	
 	public static void win( String desc ) {
+		
+		if (challenges != 0) {
+			Badges.validateChampion();
+		}
+		
 		resultDescription = desc;
 		Rankings.INSTANCE.submit( true );
 	}
diff --git a/core/src/com/watabou/pixeldungeon/DungeonTilemap.java b/core/src/com/watabou/pixeldungeon/DungeonTilemap.java
index 8baef44..b0c7d4b 100644
--- a/core/src/com/watabou/pixeldungeon/DungeonTilemap.java
+++ b/core/src/com/watabou/pixeldungeon/DungeonTilemap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -57,7 +56,7 @@ public class DungeonTilemap extends Tilemap {
 		
 		final Image tile = tile( oldValue );
 		tile.point( tileToWorld( pos ) );
-
+		
 		// For bright mode
 		tile.rm = tile.gm = tile.bm = rm;
 		tile.ra = tile.ga = tile.ba = ra;
diff --git a/core/src/com/watabou/pixeldungeon/FogOfWar.java b/core/src/com/watabou/pixeldungeon/FogOfWar.java
index 9e86ee2..aea4464 100644
--- a/core/src/com/watabou/pixeldungeon/FogOfWar.java
+++ b/core/src/com/watabou/pixeldungeon/FogOfWar.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/GamesInProgress.java b/core/src/com/watabou/pixeldungeon/GamesInProgress.java
index ad5659e..fe7d62a 100644
--- a/core/src/com/watabou/pixeldungeon/GamesInProgress.java
+++ b/core/src/com/watabou/pixeldungeon/GamesInProgress.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -51,11 +50,10 @@ public class GamesInProgress {
 		}
 	}
 	
-	public static void set( HeroClass cl, int depth, int level, int armor ) {
+	public static void set( HeroClass cl, int depth, int level ) {
 		Info info = new Info();
 		info.depth = depth;
 		info.level = level;
-		info.armor = armor;
 		state.put( cl, info );
 	}
 	
@@ -70,6 +68,5 @@ public class GamesInProgress {
 	public static class Info {
 		public int depth;
 		public int level;
-		public int armor;
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/Journal.java b/core/src/com/watabou/pixeldungeon/Journal.java
index 3edf2b4..8a3bea8 100644
--- a/core/src/com/watabou/pixeldungeon/Journal.java
+++ b/core/src/com/watabou/pixeldungeon/Journal.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/PixelDungeon.java b/core/src/com/watabou/pixeldungeon/PixelDungeon.java
index dbb44c6..94d07b1 100644
--- a/core/src/com/watabou/pixeldungeon/PixelDungeon.java
+++ b/core/src/com/watabou/pixeldungeon/PixelDungeon.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -61,9 +60,6 @@ public class PixelDungeon extends Game<GameAction> {
 		com.watabou.utils.Bundle.addAlias( 
 			com.watabou.pixeldungeon.actors.hero.Hero.class, 
 			"com.watabou.pixeldungeon.actors.Hero" );
-	//	com.watabou.utils.Bundle.addAlias( 
-	//		com.watabou.pixeldungeon.items.weapon.missiles.Javelin.class, 
-	//		"com.watabou.pixeldungeon.items.weapon.missiles.Boomerang" );
 		com.watabou.utils.Bundle.addAlias( 
 			com.watabou.pixeldungeon.actors.mobs.npcs.Shopkeeper.class,
 			"com.watabou.pixeldungeon.actors.mobs.Shopkeeper" );
@@ -222,6 +218,21 @@ public class PixelDungeon extends Game<GameAction> {
 		return Preferences.INSTANCE.getBoolean( Preferences.KEY_INTRO, true );
 	}
 	
+	@Override
+	public void onWindowFocusChanged( boolean hasFocus ) {
+		
+		super.onWindowFocusChanged( hasFocus );
+		
+		if (hasFocus) {
+			updateImmersiveMode();
+		}
+	}
+	
+	public static void switchNoFade( Class<? extends PixelScene> c ) {
+		PixelScene.noFade = true;
+		switchScene( c );
+	}
+	
 	/*
 	 * <--- Preferences
 	 */
diff --git a/core/src/com/watabou/pixeldungeon/Preferences.java b/core/src/com/watabou/pixeldungeon/Preferences.java
index 092d7c1..e88fcd9 100644
--- a/core/src/com/watabou/pixeldungeon/Preferences.java
+++ b/core/src/com/watabou/pixeldungeon/Preferences.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -24,11 +23,13 @@ public enum Preferences {
 	INSTANCE;
 
 	public static final String KEY_LANDSCAPE	= "landscape";
+	public static final String KEY_IMMERSIVE	= "immersive";
 	public static final String KEY_SCALE_UP		= "scaleup";
 	public static final String KEY_MUSIC		= "music";
 	public static final String KEY_SOUND_FX		= "soundfx";
 	public static final String KEY_ZOOM			= "zoom";
 	public static final String KEY_LAST_CLASS	= "last_class";
+	public static final String KEY_CHALLENGES	= "challenges";
 	public static final String KEY_DONATED		= "donated";
 	public static final String KEY_INTRO		= "intro";
 	public static final String KEY_BRIGHTNESS	= "brightness";
diff --git a/core/src/com/watabou/pixeldungeon/Rankings.java b/core/src/com/watabou/pixeldungeon/Rankings.java
index 9e8fc98..0db1c46 100644
--- a/core/src/com/watabou/pixeldungeon/Rankings.java
+++ b/core/src/com/watabou/pixeldungeon/Rankings.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ResultDescriptions.java b/core/src/com/watabou/pixeldungeon/ResultDescriptions.java
index 27248a0..e218e9d 100644
--- a/core/src/com/watabou/pixeldungeon/ResultDescriptions.java
+++ b/core/src/com/watabou/pixeldungeon/ResultDescriptions.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Statistics.java b/core/src/com/watabou/pixeldungeon/Statistics.java
index 2b74531..2409be5 100644
--- a/core/src/com/watabou/pixeldungeon/Statistics.java
+++ b/core/src/com/watabou/pixeldungeon/Statistics.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/Actor.java b/core/src/com/watabou/pixeldungeon/actors/Actor.java
index ee6cd9c..8d3af6a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/Actor.java
+++ b/core/src/com/watabou/pixeldungeon/actors/Actor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -130,8 +129,10 @@ public abstract class Actor implements Bundlable {
 		chars[pos] = null;
 	}
 	
-	protected static void next() {
-		current = null;
+	/*protected*/public void next() {
+		if (current == this) {
+			current = null;
+		}
 	}
 	
 	public static void process() {
@@ -160,7 +161,15 @@ public abstract class Actor implements Bundlable {
 				}
 			}
 
-			if  (current != null) {
+			if (current != null) {
+				
+				if (current instanceof Char && ((Char)current).sprite.isMoving) {
+					// If it's character's turn to act, but its sprite 
+					// is moving, wait till the movement is over
+					current = null;
+					break;
+				}
+				
 				doNext = current.act();
 				if (doNext && !Dungeon.hero.isAlive()) {
 					doNext = false;
diff --git a/core/src/com/watabou/pixeldungeon/actors/Char.java b/core/src/com/watabou/pixeldungeon/actors/Char.java
index 1b517d9..f7b1b40 100644
--- a/core/src/com/watabou/pixeldungeon/actors/Char.java
+++ b/core/src/com/watabou/pixeldungeon/actors/Char.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,6 +16,7 @@
  */
 package com.watabou.pixeldungeon.actors;
 
+import java.util.ArrayList;
 import java.util.HashSet;
 
 import com.badlogic.gdx.utils.reflect.ClassReflection;
@@ -28,6 +28,7 @@ import com.watabou.pixeldungeon.actors.buffs.Amok;
 import com.watabou.pixeldungeon.actors.buffs.Bleeding;
 import com.watabou.pixeldungeon.actors.buffs.Buff;
 import com.watabou.pixeldungeon.actors.buffs.Burning;
+import com.watabou.pixeldungeon.actors.buffs.Vertigo;
 import com.watabou.pixeldungeon.actors.buffs.Cripple;
 import com.watabou.pixeldungeon.actors.buffs.Frost;
 import com.watabou.pixeldungeon.actors.buffs.Invisibility;
@@ -137,9 +138,9 @@ public abstract class Char extends Actor {
 				GLog.i( TXT_HIT, name, enemy.name );
 			}
 			
-			// Refactoring needed!
-			int dr = this instanceof Hero && ((Hero)this).usingRanged && ((Hero)this).subClass == HeroSubClass.SNIPER ? 
-				0 : Random.IntRange( 0, enemy.dr() );
+			// FIXME
+			int dr = this instanceof Hero && ((Hero)this).rangedWeapon != null && ((Hero)this).subClass == HeroSubClass.SNIPER ? 0 :
+				Random.IntRange( 0, enemy.dr() );
 			
 			int dmg = damageRoll();
 			int effectiveDamage = Math.max( dmg - dr, 0 );;
@@ -378,6 +379,10 @@ public abstract class Char extends Actor {
 
 				sprite.showStatus( CharSprite.NEGATIVE, "bleeding" );
 				
+			} else if (buff instanceof Vertigo) {
+
+				sprite.showStatus( CharSprite.NEGATIVE, "dizzy" );
+				
 			} else if (buff instanceof Sleep) {
 				sprite.idle();
 			}
@@ -451,6 +456,19 @@ public abstract class Char extends Actor {
 	}
 	
 	public void move( int step ) {
+		
+		if (buff( Vertigo.class ) != null) {
+			ArrayList<Integer> candidates = new ArrayList<Integer>();
+			for (int dir : Level.NEIGHBOURS8) {
+				int p = pos + dir;
+				if ((Level.passable[p] || Level.avoid[p]) && Actor.findChar( p ) == null) {
+					candidates.add( p );
+				}
+			}
+			
+			step = Random.element( candidates );
+		}
+		
 		if (Dungeon.level.map[pos] == Terrain.OPEN_DOOR) {
 			Door.leave( pos );
 		}
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Alchemy.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Alchemy.java
index fc02374..cc8cf6b 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Alchemy.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Alchemy.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Blob.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Blob.java
index 8bbda7e..960a640 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Blob.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Blob.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/ConfusionGas.java b/core/src/com/watabou/pixeldungeon/actors/blobs/ConfusionGas.java
new file mode 100644
index 0000000..2d28c6a
--- /dev/null
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/ConfusionGas.java
@@ -0,0 +1,51 @@
+/*
+ * Copyright (C) 2012-2014  Oleg Dolya
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>
+ */
+package com.watabou.pixeldungeon.actors.blobs;
+
+import com.watabou.pixeldungeon.actors.Actor;
+import com.watabou.pixeldungeon.actors.Char;
+import com.watabou.pixeldungeon.actors.buffs.Buff;
+import com.watabou.pixeldungeon.actors.buffs.Vertigo;
+import com.watabou.pixeldungeon.effects.BlobEmitter;
+import com.watabou.pixeldungeon.effects.Speck;
+
+public class ConfusionGas extends Blob {
+	
+	@Override
+	protected void evolve() {
+		super.evolve();
+		
+		Char ch;
+		for (int i=0; i < LENGTH; i++) {
+			if (cur[i] > 0 && (ch = Actor.findChar( i )) != null) {
+				Buff.prolong( ch, Vertigo.class, Vertigo.duration( ch ) );
+			}
+		}
+	}
+	
+	@Override
+	public void use( BlobEmitter emitter ) {
+		super.use( emitter );
+		
+		emitter.pour( Speck.factory( Speck.CONFUSION, true ), 0.6f );
+	}
+	
+	@Override
+	public String tileDesc() {
+		return "A cloud of confusion gas is swirling here.";
+	}
+}
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Fire.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Fire.java
index 79fe55a..adfd079 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Fire.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Fire.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Foliage.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Foliage.java
index f6099c3..0fa643d 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Foliage.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Foliage.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Freezing.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Freezing.java
index 9ec2aec..2eb4f80 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Freezing.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Freezing.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/ParalyticGas.java b/core/src/com/watabou/pixeldungeon/actors/blobs/ParalyticGas.java
index cae7c22..c9a1d94 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/ParalyticGas.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/ParalyticGas.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Regrowth.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Regrowth.java
index 794c024..4985591 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Regrowth.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Regrowth.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/ToxicGas.java b/core/src/com/watabou/pixeldungeon/actors/blobs/ToxicGas.java
index 2db7044..a3df0e9 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/ToxicGas.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/ToxicGas.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -27,6 +26,7 @@ import com.watabou.pixeldungeon.effects.BlobEmitter;
 import com.watabou.pixeldungeon.effects.Speck;
 import com.watabou.pixeldungeon.utils.GLog;
 import com.watabou.pixeldungeon.utils.Utils;
+import com.watabou.utils.Random;
 
 public class ToxicGas extends Blob implements Hero.Doom {
 	
@@ -41,8 +41,8 @@ public class ToxicGas extends Blob implements Hero.Doom {
 			if (cur[i] > 0 && (ch = Actor.findChar( i )) != null) {
 				
 				int damage = (ch.HT + levelDamage) / 40;
-				if (damage < 1) {
-					damage = 1;
+				if (Random.Int( 40 ) < (ch.HT + levelDamage) % 40) {
+					damage++;
 				}
 				
 				ch.damage( damage, this );
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfAwareness.java b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfAwareness.java
index 4a589a3..bee36c7 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfAwareness.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfAwareness.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfHealth.java b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfHealth.java
index 0710151..450737e 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfHealth.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfHealth.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfTransmutation.java b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfTransmutation.java
index 07c82c3..6537ca6 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfTransmutation.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfTransmutation.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Web.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Web.java
index 00695bb..0d2eaaf 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Web.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Web.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/WellWater.java b/core/src/com/watabou/pixeldungeon/actors/blobs/WellWater.java
index d59956d..3d98f88 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/WellWater.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/WellWater.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Amok.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Amok.java
index 48a260a..14ce3d3 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Amok.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Amok.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Awareness.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Awareness.java
index 252e901..b60d12e 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Awareness.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Awareness.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Barkskin.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Barkskin.java
index e8e53ae..b049bee 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Barkskin.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Barkskin.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -37,7 +36,7 @@ public class Barkskin extends Buff {
 			detach();
 			
 		}
-		
+
 		return true;
 	}
 	
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Bleeding.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Bleeding.java
index 32f8d9f..febc3c7 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Bleeding.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Bleeding.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Blindness.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Blindness.java
index 4ef36a9..ef30f4c 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Blindness.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Blindness.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -21,7 +20,7 @@ import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.ui.BuffIndicator;
 
 public class Blindness extends FlavourBuff {
-	
+
 	@Override
 	public void detach() {
 		super.detach();
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Buff.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Buff.java
index d3ab358..85ccf50 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Buff.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Buff.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Burning.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Burning.java
index e88687b..4997af4 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Burning.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Burning.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Charm.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Charm.java
index d363acc..3d5f6ec 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Charm.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Charm.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Combo.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Combo.java
index 9956f47..b78f9a1 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Combo.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Combo.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Cripple.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Cripple.java
index c50c3b4..0939b49 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Cripple.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Cripple.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/FlavourBuff.java b/core/src/com/watabou/pixeldungeon/actors/buffs/FlavourBuff.java
index 01cb7ff..32c4eba 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/FlavourBuff.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/FlavourBuff.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,7 @@
  */
 package com.watabou.pixeldungeon.actors.buffs;
 
-// Special kind of buff, that doesn't perform any kind actions 
+//Special kind of buff, that doesn't perform any kind actions 
 public class FlavourBuff extends Buff {
 	
 	@Override
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Frost.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Frost.java
index 18546ce..ea76b32 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Frost.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Frost.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Fury.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Fury.java
index fb2777a..7f6d0ee 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Fury.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Fury.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/GasesImmunity.java b/core/src/com/watabou/pixeldungeon/actors/buffs/GasesImmunity.java
index fab1d89..d39fc2e 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/GasesImmunity.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/GasesImmunity.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Hunger.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Hunger.java
index 4e4ea63..c9c5892 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Hunger.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Hunger.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Invisibility.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Invisibility.java
index cf44544..6518b9d 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Invisibility.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Invisibility.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Levitation.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Levitation.java
index c3d64c8..3b064d0 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Levitation.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Levitation.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Light.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Light.java
index 7f2baa4..b17743a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Light.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Light.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/MindVision.java b/core/src/com/watabou/pixeldungeon/actors/buffs/MindVision.java
index 4032e60..7537949 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/MindVision.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/MindVision.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Ooze.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Ooze.java
index 564e46d..359be06 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Ooze.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Ooze.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Paralysis.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Paralysis.java
index 4623951..13c0607 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Paralysis.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Paralysis.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -50,7 +49,7 @@ public class Paralysis extends FlavourBuff {
 	public String toString() {
 		return "Paralysed";
 	}
-
+	
 	public static float duration( Char ch ) {
 		Resistance r = ch.buff( Resistance.class );
 		return r != null ? r.durationFactor() * DURATION : DURATION;
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Poison.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Poison.java
index fe223d5..2e03bec 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Poison.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Poison.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -30,8 +29,6 @@ import com.watabou.utils.Bundle;
 
 public class Poison extends Buff implements Hero.Doom {
 	
-	public static final int DOT	= 2;
-	
 	protected float left;
 	
 	private static final String LEFT	= "left";
@@ -67,7 +64,7 @@ public class Poison extends Buff implements Hero.Doom {
 	public boolean act() {
 		if (target.isAlive()) {
 			
-			target.damage( DOT, this );
+			target.damage( (int)(left / 3) + 1, this );
 			spend( TICK );
 			
 			if ((left -= TICK) <= 0) {
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Regeneration.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Regeneration.java
index 790dbdc..5fa02a3 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Regeneration.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Regeneration.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -20,6 +19,11 @@ package com.watabou.pixeldungeon.actors.buffs;
 import com.watabou.pixeldungeon.actors.hero.Hero;
 import com.watabou.pixeldungeon.items.rings.RingOfMending;
 
+/**
+ *          .
+ *     ,    
+ * ()  
+ */
 public class Regeneration extends Buff {
 	
 	private static final float REGENERATION_DELAY = 10;
@@ -44,7 +48,7 @@ public class Regeneration extends Buff {
 			diactivate();
 			
 		}
-		
+
 		return true;
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Roots.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Roots.java
index 932dfbb..a6a4d6a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Roots.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Roots.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Shadows.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Shadows.java
index ae6e4fc..584ebdf 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Shadows.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Shadows.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Sleep.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Sleep.java
index 7ffff90..3b0cea4 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Sleep.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Sleep.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Slow.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Slow.java
index 34f5523..9cacf80 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Slow.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Slow.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -34,7 +33,7 @@ public class Slow extends FlavourBuff {
 	public String toString() {
 		return "Slowed";
 	}
-
+	
 	public static float duration( Char ch ) {
 		Resistance r = ch.buff( Resistance.class );
 		return r != null ? r.durationFactor() * DURATION : DURATION;
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/SnipersMark.java b/core/src/com/watabou/pixeldungeon/actors/buffs/SnipersMark.java
index 01ca64f..d8a5b5e 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/SnipersMark.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/SnipersMark.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Speed.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Speed.java
index cccdc69..6635c81 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Speed.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Speed.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Terror.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Terror.java
index d905e2d..574b374 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Terror.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Terror.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Vertigo.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Vertigo.java
new file mode 100644
index 0000000..72eba20
--- /dev/null
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Vertigo.java
@@ -0,0 +1,41 @@
+/*
+ * Copyright (C) 2012-2014  Oleg Dolya
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>
+ */
+package com.watabou.pixeldungeon.actors.buffs;
+
+import com.watabou.pixeldungeon.actors.Char;
+import com.watabou.pixeldungeon.items.rings.RingOfElements.Resistance;
+import com.watabou.pixeldungeon.ui.BuffIndicator;
+
+public class Vertigo extends FlavourBuff {
+	
+	public static final float DURATION	= 10f;
+	
+	@Override
+	public int icon() {
+		return BuffIndicator.VERTIGO;
+	}
+	
+	@Override
+	public String toString() {
+		return "Vertigo";
+	}
+	
+	public static float duration( Char ch ) {
+		Resistance r = ch.buff( Resistance.class );
+		return r != null ? r.durationFactor() * DURATION : DURATION;
+	}
+}
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Weakness.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Weakness.java
index 52df8f8..647d10f 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Weakness.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Weakness.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java b/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java
index 88a594b..cff405e 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -120,12 +119,11 @@ public class Belongings implements Iterable<Item> {
 	
 	public void countIronKeys() {
 		
-		IronKey.curDepthQunatity = 0;
+		IronKey.curDethQuantity = 0;
 		
 		for (Item item : backpack) {
 			if (item instanceof IronKey && ((IronKey)item).depth == Dungeon.depth) {
-				IronKey.curDepthQunatity = item.quantity();
-				return;
+				IronKey.curDethQuantity++;
 			}
 		}
 	}
@@ -174,7 +172,7 @@ public class Belongings implements Iterable<Item> {
 					item.detachAll( backpack );
 				}
 			} else if (item.unique) {
-				
+
 			} else if (!item.isEquipped( owner )) {
 				item.detachAll( backpack );
 			}
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java b/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java
index a0e73e7..cb24cf7 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -28,6 +27,7 @@ import com.watabou.pixeldungeon.Badges;
 import com.watabou.pixeldungeon.Bones;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.GamesInProgress;
+import com.watabou.pixeldungeon.ResultDescriptions;
 import com.watabou.pixeldungeon.actors.Actor;
 import com.watabou.pixeldungeon.actors.Char;
 import com.watabou.pixeldungeon.actors.buffs.Barkskin;
@@ -49,8 +49,10 @@ import com.watabou.pixeldungeon.actors.buffs.Regeneration;
 import com.watabou.pixeldungeon.actors.buffs.Roots;
 import com.watabou.pixeldungeon.actors.buffs.Charm;
 import com.watabou.pixeldungeon.actors.buffs.SnipersMark;
+import com.watabou.pixeldungeon.actors.buffs.Vertigo;
 import com.watabou.pixeldungeon.actors.buffs.Weakness;
 import com.watabou.pixeldungeon.actors.mobs.Mob;
+import com.watabou.pixeldungeon.actors.mobs.npcs.NPC;
 import com.watabou.pixeldungeon.effects.CheckedCell;
 import com.watabou.pixeldungeon.effects.Flare;
 import com.watabou.pixeldungeon.effects.Speck;
@@ -79,8 +81,8 @@ import com.watabou.pixeldungeon.items.scrolls.ScrollOfMagicMapping;
 import com.watabou.pixeldungeon.items.scrolls.ScrollOfRecharging;
 import com.watabou.pixeldungeon.items.scrolls.ScrollOfUpgrade;
 import com.watabou.pixeldungeon.items.wands.Wand;
-import com.watabou.pixeldungeon.items.weapon.Weapon;
 import com.watabou.pixeldungeon.items.weapon.melee.MeleeWeapon;
+import com.watabou.pixeldungeon.items.weapon.missiles.MissileWeapon;
 import com.watabou.pixeldungeon.levels.Level;
 import com.watabou.pixeldungeon.levels.Terrain;
 import com.watabou.pixeldungeon.levels.features.AlchemyPot;
@@ -143,12 +145,13 @@ public class Hero extends Char {
 	
 	public boolean restoreHealth = false;
 	
-	public boolean usingRanged = false;
+	public MissileWeapon rangedWeapon = null;
 	public Belongings belongings;
 	
 	public int STR;
 	public boolean weakened = false;
 	
+	/**  , */
 	public float awareness;
 	
 	public int lvl = 1;
@@ -217,9 +220,6 @@ public class Hero extends Char {
 	}
 	
 	public static void preview( GamesInProgress.Info info, Bundle bundle ) {
-		// Refactoring needed!
-		Armor armor = (Armor)bundle.get( "armor" );
-		info.armor = armor == null ? 0 : armor.tier;
 		info.level = bundle.getInt( LEVEL );
 	}
 	
@@ -236,18 +236,11 @@ public class Hero extends Char {
 		return belongings.armor == null ? 0 : belongings.armor.tier;
 	}
 	
-	public boolean shoot( Char enemy, Weapon wep ) {
-		
-		// Ugly...
-		usingRanged = true;
-		
-		KindOfWeapon curWep = belongings.weapon;
-		belongings.weapon = wep;
+	public boolean shoot( Char enemy, MissileWeapon wep ) {
 		
+		rangedWeapon = wep;
 		boolean result = attack( enemy );
-		
-		belongings.weapon = curWep;
-		usingRanged = false;
+		rangedWeapon = null;
 		
 		return result;
 	}
@@ -260,12 +253,13 @@ public class Hero extends Char {
 			bonus += ((RingOfAccuracy.Accuracy)buff).level;
 		}
 		float accuracy = (bonus == 0) ? 1 : (float)Math.pow( 1.4, bonus );
-		if (usingRanged && Level.distance( pos, target.pos ) == 1) {
+		if (rangedWeapon != null && Level.distance( pos, target.pos ) == 1) {
 			accuracy *= 0.5f;
 		}
 		
-		if (belongings.weapon != null) {
-			return (int)(attackSkill * accuracy * belongings.weapon.acuracyFactor( this ));
+		KindOfWeapon wep = rangedWeapon != null ? rangedWeapon : belongings.weapon;
+		if (wep != null) {
+			return (int)(attackSkill * accuracy * wep.acuracyFactor( this ));
 		} else {
 			return (int)(attackSkill * accuracy);
 		}
@@ -314,9 +308,10 @@ public class Hero extends Char {
 	
 	@Override
 	public int damageRoll() {
+		KindOfWeapon wep = rangedWeapon != null ? rangedWeapon : belongings.weapon;
 		int dmg;
-		if (belongings.weapon != null) {	
-			dmg = belongings.weapon.damageRoll( this );
+		if (wep != null) {	
+			dmg = wep.damageRoll( this );
 		} else {
 			dmg = STR() > 10 ? Random.IntRange( 1, STR() - 9 ) : 1;
 		}
@@ -340,9 +335,10 @@ public class Hero extends Char {
 	}
 	
 	public float attackDelay() {
-		if (belongings.weapon != null) {
+		KindOfWeapon wep = rangedWeapon != null ? rangedWeapon : belongings.weapon;
+		if (wep != null) {
 			
-			return belongings.weapon.speedFactor( this );
+			return wep.speedFactor( this );
 						
 		} else {
 			return 1f;
@@ -392,6 +388,7 @@ public class Hero extends Char {
 			}
 
 			ready();
+			return false;
 			
 		} else {
 			
@@ -401,52 +398,52 @@ public class Hero extends Char {
 			
 			if (curAction instanceof HeroAction.Move) {
 				
-				actMove( (HeroAction.Move)curAction );
+				return actMove( (HeroAction.Move)curAction );
 				
 			} else 
 			if (curAction instanceof HeroAction.Interact) {
 				
-				actInteract( (HeroAction.Interact)curAction );
+				return actInteract( (HeroAction.Interact)curAction );
 				
 			} else 
 			if (curAction instanceof HeroAction.Buy) {
 				
-				actBuy( (HeroAction.Buy)curAction );
+				return actBuy( (HeroAction.Buy)curAction );
 				
 			}else 
 			if (curAction instanceof HeroAction.PickUp) {
 				
-				actPickUp( (HeroAction.PickUp)curAction );
+				return actPickUp( (HeroAction.PickUp)curAction );
 				
 			} else 
 			if (curAction instanceof HeroAction.OpenChest) {
 				
-				actOpenChest( (HeroAction.OpenChest)curAction );
+				return actOpenChest( (HeroAction.OpenChest)curAction );
 				
 			} else 
 			if (curAction instanceof HeroAction.Unlock) {
 				
-				actUnlock( (HeroAction.Unlock)curAction );
+				return actUnlock( (HeroAction.Unlock)curAction );
 				
 			} else 
 			if (curAction instanceof HeroAction.Descend) {
 				
-				actDescend( (HeroAction.Descend)curAction );
+				return actDescend( (HeroAction.Descend)curAction );
 				
 			} else
 			if (curAction instanceof HeroAction.Ascend) {
 				
-				actAscend( (HeroAction.Ascend)curAction );
+				return actAscend( (HeroAction.Ascend)curAction );
 				
 			} else
 			if (curAction instanceof HeroAction.Attack) {
 
-				actAttack( (HeroAction.Attack)curAction );
+				return actAttack( (HeroAction.Attack)curAction );
 				
 			} else
 			if (curAction instanceof HeroAction.Cook) {
 
-				actCook( (HeroAction.Cook)curAction );
+				return actCook( (HeroAction.Cook)curAction );
 				
 			}
 		}
@@ -479,40 +476,47 @@ public class Hero extends Char {
 		act();
 	}
 	
-	private void actMove( HeroAction.Move action ) {
+	private boolean actMove( HeroAction.Move action ) {
 
 		if (getCloser( action.dst )) {
 			
+			return true;
+			
 		} else {
 			if (Dungeon.level.map[pos] == Terrain.SIGN) {
 				GameScene.show( new WndMessage( Dungeon.tip() ) );
 			}
 			ready();
+			return false;
 		}
 	}
 	
-	private void actInteract( HeroAction.Interact action ) {
+	private boolean actInteract( HeroAction.Interact action ) {
 		
-		Mob.NPC npc = action.npc;
+		NPC npc = action.npc;
 
 		if (Level.adjacent( pos, npc.pos )) {
 			
 			ready();
 			sprite.turnTo( pos, npc.pos );
 			npc.interact();
+			return false;
 			
 		} else {
 			
 			if (Level.fieldOfView[npc.pos] && getCloser( npc.pos )) {
 				
+				return true;
+				
 			} else {
 				ready();
+				return false;
 			}
 			
 		}
 	}
 	
-	private void actBuy( HeroAction.Buy action ) {
+	private boolean actBuy( HeroAction.Buy action ) {
 		int dst = action.dst;
 		if (pos == dst || Level.adjacent( pos, dst )) {
 
@@ -523,28 +527,37 @@ public class Hero extends Char {
 				GameScene.show( new WndTradeItem( heap, true ) );
 			}
 			
+			return false;
+			
 		} else if (getCloser( dst )) {
 			
+			return true;
+			
 		} else {
 			ready();
+			return false;
 		}
 	}
 	
-	private void actCook( HeroAction.Cook action ) {
+	private boolean actCook( HeroAction.Cook action ) {
 		int dst = action.dst;
 		if (Dungeon.visible[dst]) {
 
 			ready();
 			AlchemyPot.operate( this, dst );
+			return false;
 			
 		} else if (getCloser( dst )) {
 			
+			return true;
+			
 		} else {
 			ready();
+			return false;
 		}
 	}
 	
-	private void actPickUp( HeroAction.PickUp action ) {
+	private boolean actPickUp( HeroAction.PickUp action ) {
 		int dst = action.dst;
 		if (pos == dst) {
 			
@@ -554,9 +567,8 @@ public class Hero extends Char {
 				if (item.doPickUp( this )) {
 					
 					if (item instanceof Dewdrop) {
-						
+
 					} else {
-						
 						if ((item instanceof ScrollOfUpgrade && ((ScrollOfUpgrade)item).isKnown()) ||
 							(item instanceof PotionOfStrength && ((PotionOfStrength)item).isKnown())) {
 							GLog.p( TXT_YOU_NOW_HAVE, item.name() );
@@ -577,14 +589,19 @@ public class Hero extends Char {
 				ready();
 			}
 			
+			return false;
+			
 		} else if (getCloser( dst )) {
 			
+			return true;
+			
 		} else {
 			ready();
+			return false;
 		}
 	}
 	
-	private void actOpenChest( HeroAction.OpenChest action ) {
+	private boolean actOpenChest( HeroAction.OpenChest action ) {
 		int dst = action.dst;
 		if (Level.adjacent( pos, dst ) || pos == dst) {
 			
@@ -602,7 +619,7 @@ public class Hero extends Char {
 					if (theKey == null) {
 						GLog.w( TXT_LOCKED_CHEST );
 						ready();
-						return;
+						return false;
 					}
 				}
 				
@@ -624,14 +641,19 @@ public class Hero extends Char {
 				ready();
 			}
 			
+			return false;
+			
 		} else if (getCloser( dst )) {
 			
+			return true;
+			
 		} else {
 			ready();
+			return false;
 		}
 	}
 	
-	private void actUnlock( HeroAction.Unlock action ) {
+	private boolean actUnlock( HeroAction.Unlock action ) {
 		int doorCell = action.dst;
 		if (Level.adjacent( pos, doorCell )) {
 			
@@ -660,14 +682,19 @@ public class Hero extends Char {
 				ready();
 			}
 			
+			return false;
+			
 		} else if (getCloser( doorCell )) {
 			
+			return true;
+			
 		} else {
 			ready();
+			return false;
 		}
 	}
 	
-	private void actDescend( HeroAction.Descend action ) {
+	private boolean actDescend( HeroAction.Descend action ) {
 		int stairs = action.dst;
 		if (pos == stairs && pos == Dungeon.level.exit) {
 			
@@ -681,14 +708,19 @@ public class Hero extends Char {
 			InterlevelScene.mode = InterlevelScene.Mode.DESCEND;
 			Game.switchScene( InterlevelScene.class );
 			
+			return false;
+			
 		} else if (getCloser( stairs )) {
 			
+			return true;
+			
 		} else {
 			ready();
+			return false;
 		}
 	}
 	
-	private void actAscend( HeroAction.Ascend action ) {
+	private boolean actAscend( HeroAction.Ascend action ) {
 		int stairs = action.dst;
 		if (pos == stairs && pos == Dungeon.level.entrance) {
 			
@@ -698,6 +730,7 @@ public class Hero extends Char {
 					GameScene.show( new WndMessage( TXT_LEAVE ) );
 					ready();
 				} else {
+					Dungeon.win( ResultDescriptions.WIN );
 					Dungeon.deleteGame( Dungeon.hero.heroClass, true );
 					Game.switchScene( SurfaceScene.class );
 				}
@@ -710,19 +743,24 @@ public class Hero extends Char {
 				if (hunger != null && !hunger.isStarving()) {
 					hunger.satisfy( -Hunger.STARVING / 10 );
 				}
-
+				
 				InterlevelScene.mode = InterlevelScene.Mode.ASCEND;
 				Game.switchScene( InterlevelScene.class );
 			}
 			
+			return false;
+			
 		} else if (getCloser( stairs )) {
-
+			
+			return true;
+			
 		} else {
 			ready();
+			return false;
 		}
 	}
 	
-	private void actAttack( HeroAction.Attack action ) {
+	private boolean actAttack( HeroAction.Attack action ) {
 
 		enemy = action.target;
 
@@ -731,12 +769,17 @@ public class Hero extends Char {
 			spend( attackDelay() );
 			sprite.attack( enemy.pos );
 			
+			return false;
+			
 		} else {
 			
 			if (Level.fieldOfView[enemy.pos] && getCloser( enemy.pos )) {
 				
+				return true;
+				
 			} else {
 				ready();
+				return false;
 			}
 			
 		}
@@ -752,20 +795,20 @@ public class Hero extends Char {
 	
 	@Override
 	public int attackProc( Char enemy, int damage ) {
-		if (belongings.weapon != null) {
+		KindOfWeapon wep = rangedWeapon != null ? rangedWeapon : belongings.weapon;
+		if (wep != null) {
 			
-			KindOfWeapon weapon = belongings.weapon;
-			weapon.proc( this, enemy, damage );
+			wep.proc( this, enemy, damage );
 			
 			switch (subClass) {
 			case GLADIATOR:
-				if (weapon instanceof MeleeWeapon) {
+				if (wep instanceof MeleeWeapon) {
 					damage += Buff.affect( this, Combo.class ).hit( enemy, damage );
 				}
 				break;
 			case BATTLEMAGE:
-				if (weapon instanceof Wand) {
-					Wand wand = (Wand)weapon;
+				if (wep instanceof Wand) {
+					Wand wand = (Wand)wep;
 					if (wand.curCharges < wand.maxCharges && damage > 0) {
 						
 						wand.curCharges++;
@@ -778,7 +821,7 @@ public class Hero extends Char {
 					damage += wand.curCharges;
 				}
 			case SNIPER:
-				if (usingRanged) {
+				if (rangedWeapon != null) {
 					Buff.prolong( enemy, SnipersMark.class, attackDelay() * 1.1f );
 				}
 				break;
@@ -823,9 +866,8 @@ public class Hero extends Char {
 	}
 	
 	private void checkVisibleMobs() {
-
 		ArrayList<Mob> visible = new ArrayList<Mob>();
-
+		
 		boolean newMob = false;
 		
 		for (Mob m : Dungeon.level.mobs) {
@@ -890,8 +932,9 @@ public class Hero extends Char {
 		
 		if (step != -1) {
 			
-			sprite.move( pos, step );
+			int oldPos = pos;
 			move( step );
+			sprite.move( oldPos, pos );
 			spend( 1 / speed() );
 			
 			return true;
@@ -904,10 +947,10 @@ public class Hero extends Char {
 
 	}
 	
-	public void handle( int cell ) {
+	public boolean handle( int cell ) {
 		
 		if (cell == -1) {
-			return;
+			return false;
 		}
 		
 		Char ch;
@@ -920,8 +963,8 @@ public class Hero extends Char {
 		} else
 		if (Level.fieldOfView[cell] && (ch = Actor.findChar( cell )) instanceof Mob) {
 			
-			if (ch instanceof Mob.NPC) {
-				curAction = new HeroAction.Interact( (Mob.NPC)ch );
+			if (ch instanceof NPC) {
+				curAction = new HeroAction.Interact( (NPC)ch );
 			} else {
 				curAction = new HeroAction.Attack( ch );
 			}
@@ -960,7 +1003,7 @@ public class Hero extends Char {
 			
 		}
 
-		act();
+		return act();
 	}
 	
 	public void earnExp( int exp ) {
@@ -1051,6 +1094,9 @@ public class Hero extends Char {
 				GLog.w( "You are crippled!" );
 			} else if (buff instanceof Bleeding) {
 				GLog.w( "You are bleeding!" );
+			} else if (buff instanceof Vertigo) {
+				GLog.w( "Everything is spinning around you!" );
+				interrupt();
 			}
 			
 			else if (buff instanceof Light) {
@@ -1110,6 +1156,7 @@ public class Hero extends Char {
 	
 	public static void reallyDie( Object cause ) {
 		
+		//   
 		int length = Level.LENGTH;
 		int[] map = Dungeon.level.map;
 		boolean[] visited = Dungeon.level.visited;
@@ -1150,18 +1197,17 @@ public class Hero extends Char {
 		
 		if (!flying) {
 			
-			if (Level.water[step]) {
+			if (Level.water[pos]) {
 				Sample.INSTANCE.play( Assets.SND_WATER, 1, 1, Random.Float( 0.8f, 1.25f ) );
 			} else {
 				Sample.INSTANCE.play( Assets.SND_STEP );
 			}
-			Dungeon.level.press( step, this );
+			Dungeon.level.press( pos, this );
 		}
 	}
 	
 	@Override
 	public void onMotionComplete() {
-		
 		Dungeon.observe();
 		search( false );
 			
@@ -1233,7 +1279,6 @@ public class Hero extends Char {
 
 		float level = intentional ? (2 * awareness - awareness * awareness) : awareness;
 		if (distance <= 0) {
-
 			level /= 2 - distance;
 			distance = 1;
 		}
@@ -1271,11 +1316,11 @@ public class Hero extends Char {
 						int oldValue = Dungeon.level.map[p];
 						
 						GameScene.discoverTile( p, oldValue );
-						
+
 						Level.set( p, Terrain.discover( oldValue ) );	
-						
+
 						GameScene.updateMap( p );
-						
+
 						ScrollOfMagicMapping.discover( p );
 						
 						smthFound = true;
@@ -1312,7 +1357,7 @@ public class Hero extends Char {
 		exp = 0;
 		
 		belongings.resurrect( resetLevel );
-
+		
 		live();
 	}
 	
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/HeroAction.java b/core/src/com/watabou/pixeldungeon/actors/hero/HeroAction.java
index 1c51ff5..5e934cd 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/HeroAction.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/HeroAction.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -18,8 +17,7 @@
 package com.watabou.pixeldungeon.actors.hero;
 
 import com.watabou.pixeldungeon.actors.Char;
-import com.watabou.pixeldungeon.actors.mobs.Mob;
-
+import com.watabou.pixeldungeon.actors.mobs.npcs.NPC;
 
 public class HeroAction {
 	
@@ -50,8 +48,8 @@ public class HeroAction {
 	}
 	
 	public static class Interact extends HeroAction {
-		public Mob.NPC npc;
-		public Interact( Mob.NPC npc ) {
+		public NPC npc;
+		public Interact( NPC npc ) {
 			this.npc = npc;
 		}
 	}
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/HeroClass.java b/core/src/com/watabou/pixeldungeon/actors/hero/HeroClass.java
index 7733dd0..12d4bc1 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/HeroClass.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/HeroClass.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -82,6 +81,8 @@ public enum HeroClass {
 		
 		hero.heroClass = this;
 		
+		initCommon( hero );
+		
 		switch (this) {
 		case WARRIOR:
 			initWarrior( hero );
@@ -100,20 +101,37 @@ public enum HeroClass {
 			break;
 		}
 		
+		if (Badges.isUnlocked( masteryBadge() )) {
+			new TomeOfMastery().collect();
+		}
+		
 		hero.updateAwareness();
 	}
 	
+	private static void initCommon( Hero hero ) {
+		(hero.belongings.armor = new ClothArmor()).identify();
+		new Food().identify().collect();
+	}
+	
+	public Badges.Badge masteryBadge() {
+		switch (this) {
+		case WARRIOR:
+			return Badges.Badge.MASTERY_WARRIOR;
+		case MAGE:
+			return Badges.Badge.MASTERY_MAGE;
+		case ROGUE:
+			return Badges.Badge.MASTERY_ROGUE;
+		case HUNTRESS:
+			return Badges.Badge.MASTERY_HUNTRESS;
+		}
+		return null;
+	}
+	
 	private static void initWarrior( Hero hero ) {
 		hero.STR = hero.STR + 1;
 		
 		(hero.belongings.weapon = new ShortSword()).identify();
-		(hero.belongings.armor = new ClothArmor()).identify();
 		new Dart( 8 ).identify().collect();
-		new Food().identify().collect();
-		
-		if (Badges.isUnlocked( Badges.Badge.MASTERY_WARRIOR )) {
-			new TomeOfMastery().collect();
-		}
 		
 		Dungeon.quickslot = Dart.class;
 		
@@ -122,16 +140,10 @@ public enum HeroClass {
 	
 	private static void initMage( Hero hero ) {	
 		(hero.belongings.weapon = new Knuckles()).identify();
-		(hero.belongings.armor = new ClothArmor()).identify();
-		new Food().identify().collect();
 		
 		WandOfMagicMissile wand = new WandOfMagicMissile();
 		wand.identify().collect();
 		
-		if (Badges.isUnlocked( Badges.Badge.MASTERY_MAGE )) {
-			new TomeOfMastery().collect();
-		}
-		
 		Dungeon.quickslot = wand;
 		
 		new ScrollOfIdentify().setKnown();
@@ -139,17 +151,11 @@ public enum HeroClass {
 	
 	private static void initRogue( Hero hero ) {
 		(hero.belongings.weapon = new Dagger()).identify();
-		(hero.belongings.armor = new ClothArmor()).identify();
 		(hero.belongings.ring1 = new RingOfShadows()).upgrade().identify();
 		new Dart( 8 ).identify().collect();
-		new Food().identify().collect();
 		
 		hero.belongings.ring1.activate( hero );
 		
-		if (Badges.isUnlocked( Badges.Badge.MASTERY_ROGUE )) {
-			new TomeOfMastery().collect();
-		}
-		
 		Dungeon.quickslot = Dart.class;
 		
 		new ScrollOfMagicMapping().setKnown();
@@ -160,14 +166,8 @@ public enum HeroClass {
 		hero.HP = (hero.HT -= 5);
 		
 		(hero.belongings.weapon = new Dagger()).identify();
-		(hero.belongings.armor = new ClothArmor()).identify();
 		Boomerang boomerang = new Boomerang();
 		boomerang.identify().collect();
-		new Food().identify().collect();
-		
-		if (Badges.isUnlocked( Badges.Badge.MASTERY_HUNTRESS )) {
-			new TomeOfMastery().collect();
-		}
 		
 		Dungeon.quickslot = boomerang;
 	}
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/HeroSubClass.java b/core/src/com/watabou/pixeldungeon/actors/hero/HeroSubClass.java
index de594fc..614c709 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/HeroSubClass.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/HeroSubClass.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -25,8 +24,7 @@ public enum HeroSubClass {
 	
 	GLADIATOR( "gladiator", 
 		"A successful attack with a melee weapon allows the _Gladiator_ to start a combo, " +
-		"in which every next successful hit inflicts more damage." ),
-		
+		"in which every next successful hit inflicts more damage." ),	
 	BERSERKER( "berserker", 
 		"When severely wounded, the _Berserker_ enters a state of wild fury " +
 		"significantly increasing his damage output." ),
@@ -34,14 +32,12 @@ public enum HeroSubClass {
 	WARLOCK( "warlock", 
 		"After killing an enemy the _Warlock_ consumes its soul. " +
 		"It heals his wounds and satisfies his hunger." ),
-
 	BATTLEMAGE( "battlemage", 
 		"When fighting with a wand in his hands, the _Battlemage_ inflicts additional damage depending " +
 		"on the current number of charges. Every successful hit restores 1 charge to this wand." ),
 	
 	ASSASSIN( "assassin", 
 		"When performing a surprise attack, the _Assassin_ inflicts additional damage to his target." ),
-
 	FREERUNNER( "freerunner", 
 		"The _Freerunner_ can move almost twice faster, than most of the monsters. When he " +
 		"is running, the Freerunner is much harder to hit. For that he must be unencumbered and not starving." ),
@@ -49,7 +45,6 @@ public enum HeroSubClass {
 	SNIPER( "sniper", 
 		"_Snipers_ are able to detect weak points in an enemy's armor, " +
 		"effectively ignoring it when using a missile weapon." ),
-
 	WARDEN( "warden", 
 		"Having a strong connection with forces of nature gives _Wardens_ an ability to gather dewdrops and " +
 		"seeds from plants. Also trampling a high grass grants them a temporary armor buff." );
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Acidic.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Acidic.java
index 82f7339..3ff0723 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Acidic.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Acidic.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Albino.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Albino.java
index 8dd19bb..b4dfbc6 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Albino.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Albino.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Bandit.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Bandit.java
index 5245bfa..2407adb 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Bandit.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Bandit.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Bat.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Bat.java
index 4da00ce..1dfb916 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Bat.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Bat.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Bestiary.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Bestiary.java
index 042db67..c6b3397 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Bestiary.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Bestiary.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Brute.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Brute.java
index acc104c..018ee06 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Brute.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Brute.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Crab.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Crab.java
index 53ccd7c..6a30147 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Crab.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Crab.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/DM300.java b/core/src/com/watabou/pixeldungeon/actors/mobs/DM300.java
index 1e943b2..4f665f7 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/DM300.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/DM300.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -75,7 +74,7 @@ public class DM300 extends Mob {
 	
 	@Override
 	public boolean act() {
-		
+
 		GameScene.add( Blob.seed( pos, 30, ToxicGas.class ) );
 		
 		return super.act();
@@ -84,7 +83,7 @@ public class DM300 extends Mob {
 	@Override
 	public void move( int step ) {
 		super.move( step );
-		
+
 		if (Dungeon.level.map[step] == Terrain.INACTIVE_TRAP && HP < HT) {
 			
 			HP += Random.Int( 1, HT - HP );
@@ -94,7 +93,7 @@ public class DM300 extends Mob {
 				GLog.n( "DM-300 repairs itself!" );
 			}
 		}
-		
+
 		int[] cells = {
 			step-1, step+1, step-Level.WIDTH, step+Level.WIDTH, 
 			step-1-Level.WIDTH, 
@@ -108,7 +107,7 @@ public class DM300 extends Mob {
 			CellEmitter.get( cell ).start( Speck.factory( Speck.ROCK ), 0.07f, 10 );
 			Camera.main.shake( 3, 0.7f );
 			Sample.INSTANCE.play( Assets.SND_ROCKS );
-			
+
 			if (Level.water[cell]) {
 				GameScene.ripple( cell );
 			} else if (Dungeon.level.map[cell] == Terrain.EMPTY) {
@@ -129,7 +128,7 @@ public class DM300 extends Mob {
 		super.die( cause );
 		
 		GameScene.bossSlain();
-		Dungeon.level.drop( new SkeletonKey( Dungeon.depth  ), pos ).sprite.drop();
+		Dungeon.level.drop( new SkeletonKey(), pos ).sprite.drop();
 		
 		Badges.validateBossSlain();
 		
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Elemental.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Elemental.java
index 6954ce9..39c0065 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Elemental.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Elemental.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java
index 79c2498..a94de5a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -71,6 +70,7 @@ public class Eye extends Mob {
 		
 		hitCell = Ballistica.cast( pos, enemy.pos, true, false );
 		
+		//   1 ,   0- -   
 		for (int i=1; i < Ballistica.distance; i++) {
 			if (Ballistica.trace[i] == enemy.pos) {
 				return true;
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Gnoll.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Gnoll.java
index caa13a4..1d318e8 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Gnoll.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Gnoll.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Golem.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Golem.java
index f1e633a..b818178 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Golem.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Golem.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Goo.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Goo.java
index 041a240..9a09246 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Goo.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Goo.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -154,7 +153,7 @@ public class Goo extends Mob {
 		((SewerBossLevel)Dungeon.level).unseal();
 		
 		GameScene.bossSlain();
-		Dungeon.level.drop( new SkeletonKey( Dungeon.depth ), pos ).sprite.drop();
+		Dungeon.level.drop( new SkeletonKey(), pos ).sprite.drop();
 		
 		Badges.validateBossSlain();
 		
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/King.java b/core/src/com/watabou/pixeldungeon/actors/mobs/King.java
index dc534c7..7f9e606 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/King.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/King.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -134,10 +133,9 @@ public class King extends Mob {
 	
 	@Override
 	public void die( Object cause ) {
-
 		GameScene.bossSlain();
 		Dungeon.level.drop( new ArmorKit(), pos ).sprite.drop();
-		Dungeon.level.drop( new SkeletonKey( Dungeon.depth ), pos ).sprite.drop();
+		Dungeon.level.drop( new SkeletonKey(), pos ).sprite.drop();
 		
 		super.die( cause );
 		
@@ -246,7 +244,7 @@ public class King extends Mob {
 			
 			EXP = 0;
 			
-			state = State.WANDERING;
+			state = WANDERING;
 		}
 		
 		@Override
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Mob.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Mob.java
index e90867e..befc05c 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Mob.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Mob.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -21,6 +20,7 @@ import java.util.HashSet;
 
 import com.badlogic.gdx.utils.reflect.ClassReflection;
 import com.watabou.pixeldungeon.Badges;
+import com.watabou.pixeldungeon.Challenges;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.Statistics;
 import com.watabou.pixeldungeon.actors.Char;
@@ -33,7 +33,6 @@ import com.watabou.pixeldungeon.actors.hero.HeroSubClass;
 import com.watabou.pixeldungeon.effects.Flare;
 import com.watabou.pixeldungeon.effects.Wound;
 import com.watabou.pixeldungeon.items.Generator;
-import com.watabou.pixeldungeon.items.Heap;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.levels.Level;
 import com.watabou.pixeldungeon.sprites.CharSprite;
@@ -49,14 +48,12 @@ public abstract class Mob extends Char {
 	protected static final String TXT_RAGE		= "#$%^";
 	protected static final String TXT_EXP		= "%+dEXP";
 	
-	public enum State {
-		SLEEPING,
-		HUNTING,
-		WANDERING,
-		FLEEING,
-		PASSIVE
-	}
-	public State state = State.SLEEPING;
+	public AiState SLEEPEING	= new Sleeping();
+	public AiState HUNTING		= new Hunting();
+	public AiState WANDERING	= new Wandering();
+	public AiState FLEEING		= new Fleeing();
+	public AiState PASSIVE		= new Passive();
+	public AiState state = SLEEPEING;
 	
 	public Class<? extends CharSprite> spriteClass;
 	
@@ -90,10 +87,18 @@ public abstract class Mob extends Char {
 		
 		super.storeInBundle( bundle );
 		
-		bundle.put( STATE, state.toString() );
-		if (state != State.SLEEPING) {
-			bundle.put( TARGET, target );
+		if (state == SLEEPEING) {
+			bundle.put( STATE, Sleeping.TAG );
+		} else if (state == WANDERING) {
+			bundle.put( STATE, Wandering.TAG );
+		} else if (state == HUNTING) {
+			bundle.put( STATE, Hunting.TAG );
+		} else if (state == FLEEING) {
+			bundle.put( STATE, Fleeing.TAG );
+		} else if (state == PASSIVE) {
+			bundle.put( STATE, Passive.TAG );
 		}
+		bundle.put( TARGET, target );
 	}
 	
 	@Override
@@ -101,10 +106,20 @@ public abstract class Mob extends Char {
 		
 		super.restoreFromBundle( bundle );
 		
-		state = State.valueOf( bundle.getString( STATE ) );
-		if (state != State.SLEEPING) {
-			target = bundle.getInt( TARGET );
+		String state = bundle.getString( STATE );
+		if (state.equals( Sleeping.TAG )) {
+			this.state = SLEEPEING;
+		} else if (state.equals( Wandering.TAG )) {
+			this.state = WANDERING;
+		} else if (state.equals( Hunting.TAG )) {
+			this.state = HUNTING;
+		} else if (state.equals( Fleeing.TAG )) {
+			this.state = FLEEING;
+		} else if (state.equals( Passive.TAG )) {
+			this.state = PASSIVE;
 		}
+
+		target = bundle.getInt( TARGET );
 	}
 	
 	public CharSprite sprite() {
@@ -121,7 +136,7 @@ public abstract class Mob extends Char {
 		
 		super.act();
 		
-		boolean alertedNow = alerted;
+		boolean justAlerted = alerted;
 		alerted = false;
 		
 		sprite.hideAlert();
@@ -136,109 +151,7 @@ public abstract class Mob extends Char {
 		
 		boolean enemyInFOV = enemy.isAlive() && Level.fieldOfView[enemy.pos] && enemy.invisible <= 0;
 		
-		int oldPos = pos;
-		
-		switch (state) {
-		
-		case SLEEPING:
-			if (enemyInFOV && 
-				Random.Int( distance( enemy ) + enemy.stealth() + (enemy.flying ? 2 : 0) ) == 0) {
-				
-				enemySeen = true;
-
-				notice();
-				state = State.HUNTING;
-				target = enemy.pos;
-				
-				spend( TIME_TO_WAKE_UP );
-				
-			} else {
-				
-				enemySeen = false;
-				
-				spend( TICK );
-				
-			}
-			return true;
-
-		case WANDERING:
-			if (enemyInFOV && (alertedNow || Random.Int( distance( enemy ) / 2 + enemy.stealth() ) == 0)) {
-				
-				enemySeen = true;
-				
-				notice();
-				state = State.HUNTING;
-				target = enemy.pos;
-				
-			} else {
-				
-				enemySeen = false;
-				
-				if (target != -1 && getCloser( target )) {
-					spend( 1 / speed() );
-					return moveSprite( oldPos, pos );
-				} else {
-					target = Dungeon.level.randomDestination();
-					spend( TICK );
-				}
-				
-			}
-			return true;
-			
-		case HUNTING:
-			enemySeen = enemyInFOV;
-			if (enemyInFOV && canAttack( enemy )) {
-				
-				return doAttack( enemy );
-				
-			} else {
-
-				if (enemyInFOV) {
-					target = enemy.pos;
-				}
-
-				if (target != -1 && getCloser( target )) {
-					
-
-					spend( 1 / speed() );
-					return moveSprite( oldPos,  pos );
-					
-				} else {
-					
-					spend( TICK );
-					state = State.WANDERING;
-					target = Dungeon.level.randomDestination();	// <--------
-					return true;
-				}
-			}
-			
-		case FLEEING:
-			enemySeen = enemyInFOV;
-			if (enemyInFOV) {
-				target = enemy.pos;
-			}
-			if (target != -1 && getFurther( target )) {
-				
-				spend( 1 / speed() );
-				return moveSprite( oldPos, pos );
-				
-			} else {
-				
-				spend( TICK );
-				nowhereToRun();
-				
-				return true;
-			}
-			
-		case PASSIVE:
-			enemySeen = false;
-			spend( TICK );
-			return true;
-			
-		}
-		
-		return true;
-
+		return state.act( enemyInFOV, justAlerted );
 	}
 	
 	protected Char chooseEnemy() {
@@ -269,14 +182,11 @@ public abstract class Mob extends Char {
 		return Dungeon.hero;
 	}
 	
-	protected void nowhereToRun() {
-	}
-	
 	protected boolean moveSprite( int from, int to ) {
 
 		if (sprite.isVisible() && (Dungeon.visible[from] || Dungeon.visible[to])) {
 			sprite.move( from, to );
-			return false;
+			return true;
 		} else {
 			sprite.place( to );
 			return true;
@@ -290,14 +200,14 @@ public abstract class Mob extends Char {
 			if (sprite != null) {
 				sprite.showStatus( CharSprite.NEGATIVE, TXT_RAGE );
 			}
-			state = State.HUNTING;
+			state = HUNTING;
 		} else if (buff instanceof Terror) {
-			state = State.FLEEING;
+			state = FLEEING;
 		} else if (buff instanceof Sleep) {
 			if (sprite != null) {
 				new Flare( 4, 32 ).color( 0x44ffff, true ).show( sprite, 2f ) ;
 			}
-			state = State.SLEEPING;
+			state = SLEEPEING;
 			postpone( Sleep.SWS );
 		}
 	}
@@ -307,7 +217,7 @@ public abstract class Mob extends Char {
 		super.remove( buff );
 		if (buff instanceof Terror) {
 			sprite.showStatus( CharSprite.NEGATIVE, TXT_RAGE );
-			state = State.HUNTING;
+			state = HUNTING;
 		}
 	}
 	
@@ -397,8 +307,8 @@ public abstract class Mob extends Char {
 
 		Terror.recover( this );
 		
-		if (state == State.SLEEPING) {
-			state = State.WANDERING;
+		if (state == SLEEPEING) {
+			state = WANDERING;
 		}
 		alerted = true;
 		
@@ -481,8 +391,8 @@ public abstract class Mob extends Char {
 		
 		notice();
 		
-		if (state != State.HUNTING) {
-			state = State.WANDERING;
+		if (state != HUNTING) {
+			state = WANDERING;
 		}
 		target = cell;
 	}
@@ -499,31 +409,176 @@ public abstract class Mob extends Char {
 		GLog.n( "%s: \"%s\" ", name, str );
 	}
 	
-	public static abstract class NPC extends Mob {
+	public interface AiState {
+		public boolean act( boolean enemyInFOV, boolean justAlerted );
+		public String status();
+	}
+	
+	private class Sleeping implements AiState {
 		
-		{
-			HP = HT = 1;
-			EXP = 0;
+		public static final String TAG	= "SLEEPING";
+		
+		@Override
+		public boolean act( boolean enemyInFOV, boolean justAlerted ) {
+			if (enemyInFOV && Random.Int( distance( enemy ) + enemy.stealth() + (enemy.flying ? 2 : 0) ) == 0) {
+					
+				enemySeen = true;
+
+				notice();
+				state = HUNTING;
+				target = enemy.pos;
+				
+				if (Dungeon.isChallenged( Challenges.SWARM_INTELLIGENCE )) {
+					for (Mob mob : Dungeon.level.mobs) {
+						if (mob != Mob.this) {
+							mob.beckon( target );
+						}
+					}
+				}
+				
+				spend( TIME_TO_WAKE_UP );
+				
+			} else {
+				
+				enemySeen = false;
+				
+				spend( TICK );
+				
+			}
+			return true;
+		}
 		
-			hostile = false;
-			state = State.PASSIVE;
+		@Override
+		public String status() {
+			return String.format( "This %s is sleeping", name );
 		}
+	}
+	
+	private class Wandering implements AiState {
+		
+		public static final String TAG	= "WANDERING";
 		
-		protected void throwItem() {
-			Heap heap = Dungeon.level.heaps.get( pos );
-			if (heap != null) {
-				int n;
-				do {
-					n = pos + Level.NEIGHBOURS8[Random.Int( 8 )];
-				} while (!Level.passable[n] && !Level.avoid[n]);
-				Dungeon.level.drop( heap.pickUp(), n ).sprite.drop( pos );
+		@Override
+		public boolean act( boolean enemyInFOV, boolean justAlerted ) {
+			if (enemyInFOV && (justAlerted || Random.Int( distance( enemy ) / 2 + enemy.stealth() ) == 0)) {
+				
+				enemySeen = true;
+				
+				notice();
+				state = HUNTING;
+				target = enemy.pos;
+				
+			} else {
+				
+				enemySeen = false;
+				
+				int oldPos = pos;
+				if (target != -1 && getCloser( target )) {
+					spend( 1 / speed() );
+					return moveSprite( oldPos, pos );
+				} else {
+					target = Dungeon.level.randomDestination();
+					spend( TICK );
+				}
+				
 			}
+			return true;
 		}
 		
 		@Override
-		public void beckon( int cell ) {
+		public String status() {
+			return String.format( "This %s is wandering", name );
 		}
+	}
+	
+	private class Hunting implements AiState {
 		
-		abstract public void interact();
+		public static final String TAG	= "HUNTING";
+		
+		@Override
+		public boolean act( boolean enemyInFOV, boolean justAlerted ) {
+			enemySeen = enemyInFOV;
+			if (enemyInFOV && canAttack( enemy )) {
+				
+				return doAttack( enemy );
+				
+			} else {
+
+				if (enemyInFOV) {
+					target = enemy.pos;
+				}
+
+				int oldPos = pos;
+				if (target != -1 && getCloser( target )) {
+					
+					spend( 1 / speed() );
+					return moveSprite( oldPos,  pos );
+					
+				} else {
+					
+					spend( TICK );
+					state = WANDERING;
+					target = Dungeon.level.randomDestination();
+					return true;
+				}
+			}
+		}
+		
+		@Override
+		public String status() {
+			return String.format( "This %s is hunting", name );
+		}
+	}
+	
+	protected class Fleeing implements AiState {
+		
+		public static final String TAG	= "FLEEING";
+		
+		@Override
+		public boolean act( boolean enemyInFOV, boolean justAlerted ) {
+			enemySeen = enemyInFOV;
+			if (enemyInFOV) {
+				target = enemy.pos;
+			}
+			
+			int oldPos = pos;
+			if (target != -1 && getFurther( target )) {
+				
+				spend( 1 / speed() );
+				return moveSprite( oldPos, pos );
+				
+			} else {
+				
+				spend( TICK );
+				nowhereToRun();
+				
+				return true;
+			}
+		}
+		
+		protected void nowhereToRun() {
+		}
+		
+		@Override
+		public String status() {
+			return String.format( "This %s is fleeing", name );
+		}
+	}
+	
+	private class Passive implements AiState {
+		
+		public static final String TAG	= "PASSIVE";
+		
+		@Override
+		public boolean act( boolean enemyInFOV, boolean justAlerted ) {
+			enemySeen = false;
+			spend( TICK );
+			return true;
+		}
+		
+		@Override
+		public String status() {
+			return String.format( "This %s is passive", name );
+		}
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Monk.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Monk.java
index f3697ac..bc67e8f 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Monk.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Monk.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Piranha.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Piranha.java
index 551f5be..63f2ace 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Piranha.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Piranha.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Rat.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Rat.java
index cb06ea2..43dc546 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Rat.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Rat.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Scorpio.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Scorpio.java
index 724a43f..dab7ba4 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Scorpio.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Scorpio.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -81,7 +80,7 @@ public class Scorpio extends Mob {
 	
 	@Override
 	protected boolean getCloser( int target ) {
-		if (state == State.HUNTING) {
+		if (state == HUNTING) {
 			return enemySeen && getFurther( target );
 		} else {
 			return super.getCloser( target );
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Senior.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Senior.java
index 4f1e2cc..838d05f 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Senior.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Senior.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Shaman.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Shaman.java
index 97515f9..9955787 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Shaman.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Shaman.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Shielded.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Shielded.java
index c4e4329..3009e48 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Shielded.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Shielded.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Skeleton.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Skeleton.java
index 4c9b3a3..87c18e9 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Skeleton.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Skeleton.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Spinner.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Spinner.java
index c93e73d..5e8d23c 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Spinner.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Spinner.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -45,6 +44,8 @@ public class Spinner extends Mob {
 		
 		loot = new MysteryMeat();
 		lootChance = 0.125f;
+		
+		FLEEING = new Fleeing();
 	}
 	
 	@Override
@@ -53,15 +54,6 @@ public class Spinner extends Mob {
 	}
 	
 	@Override
-	protected void nowhereToRun() {
-		if (buff( Terror.class ) == null) {
-			state = State.HUNTING;
-		} else {
-			super.nowhereToRun();
-		}
-	}
-	
-	@Override
 	public int attackSkill( Char target ) {
 		return 20;
 	}
@@ -75,10 +67,10 @@ public class Spinner extends Mob {
 	protected boolean act() {
 		boolean result = super.act();
 		
-		if (state == State.FLEEING  && buff( Terror.class ) == null && 
+		if (state == FLEEING  && buff( Terror.class ) == null && 
 			enemySeen && enemy.buff( Poison.class ) == null) {
 			
-			state = State.HUNTING;
+			state = HUNTING;
 		}
 		return result;
 	}
@@ -86,8 +78,8 @@ public class Spinner extends Mob {
 	@Override
 	public int attackProc( Char enemy, int damage ) {
 		if (Random.Int( 2 ) == 0) {
-			Buff.affect( enemy, Poison.class ).set( Random.Int( 5, 7 ) * Poison.durationFactor( enemy ) );
-			state = State.FLEEING;
+			Buff.affect( enemy, Poison.class ).set( Random.Int( 7, 9 ) * Poison.durationFactor( enemy ) );
+			state = FLEEING;
 		}
 		
 		return damage;
@@ -95,7 +87,7 @@ public class Spinner extends Mob {
 	
 	@Override
 	public void move( int step ) {
-		if (state == State.FLEEING) {
+		if (state == FLEEING) {
 			GameScene.add( Blob.seed( pos, Random.Int( 5, 7 ), Web.class ) );
 		}
 		super.move( step );
@@ -127,4 +119,15 @@ public class Spinner extends Mob {
 	public HashSet<Class<?>> immunities() {
 		return IMMUNITIES;
 	}
+	
+	private class Fleeing extends Mob.Fleeing {
+		@Override
+		protected void nowhereToRun() {
+			if (buff( Terror.class ) == null) {
+				state = HUNTING;
+			} else {
+				super.nowhereToRun();
+			}
+		}
+	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Statue.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Statue.java
index 3e9ba24..8fe5cc8 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Statue.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Statue.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -42,7 +41,7 @@ public class Statue extends Mob {
 		spriteClass = StatueSprite.class;
 
 		EXP = 0;
-		state = State.PASSIVE;
+		state = PASSIVE;
 	}
 	
 	private Weapon weapon;
@@ -106,8 +105,8 @@ public class Statue extends Mob {
 	@Override
 	public void damage( int dmg, Object src ) {
 
-		if (state == State.PASSIVE) {
-			state = State.HUNTING;
+		if (state == PASSIVE) {
+			state = HUNTING;
 		}
 		
 		super.damage( dmg, src );
@@ -137,7 +136,7 @@ public class Statue extends Mob {
 	
 	@Override
 	public boolean reset() {
-		state = State.PASSIVE;
+		state = PASSIVE;
 		return true;
 	}
 
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Succubus.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Succubus.java
index 764c593..8e33f2a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Succubus.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Succubus.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Swarm.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Swarm.java
index 9e3dcb5..38493ee 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Swarm.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Swarm.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -91,7 +90,7 @@ public class Swarm extends Mob {
 				Swarm clone = split();
 				clone.HP = (HP - damage) / 2;
 				clone.pos = Random.element( candidates );
-				clone.state = State.HUNTING;
+				clone.state = clone.HUNTING;
 				
 				if (Dungeon.level.map[clone.pos] == Terrain.DOOR) {
 					Door.enter( clone.pos );
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Tengu.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Tengu.java
index be59824..571dc74 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Tengu.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Tengu.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -95,7 +94,7 @@ public class Tengu extends Mob {
 		}
 		
 		GameScene.bossSlain();
-		Dungeon.level.drop( new SkeletonKey( Dungeon.depth ), pos ).sprite.drop();
+		Dungeon.level.drop( new SkeletonKey(), pos ).sprite.drop();
 		super.die( cause );
 		
 		Badges.validateBossSlain();
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Thief.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Thief.java
index d73f2e6..f275750 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Thief.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Thief.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -50,6 +49,8 @@ public class Thief extends Mob {
 		
 		loot = RingOfHaggler.class;
 		lootChance = 0.01f;
+		
+		FLEEING = new Fleeing();
 	}
 	
 	private static final String ITEM = "item";
@@ -77,16 +78,6 @@ public class Thief extends Mob {
 	}
 	
 	@Override
-	protected void nowhereToRun() {
-		if (buff( Terror.class ) == null) {
-			sprite.showStatus( CharSprite.NEGATIVE, TXT_RAGE );
-			state = State.HUNTING;
-		} else {
-			super.nowhereToRun();
-		}
-	}
-	
-	@Override
 	public void die( Object cause ) {
 
 		super.die( cause );
@@ -109,7 +100,7 @@ public class Thief extends Mob {
 	@Override
 	public int attackProc( Char enemy, int damage ) {
 		if (item == null && enemy instanceof Hero && steal( (Hero)enemy )) {
-			state = State.FLEEING;
+			state = FLEEING;
 		}
 		
 		return damage;
@@ -117,7 +108,7 @@ public class Thief extends Mob {
 	
 	@Override
 	public int defenseProc(Char enemy, int damage) {
-		if (state == State.FLEEING) {
+		if (state == FLEEING) {
 			Dungeon.level.drop( new Gold(), pos ).sprite.drop();
 		}
 		
@@ -153,4 +144,16 @@ public class Thief extends Mob {
 		
 		return desc;
 	}
+	
+	private class Fleeing extends Mob.Fleeing {
+		@Override
+		protected void nowhereToRun() {
+			if (buff( Terror.class ) == null) {
+				sprite.showStatus( CharSprite.NEGATIVE, TXT_RAGE );
+				state = HUNTING;
+			} else {
+				super.nowhereToRun();
+			}
+		}
+	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Warlock.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Warlock.java
index de3e863..d373d25 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Warlock.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Warlock.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Wraith.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Wraith.java
index 2a05e26..d7377ba 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Wraith.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Wraith.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -86,7 +85,7 @@ public class Wraith extends Mob {
 	
 	@Override
 	public boolean reset() {
-		state = State.WANDERING;
+		state = WANDERING;
 		return true;
 	}
 
@@ -112,7 +111,7 @@ public class Wraith extends Mob {
 			Wraith w = new Wraith();
 			w.adjustStats( Dungeon.depth );
 			w.pos = pos;
-			w.state = State.HUNTING;
+			w.state = w.HUNTING;
 			GameScene.add( w, SPAWN_DELAY );
 			
 			w.sprite.alpha( 0 );
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Yog.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Yog.java
index e8a2dad..3f2651b 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Yog.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Yog.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -62,7 +61,7 @@ public class Yog extends Mob {
 		
 		EXP = 50;
 		
-		state = State.PASSIVE;
+		state = PASSIVE;
 	}
 	
 	private static final String TXT_DESC =
@@ -144,7 +143,7 @@ public class Yog extends Mob {
 		}
 		
 		GameScene.bossSlain();
-		Dungeon.level.drop( new SkeletonKey( Dungeon.depth ), pos ).sprite.drop();
+		Dungeon.level.drop( new SkeletonKey(), pos ).sprite.drop();
 		super.die( cause );
 		
 		yell( "..." );
@@ -193,7 +192,7 @@ public class Yog extends Mob {
 			
 			EXP = 0;
 			
-			state = State.WANDERING;
+			state = WANDERING;
 		}
 		
 		public RottingFist() {
@@ -286,7 +285,7 @@ public class Yog extends Mob {
 			
 			EXP = 0;
 			
-			state = State.WANDERING;
+			state = WANDERING;
 		}
 		
 		public BurningFist() {
@@ -403,7 +402,7 @@ public class Yog extends Mob {
 			
 			EXP = 0;
 			
-			state = State.HUNTING;
+			state = HUNTING;
 		}
 		
 		@Override
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Blacksmith.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Blacksmith.java
index d10529a..bad5c0d 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Blacksmith.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Blacksmith.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -27,7 +26,6 @@ import com.watabou.pixeldungeon.Journal;
 import com.watabou.pixeldungeon.actors.Char;
 import com.watabou.pixeldungeon.actors.buffs.Buff;
 import com.watabou.pixeldungeon.actors.hero.Hero;
-import com.watabou.pixeldungeon.actors.mobs.Mob;
 import com.watabou.pixeldungeon.items.EquipableItem;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.quest.DarkGold;
@@ -43,7 +41,7 @@ import com.watabou.pixeldungeon.windows.WndQuest;
 import com.watabou.utils.Bundle;
 import com.watabou.utils.Random;
 
-public class Blacksmith extends Mob.NPC {
+public class Blacksmith extends NPC {
 
 	private static final String TXT_GOLD_1 =
 		"Hey human! Wanna be useful, eh? Take dis pickaxe and mine me some _dark gold ore_, _15 pieces_ should be enough. " +
@@ -168,7 +166,7 @@ public class Blacksmith extends Mob.NPC {
 			return "Select 2 different items, not the same item twice!";
 		}
 		
-		if (!item1.isSimilar( item2 )) {
+		if (item1.getClass() != item2.getClass()) {
 			return "Select 2 items of the same type!";
 		}
 		
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Ghost.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Ghost.java
index 7af8f3a..5e507b7 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Ghost.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Ghost.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -21,6 +20,7 @@ import java.util.HashSet;
 
 import com.watabou.noosa.audio.Sample;
 import com.watabou.pixeldungeon.Assets;
+import com.watabou.pixeldungeon.Challenges;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.Journal;
 import com.watabou.pixeldungeon.actors.Actor;
@@ -36,6 +36,7 @@ import com.watabou.pixeldungeon.effects.Speck;
 import com.watabou.pixeldungeon.items.Generator;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.armor.Armor;
+import com.watabou.pixeldungeon.items.armor.ClothArmor;
 import com.watabou.pixeldungeon.items.quest.DriedRose;
 import com.watabou.pixeldungeon.items.quest.RatSkull;
 import com.watabou.pixeldungeon.items.weapon.Weapon;
@@ -49,7 +50,7 @@ import com.watabou.pixeldungeon.windows.WndSadGhost;
 import com.watabou.utils.Bundle;
 import com.watabou.utils.Random;
 
-public class Ghost extends Mob.NPC {
+public class Ghost extends NPC {
 
 	{
 		name = "sad ghost";
@@ -57,7 +58,7 @@ public class Ghost extends Mob.NPC {
 		
 		flying = true;
 		
-		state = State.WANDERING;
+		state = WANDERING;
 	}
 	
 	private static final String TXT_ROSE1	=
@@ -181,11 +182,11 @@ public class Ghost extends Mob.NPC {
 		private static boolean spawned;
 		
 		private static boolean alternative;
-
-		private static boolean given;
 		
+		private static boolean given;
+
 		private static boolean processed;
-		
+
 		private static int depth;
 		
 		private static int left2kill;
@@ -280,7 +281,12 @@ public class Ghost extends Mob.NPC {
 				do {
 					weapon = (Weapon)Generator.random( Generator.Category.WEAPON );
 				} while (weapon instanceof MissileWeapon);
-				armor = (Armor)Generator.random( Generator.Category.ARMOR );
+				
+				if (Dungeon.isChallenged( Challenges.NO_ARMOR )) {
+					armor = (Armor)new ClothArmor().degrade();
+				} else {
+					armor = (Armor)Generator.random( Generator.Category.ARMOR );
+				}
 					
 				for (int i=0; i < 3; i++) {
 					Item another;
@@ -299,13 +305,12 @@ public class Ghost extends Mob.NPC {
 				armor.identify();
 			}
 		}
-		
+
 		public static void process( int pos ) {
 			if (spawned && given && !processed && (depth == Dungeon.depth)) {
 				if (alternative) {
 					
 					FetidRat rat = new FetidRat();
-					rat.state = Mob.State.WANDERING;
 					rat.pos = Dungeon.level.randomRespawnCell();
 					if (rat.pos != -1) {
 						GameScene.add( rat );
@@ -344,6 +349,8 @@ public class Ghost extends Mob.NPC {
 			
 			EXP = 0;
 			maxLvl = 5;	
+			
+			state = WANDERING;
 		}
 		
 		@Override
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Imp.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Imp.java
index c256246..87f7419 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Imp.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Imp.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -38,7 +37,7 @@ import com.watabou.pixeldungeon.windows.WndQuest;
 import com.watabou.utils.Bundle;
 import com.watabou.utils.Random;
 
-public class Imp extends Mob.NPC {
+public class Imp extends NPC {
 
 	{
 		name = "ambitious imp";
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/ImpShopkeeper.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/ImpShopkeeper.java
index eed5255..be8e099 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/ImpShopkeeper.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/ImpShopkeeper.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/MirrorImage.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/MirrorImage.java
index 813e036..9ec4f63 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/MirrorImage.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/MirrorImage.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -21,6 +20,8 @@ import java.util.HashSet;
 
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.Char;
+import com.watabou.pixeldungeon.actors.blobs.ToxicGas;
+import com.watabou.pixeldungeon.actors.buffs.Burning;
 import com.watabou.pixeldungeon.actors.hero.Hero;
 import com.watabou.pixeldungeon.actors.mobs.Mob;
 import com.watabou.pixeldungeon.levels.Level;
@@ -29,13 +30,13 @@ import com.watabou.pixeldungeon.sprites.MirrorSprite;
 import com.watabou.utils.Bundle;
 import com.watabou.utils.Random;
 
-public class MirrorImage extends Mob.NPC {
+public class MirrorImage extends NPC {
 	
 	{
 		name = "mirror image";
 		spriteClass = MirrorSprite.class;
 		
-		state = State.HUNTING;
+		state = HUNTING;
 		
 		enemy = DUMMY;
 	}
@@ -135,4 +136,15 @@ public class MirrorImage extends Mob.NPC {
 		Dungeon.hero.spend( 1 / Dungeon.hero.speed() );
 		Dungeon.hero.busy();
 	}
+	
+	private static final HashSet<Class<?>> IMMUNITIES = new HashSet<Class<?>>();
+	static {
+		IMMUNITIES.add( ToxicGas.class );
+		IMMUNITIES.add( Burning.class );
+	}
+	
+	@Override
+	public HashSet<Class<?>> immunities() {
+		return IMMUNITIES;
+	}
 }
\ No newline at end of file
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/NPC.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/NPC.java
new file mode 100644
index 0000000..1eb325c
--- /dev/null
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/NPC.java
@@ -0,0 +1,51 @@
+/*
+ * Copyright (C) 2012-2014  Oleg Dolya
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>
+ */
+package com.watabou.pixeldungeon.actors.mobs.npcs;
+
+import com.watabou.pixeldungeon.Dungeon;
+import com.watabou.pixeldungeon.actors.mobs.Mob;
+import com.watabou.pixeldungeon.items.Heap;
+import com.watabou.pixeldungeon.levels.Level;
+import com.watabou.utils.Random;
+
+public abstract class NPC extends Mob {
+	
+	{
+		HP = HT = 1;
+		EXP = 0;
+	
+		hostile = false;
+		state = PASSIVE;
+	}
+	
+	protected void throwItem() {
+		Heap heap = Dungeon.level.heaps.get( pos );
+		if (heap != null) {
+			int n;
+			do {
+				n = pos + Level.NEIGHBOURS8[Random.Int( 8 )];
+			} while (!Level.passable[n] && !Level.avoid[n]);
+			Dungeon.level.drop( heap.pickUp(), n ).sprite.drop( pos );
+		}
+	}
+	
+	@Override
+	public void beckon( int cell ) {
+	}
+	
+	abstract public void interact();
+}
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/RatKing.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/RatKing.java
index 67c4901..8801bdf 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/RatKing.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/RatKing.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -20,17 +19,16 @@ package com.watabou.pixeldungeon.actors.mobs.npcs;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.Char;
 import com.watabou.pixeldungeon.actors.buffs.Buff;
-import com.watabou.pixeldungeon.actors.mobs.Mob;
 
 import com.watabou.pixeldungeon.sprites.RatKingSprite;
 
-public class RatKing extends Mob.NPC {
+public class RatKing extends NPC {
 
 	{
 		name = "rat king";
 		spriteClass = RatKingSprite.class;
 		
-		state = State.SLEEPING;
+		state = SLEEPEING;
 	}
 	
 	@Override
@@ -64,10 +62,10 @@ public class RatKing extends Mob.NPC {
 	@Override
 	public void interact() {
 		sprite.turnTo( pos, Dungeon.hero.pos );
-		if (state == State.SLEEPING) {
+		if (state == SLEEPEING) {
 			notice();
 			yell( "I'm not sleeping!" );
-			state = State.WANDERING;
+			state = WANDERING;
 		} else {
 			yell( "What is it? I have no time for this nonsense. My kingdom won't rule itself!" );
 		}
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Shopkeeper.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Shopkeeper.java
index 363b9b6..684ca39 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Shopkeeper.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Shopkeeper.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -19,7 +18,6 @@ package com.watabou.pixeldungeon.actors.mobs.npcs;
 
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.buffs.Buff;
-import com.watabou.pixeldungeon.actors.mobs.Mob;
 import com.watabou.pixeldungeon.effects.CellEmitter;
 import com.watabou.pixeldungeon.effects.particles.ElmoParticle;
 import com.watabou.pixeldungeon.items.Heap;
@@ -29,7 +27,7 @@ import com.watabou.pixeldungeon.sprites.ShopkeeperSprite;
 import com.watabou.pixeldungeon.windows.WndBag;
 import com.watabou.pixeldungeon.windows.WndTradeItem;
 
-public class Shopkeeper extends Mob.NPC {
+public class Shopkeeper extends NPC {
 
 	{
 		name = "shopkeeper";
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Wandmaker.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Wandmaker.java
index 9a68d05..e27db2c 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Wandmaker.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Wandmaker.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -62,7 +61,7 @@ import com.watabou.pixeldungeon.windows.WndWandmaker;
 import com.watabou.utils.Bundle;
 import com.watabou.utils.Random;
 
-public class Wandmaker extends Mob.NPC {
+public class Wandmaker extends NPC {
 
 	{	
 		name = "old wandmaker";
diff --git a/core/src/com/watabou/pixeldungeon/effects/BadgeBanner.java b/core/src/com/watabou/pixeldungeon/effects/BadgeBanner.java
index 2fc334e..d32d525 100644
--- a/core/src/com/watabou/pixeldungeon/effects/BadgeBanner.java
+++ b/core/src/com/watabou/pixeldungeon/effects/BadgeBanner.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -209,6 +208,9 @@ public class BadgeBanner extends Image {
 		case 38:
 			p.offset( 5, 5 );
 			break;
+		case 39:
+			p.offset( 5, 4 );
+			break;
 		case 40:
 		case 41:
 		case 42:
diff --git a/core/src/com/watabou/pixeldungeon/effects/BannerSprites.java b/core/src/com/watabou/pixeldungeon/effects/BannerSprites.java
index 3d32358..4d0f503 100644
--- a/core/src/com/watabou/pixeldungeon/effects/BannerSprites.java
+++ b/core/src/com/watabou/pixeldungeon/effects/BannerSprites.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -25,7 +24,8 @@ public class BannerSprites {
 	public enum  Type {
 		PIXEL_DUNGEON,
 		BOSS_SLAIN,
-		GAME_OVER
+		GAME_OVER,
+		SELECT_YOUR_HERO
 	};
 	
 	public static Image get( Type type ) {
@@ -40,6 +40,9 @@ public class BannerSprites {
 		case GAME_OVER:
 			icon.frame( icon.texture.uvRect( 0, 105, 128, 140 ) );
 			break;
+		case SELECT_YOUR_HERO:
+			icon.frame( icon.texture.uvRect( 0, 140, 128, 161 ) );
+			break;
 		}
 		return icon;
 	}
diff --git a/core/src/com/watabou/pixeldungeon/effects/BlobEmitter.java b/core/src/com/watabou/pixeldungeon/effects/BlobEmitter.java
index 2e14219..48ccbc2 100644
--- a/core/src/com/watabou/pixeldungeon/effects/BlobEmitter.java
+++ b/core/src/com/watabou/pixeldungeon/effects/BlobEmitter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/CellEmitter.java b/core/src/com/watabou/pixeldungeon/effects/CellEmitter.java
index bb2751e..bdebcb9 100644
--- a/core/src/com/watabou/pixeldungeon/effects/CellEmitter.java
+++ b/core/src/com/watabou/pixeldungeon/effects/CellEmitter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/CheckedCell.java b/core/src/com/watabou/pixeldungeon/effects/CheckedCell.java
index 154000b..cf70dd4 100644
--- a/core/src/com/watabou/pixeldungeon/effects/CheckedCell.java
+++ b/core/src/com/watabou/pixeldungeon/effects/CheckedCell.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/DeathRay.java b/core/src/com/watabou/pixeldungeon/effects/DeathRay.java
index a1b1d4d..cbf65b3 100644
--- a/core/src/com/watabou/pixeldungeon/effects/DeathRay.java
+++ b/core/src/com/watabou/pixeldungeon/effects/DeathRay.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -26,7 +25,7 @@ import com.watabou.pixeldungeon.Assets;
 import com.watabou.utils.PointF;
 
 public class DeathRay extends Image {
-	
+
 	private static final double A = 180 / Math.PI;
 	
 	private static final float DURATION	= 0.5f;
diff --git a/core/src/com/watabou/pixeldungeon/effects/Effects.java b/core/src/com/watabou/pixeldungeon/effects/Effects.java
index 744961c..2c0c742 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Effects.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Effects.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/EmoIcon.java b/core/src/com/watabou/pixeldungeon/effects/EmoIcon.java
index f7601c1..798a491 100644
--- a/core/src/com/watabou/pixeldungeon/effects/EmoIcon.java
+++ b/core/src/com/watabou/pixeldungeon/effects/EmoIcon.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Fireball.java b/core/src/com/watabou/pixeldungeon/effects/Fireball.java
index 96648f1..1756b3e 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Fireball.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Fireball.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Flare.java b/core/src/com/watabou/pixeldungeon/effects/Flare.java
index 8617af6..aeb8cfb 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Flare.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Flare.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -49,6 +48,7 @@ public class Flare extends Visual {
 		
 		super( 0, 0, 0, 0 );
 		
+		// FIXME
 		// Texture is incorrectly created every time we need
 		// to show the effect, it must be refactored
 		
diff --git a/core/src/com/watabou/pixeldungeon/effects/FloatingText.java b/core/src/com/watabou/pixeldungeon/effects/FloatingText.java
index 1654eed..4444b16 100644
--- a/core/src/com/watabou/pixeldungeon/effects/FloatingText.java
+++ b/core/src/com/watabou/pixeldungeon/effects/FloatingText.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Halo.java b/core/src/com/watabou/pixeldungeon/effects/Halo.java
index 20bc803..5e425fc 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Halo.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Halo.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/IceBlock.java b/core/src/com/watabou/pixeldungeon/effects/IceBlock.java
index 24c69b5..b0750f8 100644
--- a/core/src/com/watabou/pixeldungeon/effects/IceBlock.java
+++ b/core/src/com/watabou/pixeldungeon/effects/IceBlock.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Identification.java b/core/src/com/watabou/pixeldungeon/effects/Identification.java
index 44a68d2..1f59aee 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Identification.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Identification.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Lightning.java b/core/src/com/watabou/pixeldungeon/effects/Lightning.java
index 20dd6b8..9e19d3e 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Lightning.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Lightning.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/MagicMissile.java b/core/src/com/watabou/pixeldungeon/effects/MagicMissile.java
index 9e93814..70d0a18 100644
--- a/core/src/com/watabou/pixeldungeon/effects/MagicMissile.java
+++ b/core/src/com/watabou/pixeldungeon/effects/MagicMissile.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Pushing.java b/core/src/com/watabou/pixeldungeon/effects/Pushing.java
index 7dfbb84..9427a5c 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Pushing.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Pushing.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Ripple.java b/core/src/com/watabou/pixeldungeon/effects/Ripple.java
index d45c8df..c25bac0 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Ripple.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Ripple.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Speck.java b/core/src/com/watabou/pixeldungeon/effects/Speck.java
index 86a2dd4..0019cee 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Speck.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Speck.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -55,6 +54,7 @@ public class Speck extends Image {
 	public static final int PARALYSIS	= 108;
 	public static final int DUST		= 109;
 	public static final int FORGE		= 110;
+	public static final int CONFUSION	= 111;
 	
 	private static final int SIZE = 7;
 	
@@ -97,6 +97,7 @@ public class Speck extends Image {
 		case JET:
 		case TOXIC:
 		case PARALYSIS:
+		case CONFUSION:
 		case DUST:
 			frame( film.get( STEAM ) );
 			break;
@@ -270,6 +271,13 @@ public class Speck extends Image {
 			angle = Random.Float( 360 );
 			lifespan = Random.Float( 1f, 3f );
 			break;
+		
+		case CONFUSION:
+			hardlight( Random.Int( 0x1000000 ) | 0x000080 );
+			angularSpeed = Random.Float( -20, +20 );
+			angle = Random.Float( 360 );
+			lifespan = Random.Float( 1f, 3f );
+			break;
 			
 		case DUST:
 			hardlight( 0xFFFF66 );
@@ -377,6 +385,7 @@ public class Speck extends Image {
 			case STEAM:
 			case TOXIC:
 			case PARALYSIS:
+			case CONFUSION:
 			case DUST:
 				am = p < 0.5f ? p : 1 - p;
 				scale.set( 1 + p * 2 );
@@ -397,6 +406,10 @@ public class Speck extends Image {
 	}
 	
 	public static Emitter.Factory factory( final int type ) {
+		return factory( type, false );
+	}
+	
+	public static Emitter.Factory factory( final int type, final boolean lightMode ) {
 		
 		Emitter.Factory factory = factories.get( type );
 		
@@ -407,6 +420,10 @@ public class Speck extends Image {
 					Speck p = (Speck)emitter.recycle( Speck.class );
 					p.reset( index, x, y, type );
 				}
+				@Override
+				public boolean lightMode() {
+					return lightMode;
+				}
 			};
 			factories.put( type, factory );
 		}
diff --git a/core/src/com/watabou/pixeldungeon/effects/SpellSprite.java b/core/src/com/watabou/pixeldungeon/effects/SpellSprite.java
index f27e178..90a7a3a 100644
--- a/core/src/com/watabou/pixeldungeon/effects/SpellSprite.java
+++ b/core/src/com/watabou/pixeldungeon/effects/SpellSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Splash.java b/core/src/com/watabou/pixeldungeon/effects/Splash.java
index cf2d9ea..f22b25a 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Splash.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Splash.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/TorchHalo.java b/core/src/com/watabou/pixeldungeon/effects/TorchHalo.java
index 3f2afd4..12c0c53 100644
--- a/core/src/com/watabou/pixeldungeon/effects/TorchHalo.java
+++ b/core/src/com/watabou/pixeldungeon/effects/TorchHalo.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Wound.java b/core/src/com/watabou/pixeldungeon/effects/Wound.java
index 6e4c603..b0d4820 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Wound.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Wound.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/BloodParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/BloodParticle.java
index 33b91e5..e879eec 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/BloodParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/BloodParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/EarthParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/EarthParticle.java
index 1d1cb4a..72d01c7 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/EarthParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/EarthParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/ElmoParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/ElmoParticle.java
index d87cf01..4bbf5a0 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/ElmoParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/ElmoParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/EnergyParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/EnergyParticle.java
index 31c97d5..fe97daa 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/EnergyParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/EnergyParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/FlameParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/FlameParticle.java
index ae344f5..4ded626 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/FlameParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/FlameParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/FlowParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/FlowParticle.java
index e627800..6b34a23 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/FlowParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/FlowParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/LeafParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/LeafParticle.java
index a0112a4..c8010ac 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/LeafParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/LeafParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/PoisonParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/PoisonParticle.java
index 16554f6..bc3da56 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/PoisonParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/PoisonParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/PurpleParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/PurpleParticle.java
index ca378fe..056ef23 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/PurpleParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/PurpleParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/ShadowParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/ShadowParticle.java
index 0df7264..68ed798 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/ShadowParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/ShadowParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/ShaftParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/ShaftParticle.java
index ba4c276..106bd8d 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/ShaftParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/ShaftParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/SnowParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/SnowParticle.java
index 8b4b809..a55231e 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/SnowParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/SnowParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/SparkParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/SparkParticle.java
index f817e43..cda0685 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/SparkParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/SparkParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/WebParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/WebParticle.java
index 4b9ef61..49dceee 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/WebParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/WebParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/WindParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/WindParticle.java
index 676fd29..ab8433c 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/WindParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/WindParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/WoolParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/WoolParticle.java
index 1361d96..6bd267e 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/WoolParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/WoolParticle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Amulet.java b/core/src/com/watabou/pixeldungeon/items/Amulet.java
index 09be4e4..92e5181 100644
--- a/core/src/com/watabou/pixeldungeon/items/Amulet.java
+++ b/core/src/com/watabou/pixeldungeon/items/Amulet.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -23,7 +22,6 @@ import java.util.ArrayList;
 import com.watabou.noosa.Game;
 import com.watabou.pixeldungeon.Badges;
 import com.watabou.pixeldungeon.Dungeon;
-import com.watabou.pixeldungeon.ResultDescriptions;
 import com.watabou.pixeldungeon.Statistics;
 import com.watabou.pixeldungeon.actors.hero.Hero;
 import com.watabou.pixeldungeon.scenes.AmuletScene;
@@ -66,7 +64,6 @@ public class Amulet extends Item {
 			
 			if (!Statistics.amuletObtained) {
 				Statistics.amuletObtained = true;
-				Dungeon.win( ResultDescriptions.WIN );
 				Badges.validateVictory();
 
 				showAmuletScene( true );
diff --git a/core/src/com/watabou/pixeldungeon/items/Ankh.java b/core/src/com/watabou/pixeldungeon/items/Ankh.java
index d7e94f0..979fa01 100644
--- a/core/src/com/watabou/pixeldungeon/items/Ankh.java
+++ b/core/src/com/watabou/pixeldungeon/items/Ankh.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/ArmorKit.java b/core/src/com/watabou/pixeldungeon/items/ArmorKit.java
index 487de42..84cb16d 100644
--- a/core/src/com/watabou/pixeldungeon/items/ArmorKit.java
+++ b/core/src/com/watabou/pixeldungeon/items/ArmorKit.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/DewVial.java b/core/src/com/watabou/pixeldungeon/items/DewVial.java
index 5776334..912327b 100644
--- a/core/src/com/watabou/pixeldungeon/items/DewVial.java
+++ b/core/src/com/watabou/pixeldungeon/items/DewVial.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Dewdrop.java b/core/src/com/watabou/pixeldungeon/items/Dewdrop.java
index 6bcc6f4..c8f39ec 100644
--- a/core/src/com/watabou/pixeldungeon/items/Dewdrop.java
+++ b/core/src/com/watabou/pixeldungeon/items/Dewdrop.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/EquipableItem.java b/core/src/com/watabou/pixeldungeon/items/EquipableItem.java
index baa71ed..db1df2f 100644
--- a/core/src/com/watabou/pixeldungeon/items/EquipableItem.java
+++ b/core/src/com/watabou/pixeldungeon/items/EquipableItem.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -19,11 +18,15 @@ package com.watabou.pixeldungeon.items;
 
 import com.watabou.noosa.audio.Sample;
 import com.watabou.pixeldungeon.Assets;
+import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.hero.Hero;
 import com.watabou.pixeldungeon.effects.particles.ShadowParticle;
+import com.watabou.pixeldungeon.utils.GLog;
 
 public abstract class EquipableItem extends Item {
 
+	private static final String TXT_UNEQUIP_CURSED	= "You can't remove cursed %s!";
+	
 	public static final String AC_EQUIP		= "EQUIP";
 	public static final String AC_UNEQUIP	= "UNEQUIP";
 	
@@ -40,17 +43,16 @@ public abstract class EquipableItem extends Item {
 	
 	@Override
 	public void doDrop( Hero hero ) {
-		if (!isEquipped( hero ) || doUnequip( hero, false )) {
+		if (!isEquipped( hero ) || doUnequip( hero, false, false )) {
 			super.doDrop( hero );
 		}
 	}
 	
 	@Override
 	public void cast( final Hero user, int dst ) {
-		
+
 		if (isEquipped( user )) {
-			
-			if (quantity == 1 && !this.doUnequip( user, false )) {
+			if (quantity == 1 && !this.doUnequip( user, false, false )) {
 				return;
 			}
 		}
@@ -63,6 +65,33 @@ public abstract class EquipableItem extends Item {
 		Sample.INSTANCE.play( Assets.SND_CURSED );
 	}
 	
+	protected float time2equip( Hero hero ) {
+		return 1;
+	}
+	
 	public abstract boolean doEquip( Hero hero );
-	public abstract boolean doUnequip( Hero hero, boolean collect );
+	
+	public boolean doUnequip( Hero hero, boolean collect, boolean single ) {
+		
+		if (cursed) {
+			GLog.w( TXT_UNEQUIP_CURSED, name() );
+			return false;
+		}
+		
+		if (single) {
+			hero.spendAndNext( time2equip( hero ) );
+		} else {
+			hero.spend( time2equip( hero ) );
+		}
+		
+		if (collect && !collect( hero.belongings.backpack )) {
+			Dungeon.level.drop( this, hero.pos );
+		}
+				
+		return true;
+	}
+	
+	public boolean doUnequip( Hero hero, boolean collect ) {
+		return doUnequip( hero, collect, true );
+	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/items/Generator.java b/core/src/com/watabou/pixeldungeon/items/Generator.java
index 67eb05a..5ed3bda 100644
--- a/core/src/com/watabou/pixeldungeon/items/Generator.java
+++ b/core/src/com/watabou/pixeldungeon/items/Generator.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -181,7 +180,7 @@ public class Generator {
 			Firebloom.Seed.class,
 			Icecap.Seed.class,
 			Sorrowmoss.Seed.class,
-			Blindweed.Seed.class,
+			Dreamweed.Seed.class,
 			Sungrass.Seed.class,
 			Earthroot.Seed.class,
 			Fadeleaf.Seed.class,
diff --git a/core/src/com/watabou/pixeldungeon/items/Gold.java b/core/src/com/watabou/pixeldungeon/items/Gold.java
index 26ea0f8..4102d91 100644
--- a/core/src/com/watabou/pixeldungeon/items/Gold.java
+++ b/core/src/com/watabou/pixeldungeon/items/Gold.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Heap.java b/core/src/com/watabou/pixeldungeon/items/Heap.java
index b18b73f..90749ae 100644
--- a/core/src/com/watabou/pixeldungeon/items/Heap.java
+++ b/core/src/com/watabou/pixeldungeon/items/Heap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -138,8 +137,9 @@ public class Heap implements Bundlable {
 		
 		if (item.stackable) {
 			
+			Class<?> c = item.getClass();
 			for (Item i : items) {
-				if (i.isSimilar( item )) {
+				if (i.getClass() == c) {
 					i.quantity += item.quantity;
 					item = i;
 					break;
diff --git a/core/src/com/watabou/pixeldungeon/items/Item.java b/core/src/com/watabou/pixeldungeon/items/Item.java
index 4c1bc7a..2966005 100644
--- a/core/src/com/watabou/pixeldungeon/items/Item.java
+++ b/core/src/com/watabou/pixeldungeon/items/Item.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -133,7 +132,7 @@ public class Item implements Bundlable {
 	public void execute( Hero hero ) {
 		execute( hero, defaultAction );
 	}
-	
+
 	protected void onThrow( int cell ) {
 		Heap heap = Dungeon.level.drop( this, cell );
 		if (!heap.isEmpty()) {
@@ -156,8 +155,10 @@ public class Item implements Bundlable {
 		}
 		
 		if (stackable) {
+			
+			Class<?>c = getClass();
 			for (Item item:items) {
-				if (isSimilar( item )) {
+				if (item.getClass() == c) {
 					item.quantity += quantity;
 					item.updateQuickslot();
 					return true;
@@ -188,7 +189,7 @@ public class Item implements Bundlable {
 		return collect( Dungeon.hero.belongings.backpack );
 	}
 	
-	public Item detach( Bag container ) {
+	public final Item detach( Bag container ) {
 		
 		if (quantity <= 0) {
 			
@@ -230,8 +231,7 @@ public class Item implements Bundlable {
 		return this;
 	}
 	
-	public boolean isSimilar( Item item ) {
-		return getClass() == item.getClass();
+	protected void onDetach( ) {
 	}
 	
 	public Item upgrade() {
@@ -429,7 +429,7 @@ public class Item implements Bundlable {
 		float delay = TIME_TO_THROW;
 		if (this instanceof MissileWeapon) {
 
-			// Refactoring needed!
+			// FIXME
 			delay *= ((MissileWeapon)this).speedFactor( user );
 			if (enemy != null && enemy.buff( SnipersMark.class ) != null) {
 				delay *= 0.5f;
diff --git a/core/src/com/watabou/pixeldungeon/items/ItemStatusHandler.java b/core/src/com/watabou/pixeldungeon/items/ItemStatusHandler.java
index ca3e41c..62335db 100644
--- a/core/src/com/watabou/pixeldungeon/items/ItemStatusHandler.java
+++ b/core/src/com/watabou/pixeldungeon/items/ItemStatusHandler.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/KindOfWeapon.java b/core/src/com/watabou/pixeldungeon/items/KindOfWeapon.java
index ba651e1..84b2cc0 100644
--- a/core/src/com/watabou/pixeldungeon/items/KindOfWeapon.java
+++ b/core/src/com/watabou/pixeldungeon/items/KindOfWeapon.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -19,7 +18,6 @@ package com.watabou.pixeldungeon.items;
 
 import java.util.ArrayList;
 
-import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.Char;
 import com.watabou.pixeldungeon.actors.hero.Hero;
 import com.watabou.pixeldungeon.ui.QuickSlot;
@@ -29,7 +27,6 @@ import com.watabou.utils.Random;
 public class KindOfWeapon extends EquipableItem {
 
 	private static final String TXT_EQUIP_CURSED	= "you wince as your grip involuntarily tightens around your %s";
-	private static final String TXT_UNEQUIP_CURSED	= "you can't remove cursed %s!";
 	
 	protected static final float TIME_TO_EQUIP = 1f;
 	
@@ -77,21 +74,17 @@ public class KindOfWeapon extends EquipableItem {
 	}
 	
 	@Override
-	public boolean doUnequip( Hero hero, boolean collect ) {
-		
-		if (cursed) {
-			GLog.w( TXT_UNEQUIP_CURSED, name() );
+	public boolean doUnequip( Hero hero, boolean collect, boolean single ) {
+		if (super.doUnequip( hero, collect, single )) {
+			
+			hero.belongings.weapon = null;
+			return true;
+			
+		} else {
+			
 			return false;
+			
 		}
-		
-		hero.belongings.weapon = null;
-		hero.spendAndNext( TIME_TO_EQUIP );
-		
-		if (collect && !collect( hero.belongings.backpack )) {
-			Dungeon.level.drop( this, hero.pos );
-		}
-					
-		return true;
 	}
 	
 	public void activate( Hero hero ) {
diff --git a/core/src/com/watabou/pixeldungeon/items/LloydsBeacon.java b/core/src/com/watabou/pixeldungeon/items/LloydsBeacon.java
index 5be1939..3eaa861 100644
--- a/core/src/com/watabou/pixeldungeon/items/LloydsBeacon.java
+++ b/core/src/com/watabou/pixeldungeon/items/LloydsBeacon.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Stylus.java b/core/src/com/watabou/pixeldungeon/items/Stylus.java
index 2ad363f..708f796 100644
--- a/core/src/com/watabou/pixeldungeon/items/Stylus.java
+++ b/core/src/com/watabou/pixeldungeon/items/Stylus.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/TomeOfMastery.java b/core/src/com/watabou/pixeldungeon/items/TomeOfMastery.java
index 6b27c0b..76c2724 100644
--- a/core/src/com/watabou/pixeldungeon/items/TomeOfMastery.java
+++ b/core/src/com/watabou/pixeldungeon/items/TomeOfMastery.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Torch.java b/core/src/com/watabou/pixeldungeon/items/Torch.java
index d4b2104..0810982 100644
--- a/core/src/com/watabou/pixeldungeon/items/Torch.java
+++ b/core/src/com/watabou/pixeldungeon/items/Torch.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Weightstone.java b/core/src/com/watabou/pixeldungeon/items/Weightstone.java
new file mode 100644
index 0000000..c20b687
--- /dev/null
+++ b/core/src/com/watabou/pixeldungeon/items/Weightstone.java
@@ -0,0 +1,194 @@
+/*
+ * Copyright (C) 2012-2014  Oleg Dolya
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>
+ */
+package com.watabou.pixeldungeon.items;
+
+import java.util.ArrayList;
+
+import com.watabou.noosa.BitmapTextMultiline;
+import com.watabou.noosa.audio.Sample;
+import com.watabou.pixeldungeon.Assets;
+import com.watabou.pixeldungeon.actors.hero.Hero;
+import com.watabou.pixeldungeon.items.weapon.Weapon;
+import com.watabou.pixeldungeon.scenes.GameScene;
+import com.watabou.pixeldungeon.scenes.PixelScene;
+import com.watabou.pixeldungeon.sprites.ItemSpriteSheet;
+import com.watabou.pixeldungeon.ui.RedButton;
+import com.watabou.pixeldungeon.ui.Window;
+import com.watabou.pixeldungeon.utils.GLog;
+import com.watabou.pixeldungeon.utils.Utils;
+import com.watabou.pixeldungeon.windows.IconTitle;
+import com.watabou.pixeldungeon.windows.WndBag;
+
+public class Weightstone extends Item {
+	
+	private static final String TXT_SELECT_WEAPON	= "Select a weapon to balance";
+	private static final String TXT_FAST			= "you balanced your %s to make it faster";
+	private static final String TXT_ACCURATE		= "you balanced your %s to make it more accurate";
+	
+	private static final float TIME_TO_APPLY = 2;
+	
+	private static final String AC_APPLY = "APPLY";
+	
+	{
+		name = "weightstone";
+		image = ItemSpriteSheet.WEIGHT;
+		
+		stackable = true;
+	}
+	
+	@Override
+	public ArrayList<String> actions( Hero hero ) {
+		ArrayList<String> actions = super.actions( hero );
+		actions.add( AC_APPLY );
+		return actions;
+	}
+	
+	@Override
+	public void execute( Hero hero, String action ) {
+		if (action == AC_APPLY) {
+
+			curUser = hero;
+			GameScene.selectItem( itemSelector, WndBag.Mode.WEAPON, TXT_SELECT_WEAPON );
+			
+		} else {
+			
+			super.execute( hero, action );
+			
+		}
+	}
+	
+	@Override
+	public boolean isUpgradable() {
+		return false;
+	}
+	
+	@Override
+	public boolean isIdentified() {
+		return true;
+	}
+	
+	private void apply( Weapon weapon, boolean forSpeed ) {
+		
+		detach( curUser.belongings.backpack );
+		
+		if (forSpeed) {
+			weapon.imbue = Weapon.Imbue.SPEED;
+			GLog.p( TXT_FAST, weapon.name() );
+		} else {
+			weapon.imbue = Weapon.Imbue.ACCURACY;
+			GLog.p( TXT_ACCURATE, weapon.name() );
+		}
+		
+		curUser.sprite.operate( curUser.pos );
+		Sample.INSTANCE.play( Assets.SND_MISS );
+		
+		curUser.spend( TIME_TO_APPLY );
+		curUser.busy();
+	}
+	
+	@Override
+	public int price() {
+		return 40 * quantity;
+	}
+	
+	@Override
+	public String info() {
+		return
+			"Using a weightstone, you can balance your melee weapon to increase its speed or accuracy.";
+	}
+	
+	private final WndBag.Listener itemSelector = new WndBag.Listener() {
+		@Override
+		public void onSelect( Item item ) {
+			if (item != null) {
+				GameScene.show( new WndBalance( (Weapon)item ) );
+			}
+		}
+	};
+	
+	public class WndBalance extends Window {
+
+		private static final String TXT_CHOICE = "How would you like to balance your %s?";
+		
+		private static final String TXT_SPEED		= "For speed";
+		private static final String TXT_ACCURACY	= "For accuracy";
+		private static final String TXT_CANCEL		= "Never mind";
+		
+		private static final int WIDTH			= 120;
+		private static final int MARGIN 		= 2;
+		private static final int BUTTON_WIDTH	= WIDTH - MARGIN * 2;
+		private static final int BUTTON_HEIGHT	= 20;
+		
+		public WndBalance( final Weapon weapon ) {
+			super();
+			
+			IconTitle titlebar = new IconTitle( weapon );
+			titlebar.setRect( 0, 0, WIDTH, 0 );
+			add( titlebar );
+			
+			BitmapTextMultiline tfMesage = PixelScene.createMultiline( Utils.format( TXT_CHOICE, weapon.name() ), 8 );
+			tfMesage.maxWidth = WIDTH - MARGIN * 2;
+			tfMesage.measure();
+			tfMesage.x = MARGIN;
+			tfMesage.y = titlebar.bottom() + MARGIN;
+			add( tfMesage );
+			
+			float pos = tfMesage.y + tfMesage.height();
+			
+			if (weapon.imbue != Weapon.Imbue.SPEED) {
+				RedButton btnSpeed = new RedButton( TXT_SPEED ) {
+					@Override
+					protected void onClick() {
+						hide();
+						Weightstone.this.apply( weapon, true );
+					}
+				};
+				btnSpeed.setRect( MARGIN, pos + MARGIN, BUTTON_WIDTH, BUTTON_HEIGHT );
+				add( btnSpeed );
+				
+				pos = btnSpeed.bottom();
+			}
+			
+			if (weapon.imbue != Weapon.Imbue.ACCURACY) {
+				RedButton btnAccuracy = new RedButton( TXT_ACCURACY ) {
+					@Override
+					protected void onClick() {
+						hide();
+						Weightstone.this.apply( weapon, false );
+					}
+				};
+				btnAccuracy.setRect( MARGIN, pos + MARGIN, BUTTON_WIDTH, BUTTON_HEIGHT );
+				add( btnAccuracy );
+				
+				pos = btnAccuracy.bottom();
+			}
+			
+			RedButton btnCancel = new RedButton( TXT_CANCEL ) {
+				@Override
+				protected void onClick() {
+					hide();
+				}
+			};
+			btnCancel.setRect( MARGIN, pos + MARGIN, BUTTON_WIDTH, BUTTON_HEIGHT );
+			add( btnCancel );
+			
+			resize( WIDTH, (int)btnCancel.bottom() + MARGIN );
+		}
+		
+		protected void onSelect( int index ) {};
+	}
+}
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/Armor.java b/core/src/com/watabou/pixeldungeon/items/armor/Armor.java
index 2bebad2..26a98a9 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/Armor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/Armor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -37,7 +36,6 @@ import com.watabou.utils.Random;
 public class Armor extends EquipableItem {
 	
 	private static final String TXT_EQUIP_CURSED	= "your %s constricts around you painfully";
-	private static final String TXT_UNEQUIP_CURSED	= "You can't remove cursed %s!";
 		
 	private static final String TXT_IDENTIFY	= "you are now familiar enough with your %s to identify it. It is %s.";
 	
@@ -89,7 +87,7 @@ public class Armor extends EquipableItem {
 		
 		detach( hero.belongings.backpack );
 		
-		if (hero.belongings.armor == null || hero.belongings.armor.doUnequip( hero, true )) {
+		if (hero.belongings.armor == null || hero.belongings.armor.doUnequip( hero, true, false )) {
 			
 			hero.belongings.armor = this;
 			
@@ -101,7 +99,7 @@ public class Armor extends EquipableItem {
 			
 			((HeroSprite)hero.sprite).updateArmor();
 			
-			hero.spendAndNext( 2 * hero.speed() );
+			hero.spendAndNext( 2 * time2equip( hero ) );
 			return true;
 			
 		} else {
@@ -113,25 +111,23 @@ public class Armor extends EquipableItem {
 	}
 	
 	@Override
-	public boolean doUnequip( Hero hero, boolean collect ) {
-		if (cursed) {
-			
-			GLog.w( TXT_UNEQUIP_CURSED, name() );
-			return false;
+	protected float time2equip( Hero hero ) {
+		return hero.speed();
+	}
+	
+	@Override
+	public boolean doUnequip( Hero hero, boolean collect, boolean single ) {
+		if (super.doUnequip( hero, collect, single )) {
 			
-		} else {
-		
 			hero.belongings.armor = null;
-			hero.spendAndNext( hero.speed() );
-			
 			((HeroSprite)hero.sprite).updateArmor();
 			
-			if (collect && !collect( hero.belongings.backpack )) {
-				Dungeon.level.drop( this, hero.pos );
-			}
-			
 			return true;
 			
+		} else {
+			
+			return false;
+			
 		}
 	}
 	
@@ -307,7 +303,15 @@ public class Armor extends EquipableItem {
 	}
 	
 	public Armor inscribe( Glyph glyph ) {
+		
+		if (glyph != null && this.glyph == null) {
+			DR += tier;
+		} else if (glyph == null && this.glyph != null) {
+			DR -= tier;
+		}
+		
 		this.glyph = glyph;
+		
 		return this;
 	}
 	
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/ClassArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/ClassArmor.java
index 0baebc8..6932f1f 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/ClassArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/ClassArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -85,7 +84,7 @@ abstract public class ClassArmor extends Armor {
 	@Override
 	public ArrayList<String> actions( Hero hero ) {
 		ArrayList<String> actions = super.actions( hero );
-		if (hero.HP >= 2 && isEquipped( hero )) {
+		if (hero.HP >= 3 && isEquipped( hero )) {
 			actions.add( special() );
 		}
 		return actions;
@@ -95,7 +94,7 @@ abstract public class ClassArmor extends Armor {
 	public void execute( Hero hero, String action ) {
 		if (action == special()) {
 			
-			if (hero.HP < 2) {
+			if (hero.HP < 3) {
 				GLog.w( TXT_LOW_HEALTH );
 			} else if (!isEquipped( hero )) {
 				GLog.w( TXT_NOT_EQUIPPED );
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/ClothArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/ClothArmor.java
index 182bb0d..8b5da95 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/ClothArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/ClothArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/HuntressArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/HuntressArmor.java
index 7135d7e..37a4149 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/HuntressArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/HuntressArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -81,7 +80,7 @@ public class HuntressArmor extends ClassArmor {
 			return;
 		}
 		
-		curUser.HP /= 2;
+		curUser.HP -= (curUser.HP / 3);
 		
 		curUser.sprite.zap( curUser.pos );
 		curUser.busy();
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/LeatherArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/LeatherArmor.java
index e4e5343..0f61e86 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/LeatherArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/LeatherArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/MageArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/MageArmor.java
index cadc05b..e7bb8ff 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/MageArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/MageArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -57,7 +56,7 @@ public class MageArmor extends ClassArmor {
 	
 	@Override
 	public void doSpecial() {	
-		
+
 		for (Mob mob : Dungeon.level.mobs) {
 			if (Level.fieldOfView[mob.pos]) {
 				Buff.affect( mob, Burning.class ).reignite( mob );
@@ -65,7 +64,7 @@ public class MageArmor extends ClassArmor {
 			}
 		}
 		
-		curUser.HP /= 2;
+		curUser.HP -= (curUser.HP / 3);
 		
 		curUser.spend( Actor.TICK );
 		curUser.sprite.operate( curUser.pos );
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/MailArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/MailArmor.java
index 1039c5f..ec8362e 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/MailArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/MailArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/PlateArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/PlateArmor.java
index c69822b..1a26bdd 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/PlateArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/PlateArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/RogueArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/RogueArmor.java
index fe75a1e..236d326 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/RogueArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/RogueArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -26,7 +25,6 @@ import com.watabou.pixeldungeon.actors.buffs.Buff;
 import com.watabou.pixeldungeon.actors.hero.Hero;
 import com.watabou.pixeldungeon.actors.hero.HeroClass;
 import com.watabou.pixeldungeon.actors.mobs.Mob;
-import com.watabou.pixeldungeon.actors.mobs.Mob.State;
 import com.watabou.pixeldungeon.effects.CellEmitter;
 import com.watabou.pixeldungeon.effects.Speck;
 import com.watabou.pixeldungeon.items.wands.WandOfBlink;
@@ -89,12 +87,12 @@ public class RogueArmor extends ClassArmor {
 					return;
 				}
 				
-				curUser.HP /= 2;
+				curUser.HP -= (curUser.HP / 3);
 				
 				for (Mob mob : Dungeon.level.mobs) {
 					if (Level.fieldOfView[mob.pos]) {
 						Buff.prolong( mob, Blindness.class, 2 );
-						mob.state = State.WANDERING;
+						mob.state = mob.WANDERING;
 						mob.sprite.emitter().burst( Speck.factory( Speck.LIGHT ), 4 );
 					}
 				}
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/ScaleArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/ScaleArmor.java
index 5d46e31..990606f 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/ScaleArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/ScaleArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/WarriorArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/WarriorArmor.java
index 8988a8d..7f26432 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/WarriorArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/WarriorArmor.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -18,7 +17,6 @@
 package com.watabou.pixeldungeon.items.armor;
 
 import com.watabou.noosa.Camera;
-import com.watabou.noosa.tweeners.PosTweener;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.Actor;
 import com.watabou.pixeldungeon.actors.Char;
@@ -35,9 +33,10 @@ import com.watabou.pixeldungeon.levels.Level;
 import com.watabou.pixeldungeon.mechanics.Ballistica;
 import com.watabou.pixeldungeon.scenes.CellSelector;
 import com.watabou.pixeldungeon.scenes.GameScene;
+import com.watabou.pixeldungeon.sprites.HeroSprite;
 import com.watabou.pixeldungeon.sprites.ItemSpriteSheet;
 import com.watabou.pixeldungeon.utils.GLog;
-import com.watabou.utils.PointF;
+import com.watabou.utils.Callback;
 
 public class WarriorArmor extends ClassArmor {
 	
@@ -91,33 +90,35 @@ public class WarriorArmor extends ClassArmor {
 					cell = Ballistica.trace[Ballistica.distance - 2];
 				}
 				
-				curUser.HP /= 2;
+				curUser.HP -= (curUser.HP / 3);
 				if (curUser.subClass == HeroSubClass.BERSERKER && curUser.HP <= curUser.HT * Fury.LEVEL) {
 					Buff.affect( curUser, Fury.class );
 				}
 				
 				Invisibility.dispel();
 				
-				curUser.move( cell );
-				curUser.sprite.place( cell );
-				Dungeon.level.press( target, curUser );
-				Dungeon.observe();
-				
-				for (int i=0; i < Level.NEIGHBOURS8.length; i++) {
-					Char mob = Actor.findChar( curUser.pos + Level.NEIGHBOURS8[i] );
-					if (mob != null && mob != curUser) {
-						Buff.prolong( mob, Paralysis.class, SHOCK_TIME );
+				final int dest = cell;
+				curUser.busy();
+				((HeroSprite)curUser.sprite).jump( curUser.pos, cell, new Callback() {
+					@Override
+					public void call() {
+						curUser.move( dest );
+						Dungeon.level.press( dest, curUser );
+						Dungeon.observe();
+						
+						for (int i=0; i < Level.NEIGHBOURS8.length; i++) {
+							Char mob = Actor.findChar( curUser.pos + Level.NEIGHBOURS8[i] );
+							if (mob != null && mob != curUser) {
+								Buff.prolong( mob, Paralysis.class, SHOCK_TIME );
+							}
+						}
+						
+						CellEmitter.center( dest ).burst( Speck.factory( Speck.DUST ), 10 );
+						Camera.main.shake( 2, 0.5f );
+						
+						curUser.spendAndNext( LEAP_TIME );
 					}
-				}
-				
-				PointF pos = curUser.sprite.point();
-				Camera.main.target = null;
-				curUser.sprite.y -= 16;
-				curUser.sprite.parent.add( new PosTweener( curUser.sprite, pos, 0.1f ) );
-				
-				CellEmitter.center( cell ).burst( Speck.factory( Speck.DUST ), 10 );
-				
-				curUser.spendAndNext( LEAP_TIME );
+				} );
 			}
 		}
 		
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Affection.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Affection.java
index 7e62d96..ee26f0d 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Affection.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Affection.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/AntiEntropy.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/AntiEntropy.java
index 86a4283..aa6b84f 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/AntiEntropy.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/AntiEntropy.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java
index 61d8c25..b48ce2f 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Displacement.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Displacement.java
index 6174244..fa0f50f 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Displacement.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Displacement.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Entanglement.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Entanglement.java
index e41652b..3eb6d0d 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Entanglement.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Entanglement.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Metabolism.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Metabolism.java
index 7555f23..d80c6b6 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Metabolism.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Metabolism.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -45,9 +44,9 @@ public class Metabolism extends Glyph {
 			if (healing > 0) {
 				
 				Hunger hunger = defender.buff( Hunger.class );
-				
+
 				if (hunger != null && !hunger.isStarving()) {
-					
+
 					hunger.satisfy( -Hunger.STARVING / 10 );
 					BuffIndicator.refreshHero();
 					
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Multiplicity.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Multiplicity.java
index 9ce857f..cabc91c 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Multiplicity.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Multiplicity.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Potential.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Potential.java
index 331cfb5..7f6bd37 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Potential.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Potential.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Stench.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Stench.java
index af2e29a..512defe 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Stench.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Stench.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Viscosity.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Viscosity.java
index ae8253d..0bac8a7 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Viscosity.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Viscosity.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -125,7 +124,7 @@ public class Viscosity extends Glyph {
 				
 				target.damage( 1, this );
 				if (target == Dungeon.hero && !target.isAlive()) {
-					// Refactoring needed!
+					// FIXME
 					Glyph glyph = new Viscosity();
 					Dungeon.fail( Utils.format( ResultDescriptions.GLYPH, glyph.name(), Dungeon.depth ) );
 					GLog.n( "%s killed you...", glyph.name() );
diff --git a/core/src/com/watabou/pixeldungeon/items/bags/Bag.java b/core/src/com/watabou/pixeldungeon/items/bags/Bag.java
index fcd2d2e..b3ebf6f 100644
--- a/core/src/com/watabou/pixeldungeon/items/bags/Bag.java
+++ b/core/src/com/watabou/pixeldungeon/items/bags/Bag.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -86,9 +85,8 @@ public class Bag extends Item implements Iterable<Item> {
 	}
 	
 	@Override
-	public Item detach( Bag container ) {
-		owner = null;
-		return super.detach( container );
+	public void onDetach( ) {
+		this.owner = null;
 	}
 	
 	@Override
diff --git a/core/src/com/watabou/pixeldungeon/items/bags/ScrollHolder.java b/core/src/com/watabou/pixeldungeon/items/bags/ScrollHolder.java
index 0bef891..191fd2d 100644
--- a/core/src/com/watabou/pixeldungeon/items/bags/ScrollHolder.java
+++ b/core/src/com/watabou/pixeldungeon/items/bags/ScrollHolder.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/bags/SeedPouch.java b/core/src/com/watabou/pixeldungeon/items/bags/SeedPouch.java
index b3515d3..46f74f9 100644
--- a/core/src/com/watabou/pixeldungeon/items/bags/SeedPouch.java
+++ b/core/src/com/watabou/pixeldungeon/items/bags/SeedPouch.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/bags/WandHolster.java b/core/src/com/watabou/pixeldungeon/items/bags/WandHolster.java
index eec81b4..3b6e221 100644
--- a/core/src/com/watabou/pixeldungeon/items/bags/WandHolster.java
+++ b/core/src/com/watabou/pixeldungeon/items/bags/WandHolster.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -50,13 +49,10 @@ public class WandHolster extends Bag {
 	}
 	
 	@Override
-	public Item detach( Bag container ) {
-		
+	public void onDetach( ) {
 		for (Item item : items) {
 			((Wand)item).stopCharging();
 		}
-		
-		return super.detach( container );
 	}
 	
 	@Override
diff --git a/core/src/com/watabou/pixeldungeon/items/food/ChargrilledMeat.java b/core/src/com/watabou/pixeldungeon/items/food/ChargrilledMeat.java
index 67ffbde..7cf64dd 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/ChargrilledMeat.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/ChargrilledMeat.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/Food.java b/core/src/com/watabou/pixeldungeon/items/food/Food.java
index 00e7fbf..a69dafd 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/Food.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/Food.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/FrozenCarpaccio.java b/core/src/com/watabou/pixeldungeon/items/food/FrozenCarpaccio.java
index a280076..2170ce0 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/FrozenCarpaccio.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/FrozenCarpaccio.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/MysteryMeat.java b/core/src/com/watabou/pixeldungeon/items/food/MysteryMeat.java
index 56ebf3d..3528e51 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/MysteryMeat.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/MysteryMeat.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -56,7 +55,7 @@ public class MysteryMeat extends Food {
 				break;
 			case 2:
 				GLog.w( "You are not feeling well." );
-				Buff.affect( hero, Poison.class ).set( Poison.durationFactor( hero ) * hero.HT / 2 / Poison.DOT );
+				Buff.affect( hero, Poison.class ).set( Poison.durationFactor( hero ) * hero.HT / 5 );
 				break;
 			case 3:
 				GLog.w( "You are stuffed." );
diff --git a/core/src/com/watabou/pixeldungeon/items/food/OverpricedRation.java b/core/src/com/watabou/pixeldungeon/items/food/OverpricedRation.java
index 4e33d64..a7783dd 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/OverpricedRation.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/OverpricedRation.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/Pasty.java b/core/src/com/watabou/pixeldungeon/items/food/Pasty.java
index af0706d..3f94291 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/Pasty.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/Pasty.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/keys/GoldenKey.java b/core/src/com/watabou/pixeldungeon/items/keys/GoldenKey.java
index 3a8f4fa..829ac40 100644
--- a/core/src/com/watabou/pixeldungeon/items/keys/GoldenKey.java
+++ b/core/src/com/watabou/pixeldungeon/items/keys/GoldenKey.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -26,15 +25,6 @@ public class GoldenKey extends Key {
 		image = ItemSpriteSheet.GOLDEN_KEY;
 	}
 	
-	public GoldenKey() {
-		this( 0 );
-	}
-	
-	public GoldenKey( int depth ) {
-		super();
-		this.depth = depth;
-	}
-	
 	@Override
 	public String info() {
 		return 
diff --git a/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java b/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java
index ccf3314..4ceca08 100644
--- a/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java
+++ b/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -18,7 +17,6 @@
 package com.watabou.pixeldungeon.items.keys;
 
 import com.watabou.pixeldungeon.Dungeon;
-import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.bags.Bag;
 import com.watabou.pixeldungeon.sprites.ItemSpriteSheet;
 import com.watabou.pixeldungeon.utils.Utils;
@@ -27,22 +25,13 @@ public class IronKey extends Key {
 
 	private static final String TXT_FROM_DEPTH = "iron key from depth %d";
 
-	public static int curDepthQunatity = 0;
+	public static int curDethQuantity = 0;
 	
 	{
 		name = "iron key";
 		image = ItemSpriteSheet.IRON_KEY;
 	}
 	
-	public IronKey() {
-		this( 0 );
-	}
-	
-	public IronKey( int depth ) {
-		super();
-		this.depth = depth;
-	}
-	
 	@Override
 	public boolean collect( Bag bag ) {
 		boolean result = super.collect( bag );
@@ -53,12 +42,10 @@ public class IronKey extends Key {
 	}
 	
 	@Override
-	public Item detach( Bag  bag ) {
-		Item result = super.detach( bag );
-		if (result != null && depth == Dungeon.depth) {
+	public void onDetach( ) {
+		if (depth == Dungeon.depth) {
 			Dungeon.hero.belongings.countIronKeys();
 		}
-		return result;
 	}
 	
 	@Override
diff --git a/core/src/com/watabou/pixeldungeon/items/keys/Key.java b/core/src/com/watabou/pixeldungeon/items/keys/Key.java
index c1fba7c..f47fe07 100644
--- a/core/src/com/watabou/pixeldungeon/items/keys/Key.java
+++ b/core/src/com/watabou/pixeldungeon/items/keys/Key.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,8 +16,8 @@
  */
 package com.watabou.pixeldungeon.items.keys;
 
+import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.items.Item;
-import com.watabou.pixeldungeon.items.bags.Bag;
 import com.watabou.utils.Bundle;
 
 public class Key extends Item {
@@ -26,21 +25,14 @@ public class Key extends Item {
 	public static final float TIME_TO_UNLOCK = 1f;
 	
 	{
-		stackable = true;
+		stackable = false;
 	}
 	
 	public int depth;
 	
-	@Override
-	public boolean isSimilar( Item item ) {
-		return item.getClass() == getClass() && ((Key)item).depth == depth;
-	}
-	
-	@Override
-	public Item detach( Bag container ) {
-		Key key = (Key)super.detach( container );
-		key.depth = depth;
-		return key;
+	public Key() {
+		super();
+		depth = Dungeon.depth;
 	}
 	
 	private static final String DEPTH = "depth";
@@ -66,4 +58,9 @@ public class Key extends Item {
 	public boolean isIdentified() {
 		return true;
 	}
+	
+	@Override
+	public String status() {
+		return depth + "*";
+	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/items/keys/SkeletonKey.java b/core/src/com/watabou/pixeldungeon/items/keys/SkeletonKey.java
index 95131e4..ff3af47 100644
--- a/core/src/com/watabou/pixeldungeon/items/keys/SkeletonKey.java
+++ b/core/src/com/watabou/pixeldungeon/items/keys/SkeletonKey.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,6 @@
  */
 package com.watabou.pixeldungeon.items.keys;
 
-import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.sprites.ItemSpriteSheet;
 
 public class SkeletonKey extends Key {
@@ -25,26 +23,12 @@ public class SkeletonKey extends Key {
 	{
 		name = "skeleton key";
 		image = ItemSpriteSheet.SKELETON_KEY;
-		stackable = false;
-	}
-	
-	public SkeletonKey() {
-		this( 0 );
-	}
-	
-	public SkeletonKey( int depth ) {
-		super();
-		this.depth = depth;
-	}
-	
-	@Override
-	public boolean isSimilar( Item item ) {
-		return false;
 	}
 	
 	@Override
 	public String info() {
 		return 
-			"This key looks serious: its head is shaped like a skull. Probably it can open some serious door.";
+			"This key looks serious: its head is shaped like a skull. " +
+			"Probably it can open some serious door.";
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/Potion.java b/core/src/com/watabou/pixeldungeon/items/potions/Potion.java
index 07ed50a..1b0f0d4 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/Potion.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/Potion.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfExperience.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfExperience.java
index 2288619..a52aa08 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfExperience.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfExperience.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfFrost.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfFrost.java
index 408b918..d8fd362 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfFrost.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfFrost.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfHealing.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfHealing.java
index aa2e46a..76992a1 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfHealing.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfHealing.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfInvisibility.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfInvisibility.java
index 5cd804f..f3483cd 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfInvisibility.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfInvisibility.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLevitation.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLevitation.java
index cc5e9d7..8386c32 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLevitation.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLevitation.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLiquidFlame.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLiquidFlame.java
index f728124..6da7a93 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLiquidFlame.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLiquidFlame.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMight.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMight.java
index d560a55..ef12f97 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMight.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMight.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMindVision.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMindVision.java
index 7b155bb..8fd3886 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMindVision.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMindVision.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfParalyticGas.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfParalyticGas.java
index 7678bd2..1b4447c 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfParalyticGas.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfParalyticGas.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfPurity.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfPurity.java
index d0e04ff..04f7515 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfPurity.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfPurity.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfStrength.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfStrength.java
index 1e0b072..3b3734e 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfStrength.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfStrength.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfToxicGas.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfToxicGas.java
index be8a32c..60ba8e7 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfToxicGas.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfToxicGas.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/CorpseDust.java b/core/src/com/watabou/pixeldungeon/items/quest/CorpseDust.java
index be30f17..38bb7b9 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/CorpseDust.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/CorpseDust.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/DarkGold.java b/core/src/com/watabou/pixeldungeon/items/quest/DarkGold.java
index ef94c85..7206ade 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/DarkGold.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/DarkGold.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/DriedRose.java b/core/src/com/watabou/pixeldungeon/items/quest/DriedRose.java
index be751a5..651ca00 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/DriedRose.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/DriedRose.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/DwarfToken.java b/core/src/com/watabou/pixeldungeon/items/quest/DwarfToken.java
index 3ab8873..69a8929 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/DwarfToken.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/DwarfToken.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/Pickaxe.java b/core/src/com/watabou/pixeldungeon/items/quest/Pickaxe.java
index 03caf59..f6db373 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/Pickaxe.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/Pickaxe.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/RatSkull.java b/core/src/com/watabou/pixeldungeon/items/quest/RatSkull.java
index 612e0af..c581689 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/RatSkull.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/RatSkull.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/Ring.java b/core/src/com/watabou/pixeldungeon/items/rings/Ring.java
index 3f54863..fbdc707 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/Ring.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/Ring.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -146,31 +145,27 @@ public class Ring extends EquipableItem {
 		buff = buff();
 		buff.attachTo( ch );
 	}
-	
+
 	@Override
-	public boolean doUnequip( Hero hero, boolean collect ) {
-		
-		if (cursed) {
-			GLog.w( "You can't remove cursed " + name() + "!" );
-			return false;
-		}
-		
-		if (hero.belongings.ring1 == this) {
-			hero.belongings.ring1 = null;
+	public boolean doUnequip( Hero hero, boolean collect, boolean single ) {
+		if (super.doUnequip( hero, collect, single )) {
+			
+			if (hero.belongings.ring1 == this) {
+				hero.belongings.ring1 = null;
+			} else {
+				hero.belongings.ring2 = null;
+			}
+			
+			hero.remove( buff );
+			buff = null;
+			
+			return true;
+			
 		} else {
-			hero.belongings.ring2 = null;
-		}
-		
-		hero.remove( buff );
-		buff = null;
-		
-		hero.spendAndNext( TIME_TO_EQUIP );
-		
-		if (collect && !collect( hero.belongings.backpack )) {
-			Dungeon.level.drop( this, hero.pos );
+			
+			return false;
+			
 		}
-				
-		return true;
 	}
 	
 	@Override
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfAccuracy.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfAccuracy.java
index 1fd4799..0f3bbc9 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfAccuracy.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfAccuracy.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfDetection.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfDetection.java
index 6f54dfa..080c623 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfDetection.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfDetection.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfElements.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfElements.java
index bfc8ab1..0a962f7 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfElements.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfElements.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfEvasion.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfEvasion.java
index bcdadbc..835d4db 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfEvasion.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfEvasion.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaggler.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaggler.java
index 704641f..2ccad74 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaggler.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaggler.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaste.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaste.java
index 26c9afb..461f1c6 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaste.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaste.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHerbalism.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHerbalism.java
index 4ed07ec..d9ac8d3 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHerbalism.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHerbalism.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfMending.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfMending.java
index f1a3490..2c6eaba 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfMending.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfMending.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfPower.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfPower.java
index 372a300..0b7166b 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfPower.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfPower.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfSatiety.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfSatiety.java
index c2adb20..5b20202 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfSatiety.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfSatiety.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfShadows.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfShadows.java
index 999f829..1e9ab28 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfShadows.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfShadows.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfThorns.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfThorns.java
index 43bd431..1d4046e 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfThorns.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfThorns.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/InventoryScroll.java b/core/src/com/watabou/pixeldungeon/items/scrolls/InventoryScroll.java
index ec217e1..d4dc4ba 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/InventoryScroll.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/InventoryScroll.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -30,9 +29,7 @@ public abstract class InventoryScroll extends Scroll {
 	protected String inventoryTitle = "Select an item";
 	protected WndBag.Mode mode = WndBag.Mode.ALL;
 	
-	private static final String TXT_WARNING	= 
-		"Do you really want to cancel this scroll usage? " +
-		"It will be consumed anyway.";
+	private static final String TXT_WARNING	= "Do you really want to cancel this scroll usage? It will be consumed anyway.";
 	private static final String TXT_YES		= "Yes, I'm positive";
 	private static final String TXT_NO		= "No, I changed my mind";
 	
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/Scroll.java b/core/src/com/watabou/pixeldungeon/items/scrolls/Scroll.java
index 711dac2..c28aef8 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/Scroll.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/Scroll.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfChallenge.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfChallenge.java
index b15446e..ff5445e 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfChallenge.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfChallenge.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfIdentify.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfIdentify.java
index b4c8929..46641b2 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfIdentify.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfIdentify.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfLullaby.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfLullaby.java
index 439fd4d..477f310 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfLullaby.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfLullaby.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMagicMapping.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMagicMapping.java
index 5401396..ea5bb5c 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMagicMapping.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMagicMapping.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMirrorImage.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMirrorImage.java
index 7048b5a..070d7ab 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMirrorImage.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMirrorImage.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfPsionicBlast.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfPsionicBlast.java
index 82c50cd..324dc56 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfPsionicBlast.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfPsionicBlast.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRecharging.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRecharging.java
index c20ca6e..5de40ed 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRecharging.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRecharging.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRemoveCurse.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRemoveCurse.java
index 93cdd93..6ff4d12 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRemoveCurse.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRemoveCurse.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTeleportation.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTeleportation.java
index a0e7df6..f1d2ce5 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTeleportation.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTeleportation.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTerror.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTerror.java
index 71c1b78..c982e72 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTerror.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTerror.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfUpgrade.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfUpgrade.java
index ae6bf80..652f985 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfUpgrade.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfUpgrade.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfWeaponUpgrade.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfWeaponUpgrade.java
index 2666c1f..cb818e6 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfWeaponUpgrade.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfWeaponUpgrade.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/Wand.java b/core/src/com/watabou/pixeldungeon/items/wands/Wand.java
index 4dbb291..390f04b 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/Wand.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/Wand.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -147,8 +146,8 @@ public abstract class Wand extends KindOfWeapon {
 	
 	@Override
 	public boolean doUnequip( Hero hero, boolean collect ) {
-		charger.detach();
-		return super.doUnequip(hero, collect);
+		onDetach();
+		return super.doUnequip( hero, collect );
 	}
 	
 	@Override
@@ -190,9 +189,8 @@ public abstract class Wand extends KindOfWeapon {
 	}
 	
 	@Override
-	public Item detach( Bag container ) {
+	public void onDetach( ) {
 		stopCharging();
-		return super.detach( container );
 	}
 	
 	public void stopCharging() {
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfAmok.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfAmok.java
index b77f27c..907f592 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfAmok.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfAmok.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -19,10 +18,12 @@ package com.watabou.pixeldungeon.items.wands;
 
 import com.watabou.noosa.audio.Sample;
 import com.watabou.pixeldungeon.Assets;
+import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.Actor;
 import com.watabou.pixeldungeon.actors.Char;
 import com.watabou.pixeldungeon.actors.buffs.Amok;
 import com.watabou.pixeldungeon.actors.buffs.Buff;
+import com.watabou.pixeldungeon.actors.buffs.Vertigo;
 import com.watabou.pixeldungeon.effects.MagicMissile;
 import com.watabou.pixeldungeon.utils.GLog;
 import com.watabou.utils.Callback;
@@ -38,7 +39,11 @@ public class WandOfAmok extends Wand {
 		Char ch = Actor.findChar( cell );
 		if (ch != null) {
 			
-			Buff.affect( ch, Amok.class, 3f + level() );
+			if (ch == Dungeon.hero) {
+				Buff.affect( ch, Vertigo.class, Vertigo.duration( ch ) );
+			} else {
+				Buff.affect( ch, Amok.class, 3f + level() );
+			}
 
 		} else {
 			
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfAvalanche.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfAvalanche.java
index 45f98d5..525b469 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfAvalanche.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfAvalanche.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfBlink.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfBlink.java
index 1389f81..9285bf9 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfBlink.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfBlink.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfDisintegration.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfDisintegration.java
index de315f3..7f5ea52 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfDisintegration.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfDisintegration.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfFirebolt.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfFirebolt.java
index f6b1841..8169523 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfFirebolt.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfFirebolt.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfFlock.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfFlock.java
index 66f31d5..926c3ca 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfFlock.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfFlock.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -22,7 +21,7 @@ import com.watabou.pixeldungeon.Assets;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.Actor;
 import com.watabou.pixeldungeon.actors.Char;
-import com.watabou.pixeldungeon.actors.mobs.Mob;
+import com.watabou.pixeldungeon.actors.mobs.npcs.NPC;
 import com.watabou.pixeldungeon.effects.CellEmitter;
 import com.watabou.pixeldungeon.effects.MagicMissile;
 import com.watabou.pixeldungeon.effects.Speck;
@@ -104,7 +103,7 @@ public class WandOfFlock extends Wand {
 			"A flick of this wand summons a flock of magic sheep, creating temporary impenetrable obstacle.";
 	}
 	
-	public static class Sheep extends Mob.NPC {
+	public static class Sheep extends NPC {
 		
 		private static final String[] QUOTES = {"Baa!", "Baa?", "Baa.", "Baa..."};
 		
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfLightning.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfLightning.java
index 21772eb..997cadf 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfLightning.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfLightning.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -48,8 +47,7 @@ public class WandOfLightning extends Wand {
 	
 	@Override
 	protected void onZap( int cell ) {
-		// The actual effect is processed in "fx" method
-		
+
 		if (!curUser.isAlive()) {
 			Dungeon.fail( Utils.format( ResultDescriptions.WAND, name, Dungeon.depth ) );
 			GLog.n( "You killed yourself with your own Wand of Lightning..." );
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfMagicMissile.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfMagicMissile.java
index 0858ce4..098804a 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfMagicMissile.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfMagicMissile.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfPoison.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfPoison.java
index 902ece0..2444971 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfPoison.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfPoison.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -37,8 +36,8 @@ public class WandOfPoison extends Wand {
 	protected void onZap( int cell ) {
 		Char ch = Actor.findChar( cell );
 		if (ch != null) {
-			
-			Buff.affect( ch, Poison.class ).set( Poison.durationFactor( ch ) * (1 + 2 * (float)Math.pow( 1.5, level() )) );
+
+			Buff.affect( ch, Poison.class ).set( Poison.durationFactor( ch ) * (5 + level()) );
 			
 		} else {
 			
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfRegrowth.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfRegrowth.java
index cedf5ab..bffab45 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfRegrowth.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfRegrowth.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfSlowness.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfSlowness.java
index 80f1104..5b0ad96 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfSlowness.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfSlowness.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfTelekinesis.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfTelekinesis.java
index fd816a4..0c0d5a4 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfTelekinesis.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfTelekinesis.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -80,7 +79,7 @@ public class WandOfTelekinesis extends Wand {
 						ch.pos = next;
 						Actor.freeCell( next );
 
-						// Refactoring needed!
+						// FIXME
 						if (ch instanceof Mob) {
 							Dungeon.level.mobPress( (Mob)ch );
 						} else {
@@ -88,7 +87,7 @@ public class WandOfTelekinesis extends Wand {
 						}
 						
 					} else {
-						
+
 						ch.damage( maxDistance-1 - i, this );
 						
 					}
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfTeleportation.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfTeleportation.java
index 889d637..5b2a8d3 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfTeleportation.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfTeleportation.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/Weapon.java b/core/src/com/watabou/pixeldungeon/items/weapon/Weapon.java
index ef0625f..1fa8c37 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/Weapon.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/Weapon.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -42,8 +41,13 @@ public class Weapon extends KindOfWeapon {
 	private static final String TXT_TO_STRING		= "%s :%d";
 	
 	public int		STR	= 10;
-	public float	ACU	= 1;	// Accuracy modifier
-	public float	DLY	= 1f;	// Speed modifier
+	public float	ACU	= 1;
+	public float	DLY	= 1f;
+	
+	public enum Imbue {
+		NONE, SPEED, ACCURACY
+	}
+	public Imbue imbue = Imbue.NONE;
 	
 	private int hitsToKnow = 20;
 	
@@ -66,17 +70,20 @@ public class Weapon extends KindOfWeapon {
 	}
 	
 	private static final String ENCHANTMENT	= "enchantment";
+	private static final String IMBUE		= "imbue";
 	
 	@Override
 	public void storeInBundle( Bundle bundle ) {
 		super.storeInBundle( bundle );
 		bundle.put( ENCHANTMENT, enchantment );
+		bundle.put( IMBUE, imbue );
 	}
 	
 	@Override
 	public void restoreFromBundle( Bundle bundle ) {
 		super.restoreFromBundle( bundle );
 		enchantment = (Enchantment)bundle.get( ENCHANTMENT );
+		imbue = bundle.getEnum( IMBUE, Imbue.class );
 	}
 	
 	@Override
@@ -96,7 +103,9 @@ public class Weapon extends KindOfWeapon {
 			}
 		}
 		
-		return encumbrance > 0 ? (float)(ACU / Math.pow( 1.5, encumbrance )) : ACU;
+		return 
+			(encumbrance > 0 ? (float)(ACU / Math.pow( 1.5, encumbrance )) : ACU) *
+			(imbue == Imbue.ACCURACY ? 1.5f : 1.0f);
 	}
 	
 	@Override
@@ -107,7 +116,9 @@ public class Weapon extends KindOfWeapon {
 			encumrance -= 2;
 		}
 		
-		return encumrance > 0 ? (float)(DLY * Math.pow( 1.2, encumrance )) : DLY;
+		return 
+			(encumrance > 0 ? (float)(DLY * Math.pow( 1.2, encumrance )) : DLY) * 
+			(imbue == Imbue.SPEED ? 0.6f : 1.0f);
 	}
 	
 	@Override
@@ -115,7 +126,7 @@ public class Weapon extends KindOfWeapon {
 		
 		int damage = super.damageRoll( hero );
 		
-		if (hero.usingRanged == (hero.heroClass == HeroClass.HUNTRESS)) {
+		if ((hero.rangedWeapon != null) == (hero.heroClass == HeroClass.HUNTRESS)) {
 			int exStr = hero.STR() - STR;
 			if (exStr > 0) {
 				damage += Random.IntRange( 0, exStr );
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Death.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Death.java
index 4aad905..46058ac 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Death.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Death.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Fire.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Fire.java
index 2418420..e879705 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Fire.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Fire.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Horror.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Horror.java
index 7e1322c..258caab 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Horror.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Horror.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,9 +16,11 @@
  */
 package com.watabou.pixeldungeon.items.weapon.enchantments;
 
+import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.Char;
 import com.watabou.pixeldungeon.actors.buffs.Buff;
 import com.watabou.pixeldungeon.actors.buffs.Terror;
+import com.watabou.pixeldungeon.actors.buffs.Vertigo;
 import com.watabou.pixeldungeon.items.weapon.Weapon;
 import com.watabou.pixeldungeon.sprites.ItemSprite;
 import com.watabou.pixeldungeon.sprites.ItemSprite.Glowing;
@@ -40,8 +41,11 @@ public class Horror extends Weapon.Enchantment {
 		
 		if (Random.Int( level + 5 ) >= 4) {
 			
-			Terror terror = Buff.affect( defender, Terror.class, Terror.DURATION );
-			terror.source = attacker;
+			if (defender == Dungeon.hero) {
+				Buff.affect( defender, Vertigo.class, Vertigo.duration( defender ) );
+			} else {
+				Buff.affect( defender, Terror.class, Terror.DURATION ).source = attacker;
+			}
 			
 			return true;
 		} else {
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Instability.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Instability.java
index f728b44..2bbbc4d 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Instability.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Instability.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Leech.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Leech.java
index 9fca84d..4b4a65b 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Leech.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Leech.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Luck.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Luck.java
index 0d7e265..814cde0 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Luck.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Luck.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Paralysis.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Paralysis.java
index 5223a96..c79b348 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Paralysis.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Paralysis.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Piercing.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Piercing.java
index 674ded3..5feb4e6 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Piercing.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Piercing.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Poison.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Poison.java
index 6d2bb58..d66f121 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Poison.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Poison.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Slow.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Slow.java
index b34fefd..c9e7245 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Slow.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Slow.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Swing.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Swing.java
index 3719c09..d6772d7 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Swing.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Swing.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/BattleAxe.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/BattleAxe.java
index e658df7..7a5b081 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/BattleAxe.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/BattleAxe.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Dagger.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Dagger.java
index baab2fd..54cec7b 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Dagger.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Dagger.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Glaive.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Glaive.java
index 965855c..53d77f6 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Glaive.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Glaive.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Knuckles.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Knuckles.java
index 5f0cdf3..aa9d3b3 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Knuckles.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Knuckles.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Longsword.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Longsword.java
index 9ea2945..ef4047a 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Longsword.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Longsword.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Mace.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Mace.java
index 4e4d987..e7d190b 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Mace.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Mace.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/MeleeWeapon.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/MeleeWeapon.java
index 13347d3..e2dbc41 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/MeleeWeapon.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/MeleeWeapon.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -115,6 +114,15 @@ public class MeleeWeapon extends Weapon {
 		} else if (ACU != 1f) {
 			info.append( "This is a rather " + (ACU > 1f ? "accurate" : "inaccurate") + " weapon. " );
 		}
+		switch (imbue) {
+		case SPEED:
+			info.append( "It was balanced to make it faster. " );
+			break;
+		case ACCURACY:
+			info.append( "It was balanced to make it more accurate. " );
+			break;
+		case NONE:
+		}
 		
 		if (enchantment != null) {
 			info.append( "It is enchanted." );
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Quarterstaff.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Quarterstaff.java
index 6458a09..54016d2 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Quarterstaff.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Quarterstaff.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -32,7 +31,6 @@ public class Quarterstaff extends MeleeWeapon {
 	
 	@Override
 	public String desc() {
-		// TODO Auto-generated method stub
 		return "A staff of hardwood, its ends are shod with iron.";
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/ShortSword.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/ShortSword.java
index 1531b32..7c777c8 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/ShortSword.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/ShortSword.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Spear.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Spear.java
index 0a9e711..cfccc5d 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Spear.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Spear.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Sword.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Sword.java
index 14b015f..869eb3f 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Sword.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Sword.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/WarHammer.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/WarHammer.java
index 3a8a325..e370faa 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/WarHammer.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/WarHammer.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Boomerang.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Boomerang.java
index 4d1bb88..6bb3aee 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Boomerang.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Boomerang.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -80,7 +79,7 @@ public class Boomerang extends MissileWeapon {
 	@Override
 	public void proc( Char attacker, Char defender, int damage ) {
 		super.proc( attacker, defender, damage );
-		if (attacker instanceof Hero && ((Hero)attacker).usingRanged) {
+		if (attacker instanceof Hero && ((Hero)attacker).rangedWeapon == this) {
 			circleBack( defender.pos, (Hero)attacker );
 		}
 	}
@@ -91,11 +90,25 @@ public class Boomerang extends MissileWeapon {
 	}
 	
 	private void circleBack( int from, Hero owner ) {
+		
+		((MissileSprite)curUser.sprite.parent.recycle( MissileSprite.class )).
+			reset( from, curUser.pos, curItem, null );
+		
+		if (throwEquiped) {
+			owner.belongings.weapon = this;
+			owner.spend( -TIME_TO_EQUIP );
+		} else 
 		if (!collect( curUser.belongings.backpack )) {
 			Dungeon.level.drop( this, owner.pos ).sprite.drop();
 		}
-		((MissileSprite)curUser.sprite.parent.recycle( MissileSprite.class )).
-			reset( from, curUser.pos, curItem, null );
+	}
+	
+	private boolean throwEquiped;
+	
+	@Override
+	public void cast( Hero user, int dst ) {
+		throwEquiped = isEquipped( user );
+		super.cast( user, dst );
 	}
 	
 	@Override
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/CurareDart.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/CurareDart.java
index 409be7d..6c0ec70 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/CurareDart.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/CurareDart.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Dart.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Dart.java
index bebc579..3b8fce8 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Dart.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Dart.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/IncendiaryDart.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/IncendiaryDart.java
index d8bbc88..aef2575 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/IncendiaryDart.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/IncendiaryDart.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Javelin.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Javelin.java
index 6fb7cc7..a8a9321 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Javelin.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Javelin.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/MissileWeapon.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/MissileWeapon.java
index 62c3be8..5d8767d 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/MissileWeapon.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/MissileWeapon.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -75,9 +74,9 @@ public class MissileWeapon extends Weapon {
 		super.proc( attacker, defender, damage );
 		
 		Hero hero = (Hero)attacker;
-		if (!hero.usingRanged && stackable) {
+		if (hero.rangedWeapon == null && stackable) {
 			if (quantity == 1) {
-				doUnequip( hero, false );
+				doUnequip( hero, false, false );
 			} else {
 				detach( null );
 			}
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Shuriken.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Shuriken.java
index a5f37a7..c301b52 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Shuriken.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Shuriken.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Tamahawk.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Tamahawk.java
index baa9cd1..ea24ff7 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Tamahawk.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Tamahawk.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/CavesBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/CavesBossLevel.java
index 0d6ef21..ff52496 100644
--- a/core/src/com/watabou/pixeldungeon/levels/CavesBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/CavesBossLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -220,7 +219,7 @@ public class CavesBossLevel extends Level {
 			enteredArena = true;
 			
 			Mob boss = Bestiary.mob( Dungeon.depth );
-			boss.state = Mob.State.HUNTING;
+			boss.state = boss.HUNTING;
 			do {
 				boss.pos = Random.Int( LENGTH );
 			} while (
diff --git a/core/src/com/watabou/pixeldungeon/levels/CavesLevel.java b/core/src/com/watabou/pixeldungeon/levels/CavesLevel.java
index 0a17449..080b35a 100644
--- a/core/src/com/watabou/pixeldungeon/levels/CavesLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/CavesLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/CityBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/CityBossLevel.java
index 8278cfc..9e911ec 100644
--- a/core/src/com/watabou/pixeldungeon/levels/CityBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/CityBossLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -178,7 +177,7 @@ public class CityBossLevel extends Level {
 			enteredArena = true;
 			
 			Mob boss = Bestiary.mob( Dungeon.depth );
-			boss.state = Mob.State.HUNTING;
+			boss.state = boss.HUNTING;
 			do {
 				boss.pos = Random.Int( LENGTH );
 			} while (
diff --git a/core/src/com/watabou/pixeldungeon/levels/CityLevel.java b/core/src/com/watabou/pixeldungeon/levels/CityLevel.java
index 38778a4..50802d1 100644
--- a/core/src/com/watabou/pixeldungeon/levels/CityLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/CityLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/DeadEndLevel.java b/core/src/com/watabou/pixeldungeon/levels/DeadEndLevel.java
index 5d87f4b..41d1398 100644
--- a/core/src/com/watabou/pixeldungeon/levels/DeadEndLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/DeadEndLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/HallsBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/HallsBossLevel.java
index 1c22aea..30cba8a 100644
--- a/core/src/com/watabou/pixeldungeon/levels/HallsBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/HallsBossLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -236,8 +235,6 @@ public class HallsBossLevel extends Level {
 		switch (tile) {
 		case Terrain.WATER:
 			return "It looks like lava, but it's cold and probably safe to touch.";
-		case Terrain.EMPTY_DECO:
-			return "Candles on the floor are probably remains of some ritual that took place here.";
 		case Terrain.STATUE:
 		case Terrain.STATUE_SP:
 			return "The pillar is made of real humanoid skulls. Awesome."; 
diff --git a/core/src/com/watabou/pixeldungeon/levels/HallsLevel.java b/core/src/com/watabou/pixeldungeon/levels/HallsLevel.java
index adddc65..c0419ac 100644
--- a/core/src/com/watabou/pixeldungeon/levels/HallsLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/HallsLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -130,8 +129,6 @@ public class HallsLevel extends RegularLevel {
 		switch (tile) {
 		case Terrain.WATER:
 			return "It looks like lava, but it's cold and probably safe to touch.";
-		case Terrain.EMPTY_DECO:
-			return "Candles on the floor are probably remains of some ritual that took place here.";
 		case Terrain.STATUE:
 		case Terrain.STATUE_SP:
 			return "The pillar is made of real humanoid skulls. Awesome."; 
diff --git a/core/src/com/watabou/pixeldungeon/levels/LastLevel.java b/core/src/com/watabou/pixeldungeon/levels/LastLevel.java
index 6df523e..0709233 100644
--- a/core/src/com/watabou/pixeldungeon/levels/LastLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/LastLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -114,8 +113,6 @@ public class LastLevel extends Level {
 		switch (tile) {
 		case Terrain.WATER:
 			return "It looks like lava, but it's cold and probably safe to touch.";
-		case Terrain.EMPTY_DECO:
-			return "Candles on the floor are probably remains of some ritual that took place here.";
 		case Terrain.STATUE:
 		case Terrain.STATUE_SP:
 			return "The pillar is made of real humanoid skulls. Awesome."; 
diff --git a/core/src/com/watabou/pixeldungeon/levels/LastShopLevel.java b/core/src/com/watabou/pixeldungeon/levels/LastShopLevel.java
index 981cbc1..7448807 100644
--- a/core/src/com/watabou/pixeldungeon/levels/LastShopLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/LastShopLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/Level.java b/core/src/com/watabou/pixeldungeon/levels/Level.java
index 89cf4eb..59f2ff0 100644
--- a/core/src/com/watabou/pixeldungeon/levels/Level.java
+++ b/core/src/com/watabou/pixeldungeon/levels/Level.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -26,6 +25,7 @@ import java.util.HashSet;
 import com.watabou.noosa.Scene;
 import com.watabou.noosa.audio.Sample;
 import com.watabou.pixeldungeon.Assets;
+import com.watabou.pixeldungeon.Challenges;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.Statistics;
 import com.watabou.pixeldungeon.actors.Actor;
@@ -45,9 +45,13 @@ import com.watabou.pixeldungeon.actors.mobs.Mob;
 import com.watabou.pixeldungeon.effects.particles.FlowParticle;
 import com.watabou.pixeldungeon.effects.particles.WindParticle;
 import com.watabou.pixeldungeon.items.Generator;
+import com.watabou.pixeldungeon.items.Gold;
 import com.watabou.pixeldungeon.items.Heap;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.Stylus;
+import com.watabou.pixeldungeon.items.armor.Armor;
+import com.watabou.pixeldungeon.items.food.Food;
+import com.watabou.pixeldungeon.items.potions.PotionOfHealing;
 import com.watabou.pixeldungeon.items.potions.PotionOfStrength;
 import com.watabou.pixeldungeon.items.scrolls.ScrollOfUpgrade;
 import com.watabou.pixeldungeon.levels.features.Chasm;
@@ -94,7 +98,7 @@ public abstract class Level implements Bundlable {
 	public boolean[] visited;
 	public boolean[] mapped;
 	
-	public int viewDistance = 8;
+	public int viewDistance = Dungeon.isChallenged( Challenges.DARKNESS ) ? 3: 8;
 	
 	public static boolean[] fieldOfView = new boolean[LENGTH];
 	
@@ -359,7 +363,7 @@ public abstract class Level implements Bundlable {
 				if (mobs.size() < nMobs()) {
 
 					Mob mob = Bestiary.mutable( Dungeon.depth );
-					mob.state = Mob.State.WANDERING;
+					mob.state = mob.WANDERING;
 					mob.pos = randomRespawnCell();
 					if (Dungeon.hero.isAlive() && mob.pos != -1) {
 						GameScene.add( mob );
@@ -504,6 +508,16 @@ public abstract class Level implements Bundlable {
 	
 	public Heap drop( Item item, int cell ) {
 		
+		if (Dungeon.isChallenged( Challenges.NO_FOOD ) && item instanceof Food) {
+			item = new Gold( item.price() );
+		} else
+		if (Dungeon.isChallenged( Challenges.NO_ARMOR ) && item instanceof Armor) {
+			item = new Gold( item.price() );
+		} else
+		if (Dungeon.isChallenged( Challenges.NO_HEALING ) && item instanceof PotionOfHealing) {
+			item = new Gold( item.price() );
+		}
+		
 		if ((map[cell] == Terrain.ALCHEMY) && !(item instanceof Plant.Seed)) {
 			int n;
 			do {
@@ -799,7 +813,6 @@ public abstract class Level implements Bundlable {
 				}
 			}
 			if (c.buff( Awareness.class ) != null) {
-
 				for (Heap heap : heaps.values()) {
 					int p = heap.pos;
 					fieldOfView[p] = true;
diff --git a/core/src/com/watabou/pixeldungeon/levels/Patch.java b/core/src/com/watabou/pixeldungeon/levels/Patch.java
index 85563a8..0589da2 100644
--- a/core/src/com/watabou/pixeldungeon/levels/Patch.java
+++ b/core/src/com/watabou/pixeldungeon/levels/Patch.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/PrisonBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/PrisonBossLevel.java
index 8d27cf5..52e222b 100644
--- a/core/src/com/watabou/pixeldungeon/levels/PrisonBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/PrisonBossLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -135,7 +134,7 @@ public class PrisonBossLevel extends RegularLevel {
 		
 		anteroom = path.get( path.size() - 2 );
 		anteroom.type = Type.STANDARD;
-
+		
 		Room room = roomEntrance;
 		for (Room next : path) {
 			room.connect( next );
@@ -289,7 +288,7 @@ public class PrisonBossLevel extends RegularLevel {
 		while (!passable[keyPos]) {
 			keyPos = anteroom.random();
 		}
-		drop( new IronKey( Dungeon.depth ), keyPos ).type = Heap.Type.CHEST;
+		drop( new IronKey(), keyPos ).type = Heap.Type.CHEST;
 		
 		Item item = Bones.get();
 		if (item != null) {
@@ -316,7 +315,7 @@ public class PrisonBossLevel extends RegularLevel {
 			} while (pos == cell || Actor.findChar( pos ) != null);
 			
 			Mob boss = Bestiary.mob( Dungeon.depth );
-			boss.state = Mob.State.HUNTING;
+			boss.state = boss.HUNTING;
 			boss.pos = pos;
 			GameScene.add( boss );
 			boss.notice();
diff --git a/core/src/com/watabou/pixeldungeon/levels/PrisonLevel.java b/core/src/com/watabou/pixeldungeon/levels/PrisonLevel.java
index 92773a7..598dae2 100644
--- a/core/src/com/watabou/pixeldungeon/levels/PrisonLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/PrisonLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java b/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java
index 76655ad..c3a8df5 100644
--- a/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -81,29 +80,29 @@ public abstract class RegularLevel extends Level {
 		
 		HashSet<Room> connected = new HashSet<Room>();
 		connected.add( roomEntrance );
-
+		
 		Graph.buildDistanceMap( rooms, roomExit );
 		List<Room> path = Graph.buildPath( rooms, roomEntrance, roomExit );
-
+		
 		Room room = roomEntrance;
 		for (Room next : path) {
 			room.connect( next );
 			room = next;
 			connected.add( room );
 		}
-
+		
 		Graph.setPrice( path, roomEntrance.distance );
-
+		
 		Graph.buildDistanceMap( rooms, roomExit );
 		path = Graph.buildPath( rooms, roomEntrance, roomExit );
-
+		
 		room = roomEntrance;
 		for (Room next : path) {
 			room.connect( next );
 			room = next;
 			connected.add( room );
 		}
-
+		
 		int nConnected = (int)(rooms.size() * Random.Float( 0.5f, 0.7f ));
 		while (connected.size() < nConnected) {
 
@@ -151,7 +150,7 @@ public abstract class RegularLevel extends Level {
 
 		rooms = new HashSet<Room>();
 		split( new Rect( 0, 0, WIDTH - 1, HEIGHT - 1 ) );
-		
+
 		if (rooms.size() < 8) {
 			return false;
 		}
@@ -354,7 +353,7 @@ public abstract class RegularLevel extends Level {
 		int h = rect.height();
 		
 		if (w > maxRoomSize && h < minRoomSize) {
-
+			
 			int vw = Random.Int( rect.left + 3, rect.right - 3 );
 			split( new Rect( rect.left, rect.top, vw, rect.bottom ) );
 			split( new Rect( vw, rect.top, rect.right, rect.bottom ) );
@@ -614,10 +613,12 @@ public abstract class RegularLevel extends Level {
 		for (Item item : itemsToSpawn) {
 			int cell = randomDropCell();
 			if (item instanceof ScrollOfUpgrade) {
+
 				while (map[cell] == Terrain.FIRE_TRAP || map[cell] == Terrain.SECRET_FIRE_TRAP) {
 					cell = randomDropCell();
 				}
 			}
+
 			drop( item, cell ).type = Heap.Type.HEAP;
 		}
 		
diff --git a/core/src/com/watabou/pixeldungeon/levels/Room.java b/core/src/com/watabou/pixeldungeon/levels/Room.java
index b4ff9f4..cae9412 100644
--- a/core/src/com/watabou/pixeldungeon/levels/Room.java
+++ b/core/src/com/watabou/pixeldungeon/levels/Room.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/SewerBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/SewerBossLevel.java
index d3e0a45..dd8adea 100644
--- a/core/src/com/watabou/pixeldungeon/levels/SewerBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/SewerBossLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -58,7 +57,7 @@ public class SewerBossLevel extends RegularLevel {
 	protected boolean build() {
 		
 		initRooms();
-
+	
 		int distance;
 		int retry = 0;
 		int minDistance = (int)Math.sqrt( rooms.size() );
diff --git a/core/src/com/watabou/pixeldungeon/levels/SewerLevel.java b/core/src/com/watabou/pixeldungeon/levels/SewerLevel.java
index e538eff..bc7af42 100644
--- a/core/src/com/watabou/pixeldungeon/levels/SewerLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/SewerLevel.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/Terrain.java b/core/src/com/watabou/pixeldungeon/levels/Terrain.java
index ee3b7e3..05965e2 100644
--- a/core/src/com/watabou/pixeldungeon/levels/Terrain.java
+++ b/core/src/com/watabou/pixeldungeon/levels/Terrain.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -92,7 +91,7 @@ public class Terrain {
 		flags[WALL]			= LOS_BLOCKING | SOLID 							| UNSTITCHABLE;
 		flags[DOOR]			= PASSABLE | LOS_BLOCKING | FLAMABLE | SOLID	| UNSTITCHABLE;
 		flags[OPEN_DOOR]	= PASSABLE | FLAMABLE 							| UNSTITCHABLE;
-		flags[ENTRANCE]		= PASSABLE;
+		flags[ENTRANCE]		= PASSABLE/* | SOLID*/;
 		flags[EXIT]			= PASSABLE;
 		flags[EMBERS]		= PASSABLE;
 		flags[LOCKED_DOOR]	= LOS_BLOCKING | SOLID 							| UNSTITCHABLE;
diff --git a/core/src/com/watabou/pixeldungeon/levels/features/AlchemyPot.java b/core/src/com/watabou/pixeldungeon/levels/features/AlchemyPot.java
index 2d4fee8..c7144fb 100644
--- a/core/src/com/watabou/pixeldungeon/levels/features/AlchemyPot.java
+++ b/core/src/com/watabou/pixeldungeon/levels/features/AlchemyPot.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/features/Chasm.java b/core/src/com/watabou/pixeldungeon/levels/features/Chasm.java
index 57b892b..0ec36c8 100644
--- a/core/src/com/watabou/pixeldungeon/levels/features/Chasm.java
+++ b/core/src/com/watabou/pixeldungeon/levels/features/Chasm.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/features/Door.java b/core/src/com/watabou/pixeldungeon/levels/features/Door.java
index 2990491..1b0ac15 100644
--- a/core/src/com/watabou/pixeldungeon/levels/features/Door.java
+++ b/core/src/com/watabou/pixeldungeon/levels/features/Door.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/features/HighGrass.java b/core/src/com/watabou/pixeldungeon/levels/features/HighGrass.java
index afb516c..fcd66da 100644
--- a/core/src/com/watabou/pixeldungeon/levels/features/HighGrass.java
+++ b/core/src/com/watabou/pixeldungeon/levels/features/HighGrass.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,6 +16,7 @@
  */
 package com.watabou.pixeldungeon.levels.features;
 
+import com.watabou.pixeldungeon.Challenges;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.Char;
 import com.watabou.pixeldungeon.actors.buffs.Barkskin;
@@ -40,22 +40,24 @@ public class HighGrass {
 		Level.set( pos, Terrain.GRASS );
 		GameScene.updateMap( pos );
 		
-		int herbalismLevel = 0;
-		if (ch != null) {
-			Herbalism herbalism = ch.buff( Herbalism.class );
-			if (herbalism != null) {
-				herbalismLevel = herbalism.level;
+		if (!Dungeon.isChallenged( Challenges.NO_HERBALISM )) {
+			int herbalismLevel = 0;
+			if (ch != null) {
+				Herbalism herbalism = ch.buff( Herbalism.class );
+				if (herbalism != null) {
+					herbalismLevel = herbalism.level;
+				}
+			}
+			
+			// Seed
+			if (herbalismLevel >= 0 && Random.Int( 18 ) <= Random.Int( herbalismLevel + 1 )) {
+				level.drop( Generator.random( Generator.Category.SEED ), pos ).sprite.drop();
+			}
+			
+			// Dew
+			if (herbalismLevel >= 0 && Random.Int( 6 ) <= Random.Int( herbalismLevel + 1 )) {
+				level.drop( new Dewdrop(), pos ).sprite.drop();
 			}
-		}
-		
-		// Seed
-		if (herbalismLevel >= 0 && Random.Int( 18 ) <= Random.Int( herbalismLevel + 1 )) {
-			level.drop( Generator.random( Generator.Category.SEED ), pos ).sprite.drop();
-		}
-		
-		// Dew
-		if (herbalismLevel >= 0 && Random.Int( 6 ) <= Random.Int( herbalismLevel + 1 )) {
-			level.drop( new Dewdrop(), pos ).sprite.drop();
 		}
 		
 		int leaves = 4;
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/ArmoryPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/ArmoryPainter.java
index 542974f..32cab68 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/ArmoryPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/ArmoryPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,6 @@
  */
 package com.watabou.pixeldungeon.levels.painters;
 
-import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.items.Generator;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.keys.IronKey;
@@ -59,7 +57,7 @@ public class ArmoryPainter extends Painter {
 		}
 		
 		entrance.set( Room.Door.Type.LOCKED );
-		level.addItemToSpawn( new IronKey( Dungeon.depth ) );
+		level.addItemToSpawn( new IronKey() );
 	}
 	
 	private static Item prize( Level level ) {
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/BlacksmithPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/BlacksmithPainter.java
index ac98fc7..1ad1bda 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/BlacksmithPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/BlacksmithPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/BossExitPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/BossExitPainter.java
index e2fa8be..637dcfb 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/BossExitPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/BossExitPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/CryptPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/CryptPainter.java
index cd26321..9627dad 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/CryptPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/CryptPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,6 @@
  */
 package com.watabou.pixeldungeon.levels.painters;
 
-import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.items.Generator;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.Heap.Type;
@@ -41,7 +39,7 @@ public class CryptPainter extends Painter {
 		Room.Door entrance = room.entrance();
 		
 		entrance.set( Room.Door.Type.LOCKED );
-		level.addItemToSpawn( new IronKey( Dungeon.depth ) );
+		level.addItemToSpawn( new IronKey() );
 		
 		if (entrance.x == room.left) {
 			set( level, new Point( room.right-1, room.top+1 ), Terrain.STATUE );
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/EntrancePainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/EntrancePainter.java
index 8f89496..c9bdde9 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/EntrancePainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/EntrancePainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/ExitPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/ExitPainter.java
index ca9a96e..80d8ea5 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/ExitPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/ExitPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/GardenPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/GardenPainter.java
index 3189ed9..4096409 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/GardenPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/GardenPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/LaboratoryPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/LaboratoryPainter.java
index e5e0f39..a447033 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/LaboratoryPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/LaboratoryPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,6 @@
  */
 package com.watabou.pixeldungeon.levels.painters;
 
-import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.blobs.Alchemy;
 import com.watabou.pixeldungeon.items.Generator;
 import com.watabou.pixeldungeon.items.Item;
@@ -66,7 +64,7 @@ public class LaboratoryPainter extends Painter {
 		}
 		
 		entrance.set( Room.Door.Type.LOCKED );
-		level.addItemToSpawn( new IronKey( Dungeon.depth ) );
+		level.addItemToSpawn( new IronKey() );
 	}
 	
 	private static Item prize( Level level ) {
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/LibraryPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/LibraryPainter.java
index 5794992..0ca027f 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/LibraryPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/LibraryPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,6 @@
  */
 package com.watabou.pixeldungeon.levels.painters;
 
-import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.items.Generator;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.keys.IronKey;
@@ -73,7 +71,7 @@ public class LibraryPainter extends Painter {
 		}
 		
 		entrance.set( Room.Door.Type.LOCKED );
-		level.addItemToSpawn( new IronKey( Dungeon.depth ) );
+		level.addItemToSpawn( new IronKey() );
 	}
 	
 	private static Item prize( Level level ) {
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/MagicWellPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/MagicWellPainter.java
index a5ab94f..d760261 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/MagicWellPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/MagicWellPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/Painter.java b/core/src/com/watabou/pixeldungeon/levels/painters/Painter.java
index cef7487..aa14474 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/Painter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/Painter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/PassagePainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/PassagePainter.java
index cc04549..91be67d 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/PassagePainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/PassagePainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -76,11 +75,11 @@ public class PassagePainter extends Painter {
 			return (xy.x - room.left - 1);
 			
 		} else if (xy.x == room.right) {
-			
+
 			return (xy.y - room.top - 1) + pasWidth;
 			
 		} else if (xy.y == room.bottom) {
-			
+
 			return (room.right - xy.x - 1) + pasWidth + pasHeight;
 			
 		} else {
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/PitPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/PitPainter.java
index 0ebbb0b..b9f6459 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/PitPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/PitPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,7 @@
  */
 package com.watabou.pixeldungeon.levels.painters;
 
-import com.watabou.pixeldungeon.Dungeon;
+
 import com.watabou.pixeldungeon.items.Generator;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.Heap.Type;
@@ -55,7 +54,7 @@ public class PitPainter extends Painter {
 			remains = room.random();
 		}
 		
-		level.drop( new IronKey( Dungeon.depth ), remains ).type = Type.SKELETON;
+		level.drop( new IronKey(), remains ).type = Type.SKELETON;
 		
 		if (Random.Int( 5 ) == 0) {
 			level.drop( Generator.random( Generator.Category.RING ), remains );
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/PoolPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/PoolPainter.java
index 92a117d..0606cec 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/PoolPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/PoolPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/RatKingPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/RatKingPainter.java
index 3af1d78..26efc49 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/RatKingPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/RatKingPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/ShopPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/ShopPainter.java
index 38b4997..f2f8747 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/ShopPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/ShopPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -28,6 +27,7 @@ import com.watabou.pixeldungeon.items.Generator;
 import com.watabou.pixeldungeon.items.Heap;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.Torch;
+import com.watabou.pixeldungeon.items.Weightstone;
 import com.watabou.pixeldungeon.items.armor.*;
 import com.watabou.pixeldungeon.items.bags.ScrollHolder;
 import com.watabou.pixeldungeon.items.bags.SeedPouch;
@@ -95,18 +95,21 @@ public class ShopPainter extends Painter {
 			items.add( (Random.Int( 2 ) == 0 ? new Quarterstaff() : new Spear()).identify() );
 			items.add( new LeatherArmor().identify() );
 			items.add( new SeedPouch() );
+			items.add( new Weightstone() );
 			break;
 			
 		case 11:
 			items.add( (Random.Int( 2 ) == 0 ? new Sword() : new Mace()).identify() );
 			items.add( new MailArmor().identify() );
 			items.add( new ScrollHolder() );
+			items.add( new Weightstone() );
 			break;
 			
 		case 16:
 			items.add( (Random.Int( 2 ) == 0 ? new Longsword() : new BattleAxe()).identify() );
 			items.add( new ScaleArmor().identify() );
 			items.add( new WandHolster() );
+			items.add( new Weightstone() );
 			break;
 			
 		case 21:
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/StandardPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/StandardPainter.java
index e941a07..34b4b35 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/StandardPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/StandardPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/StatuePainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/StatuePainter.java
index 0f4af20..47c9f95 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/StatuePainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/StatuePainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,6 @@
  */
 package com.watabou.pixeldungeon.levels.painters;
 
-import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.Actor;
 import com.watabou.pixeldungeon.actors.mobs.Statue;
 import com.watabou.pixeldungeon.items.keys.IronKey;
@@ -40,7 +38,7 @@ public class StatuePainter extends Painter {
 		Room.Door door = room.entrance();
 		
 		door.set( Room.Door.Type.LOCKED );
-		level.addItemToSpawn( new IronKey( Dungeon.depth ) );
+		level.addItemToSpawn( new IronKey() );
 		
 		if (door.x == room.left) {
 			
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/StoragePainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/StoragePainter.java
index 3cdd408..2da6869 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/StoragePainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/StoragePainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -35,7 +34,7 @@ public class StoragePainter extends Painter {
 		fill( level, room, 1, floor );
 		
 		int n = Random.IntRange( 3, 4 );
-		for (int i=0; i < n; i++) {
+		for (int i=0; i < n; i++) { 
 			int pos;
 			do {
 				pos = room.random();
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/TrapsPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/TrapsPainter.java
index 45ba75f..bf99885 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/TrapsPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/TrapsPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/TreasuryPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/TreasuryPainter.java
index ea3c616..c9fcd1f 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/TreasuryPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/TreasuryPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,6 @@
  */
 package com.watabou.pixeldungeon.levels.painters;
 
-import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.items.Gold;
 import com.watabou.pixeldungeon.items.Heap;
 import com.watabou.pixeldungeon.items.keys.IronKey;
@@ -57,6 +55,6 @@ public class TreasuryPainter extends Painter {
 		}
 		
 		room.entrance().set( Room.Door.Type.LOCKED );
-		level.addItemToSpawn( new IronKey( Dungeon.depth ) );
+		level.addItemToSpawn( new IronKey() );
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/TunnelPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/TunnelPainter.java
index 2544f77..4270b10 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/TunnelPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/TunnelPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/VaultPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/VaultPainter.java
index 9de626b..13534bd 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/VaultPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/VaultPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,7 +16,6 @@
  */
 package com.watabou.pixeldungeon.levels.painters;
 
-import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.items.Generator;
 import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.items.Heap.Type;
@@ -43,7 +41,7 @@ public class VaultPainter extends Painter {
 		
 		case 0:
 			level.drop( prize( level ), c ).type = Type.LOCKED_CHEST;
-			level.addItemToSpawn( new GoldenKey( Dungeon.depth ) );
+			level.addItemToSpawn( new GoldenKey() );
 			break;
 			
 		case 1:
@@ -54,7 +52,7 @@ public class VaultPainter extends Painter {
 			} while (i1.getClass() == i2.getClass());
 			level.drop( i1, c ).type = Type.CRYSTAL_CHEST;
 			level.drop( i2, c + Level.NEIGHBOURS8[Random.Int( 8 )]).type = Type.CRYSTAL_CHEST;
-			level.addItemToSpawn( new GoldenKey( Dungeon.depth ) );
+			level.addItemToSpawn( new GoldenKey() );
 			break;
 			
 		case 2:
@@ -64,7 +62,7 @@ public class VaultPainter extends Painter {
 		}
 		
 		room.entrance().set( Room.Door.Type.LOCKED );
-		level.addItemToSpawn( new IronKey( Dungeon.depth ) );
+		level.addItemToSpawn( new IronKey() );
 	}
 	
 	private static Item prize( Level level ) {
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/WeakFloorPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/WeakFloorPainter.java
index 5da8bd3..1ba9269 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/WeakFloorPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/WeakFloorPainter.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/AlarmTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/AlarmTrap.java
index 7eeca71..c21995b 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/AlarmTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/AlarmTrap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/FireTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/FireTrap.java
index 64d638d..8bc6d19 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/FireTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/FireTrap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/GrippingTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/GrippingTrap.java
index 7e5878e..4a03122 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/GrippingTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/GrippingTrap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/LightningTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/LightningTrap.java
index d1b16a5..1051e7b 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/LightningTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/LightningTrap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/ParalyticTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/ParalyticTrap.java
index a858fef..0030e61 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/ParalyticTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/ParalyticTrap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/PoisonTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/PoisonTrap.java
index 50a109d..d2fefc9 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/PoisonTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/PoisonTrap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -31,7 +30,7 @@ public class PoisonTrap {
 	public static void trigger( int pos, Char ch ) {
 		
 		if (ch != null) {
-			Buff.affect( ch, Poison.class ).set( 5 + Math.min( Dungeon.depth, 15 ) );
+			Buff.affect( ch, Poison.class ).set( Poison.durationFactor( ch ) * (4 + Dungeon.depth / 2) );
 		}
 		
 		CellEmitter.center( pos ).burst( PoisonParticle.SPLASH, 3 );
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/SummoningTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/SummoningTrap.java
index ba9e678..6822f2f 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/SummoningTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/SummoningTrap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -80,7 +79,7 @@ public class SummoningTrap {
 		
 		for (Integer point : respawnPoints) {
 			Mob mob = Bestiary.mob( Dungeon.depth );
-			mob.state = Mob.State.WANDERING;
+			mob.state = mob.WANDERING;
 			GameScene.add( mob, DELAY );
 			WandOfBlink.appear( mob, point );
 		}
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/ToxicTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/ToxicTrap.java
index 61957c5..8600c71 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/ToxicTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/ToxicTrap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/mechanics/Ballistica.java b/core/src/com/watabou/pixeldungeon/mechanics/Ballistica.java
index 4f71a1f..bb71821 100644
--- a/core/src/com/watabou/pixeldungeon/mechanics/Ballistica.java
+++ b/core/src/com/watabou/pixeldungeon/mechanics/Ballistica.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -24,7 +23,7 @@ public class Ballistica {
 
 	public static int[] trace = new int[Math.max( Level.WIDTH, Level.HEIGHT )];
 	public static int distance;
-
+	
 	public static int cast( int from, int to, boolean magic, boolean hitChars ) {
 		
 		int w = Level.WIDTH;
diff --git a/core/src/com/watabou/pixeldungeon/mechanics/ShadowCaster.java b/core/src/com/watabou/pixeldungeon/mechanics/ShadowCaster.java
index 696bd7a..9629ba3 100644
--- a/core/src/com/watabou/pixeldungeon/mechanics/ShadowCaster.java
+++ b/core/src/com/watabou/pixeldungeon/mechanics/ShadowCaster.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Dreamweed.java b/core/src/com/watabou/pixeldungeon/plants/Dreamweed.java
new file mode 100644
index 0000000..2b20b8c
--- /dev/null
+++ b/core/src/com/watabou/pixeldungeon/plants/Dreamweed.java
@@ -0,0 +1,67 @@
+/*
+ * Copyright (C) 2012-2014  Oleg Dolya
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>
+ */
+package com.watabou.pixeldungeon.plants;
+
+import com.watabou.pixeldungeon.Dungeon;
+import com.watabou.pixeldungeon.actors.Char;
+import com.watabou.pixeldungeon.actors.blobs.Blob;
+import com.watabou.pixeldungeon.actors.blobs.ConfusionGas;
+import com.watabou.pixeldungeon.items.potions.PotionOfInvisibility;
+import com.watabou.pixeldungeon.scenes.GameScene;
+import com.watabou.pixeldungeon.sprites.ItemSpriteSheet;
+
+public class Dreamweed extends Plant {
+
+	private static final String TXT_DESC = 
+		"Upon touching a Dreamweed it secretes a glittering cloud of confusing gas.";
+	
+	{
+		image = 3;
+		plantName = "Dreamweed";
+	}
+	
+	@Override
+	public void activate( Char ch ) {
+		super.activate( ch );
+		
+		if (ch != null) {
+			GameScene.add( Blob.seed( pos, 300 + 20 * Dungeon.depth, ConfusionGas.class ) );
+		}
+	}
+	
+	@Override
+	public String desc() {
+		return TXT_DESC;
+	}
+	
+	public static class Seed extends Plant.Seed {
+		{
+			plantName = "Dreamweed";
+			
+			name = "seed of " + plantName;
+			image = ItemSpriteSheet.SEED_DREAMWEED;
+			
+			plantClass = Dreamweed.class;
+			alchemyClass = PotionOfInvisibility.class;
+		}
+		
+		@Override
+		public String desc() {
+			return TXT_DESC;
+		}
+	}
+}
diff --git a/core/src/com/watabou/pixeldungeon/plants/Earthroot.java b/core/src/com/watabou/pixeldungeon/plants/Earthroot.java
index 400614e..e57b144 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Earthroot.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Earthroot.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Fadeleaf.java b/core/src/com/watabou/pixeldungeon/plants/Fadeleaf.java
index fda8c78..4baa06b 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Fadeleaf.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Fadeleaf.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Firebloom.java b/core/src/com/watabou/pixeldungeon/plants/Firebloom.java
index 8b5e9a1..c003f7d 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Firebloom.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Firebloom.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Icecap.java b/core/src/com/watabou/pixeldungeon/plants/Icecap.java
index b14084c..dd48070 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Icecap.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Icecap.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -29,8 +28,7 @@ import com.watabou.utils.PathFinder;
 
 public class Icecap extends Plant {
 
-	private static final String TXT_DESC = 
-		"Upon touching an Icecap excretes a pollen, which freezes everything in its vicinity.";
+	private static final String TXT_DESC = "Upon touching an Icecap excretes a pollen, which freezes everything in its vicinity.";
 	
 	{
 		image = 1;
@@ -47,7 +45,7 @@ public class Icecap extends Plant {
 		
 		for (int i=0; i < Level.LENGTH; i++) {
 			if (PathFinder.distance[i] < Integer.MAX_VALUE) {
-				
+
 				Freezing.affect( i, fire );
 			}
 		}
diff --git a/core/src/com/watabou/pixeldungeon/plants/Plant.java b/core/src/com/watabou/pixeldungeon/plants/Plant.java
index 5772c88..c705db5 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Plant.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Plant.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Sorrowmoss.java b/core/src/com/watabou/pixeldungeon/plants/Sorrowmoss.java
index 54bf56f..9360b00 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Sorrowmoss.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Sorrowmoss.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -41,7 +40,7 @@ public class Sorrowmoss extends Plant {
 		super.activate( ch );
 		
 		if (ch != null) {
-			Buff.affect( ch, Poison.class ).set( 5 + Math.min( Dungeon.depth, 15 ) );
+			Buff.affect( ch, Poison.class ).set( Poison.durationFactor( ch ) * (4 + Dungeon.depth / 2) );
 		}
 		
 		if (Dungeon.visible[pos]) {
diff --git a/core/src/com/watabou/pixeldungeon/plants/Sungrass.java b/core/src/com/watabou/pixeldungeon/plants/Sungrass.java
index c1a1e82..2d6ea82 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Sungrass.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Sungrass.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java b/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java
index ec7bf8b..dc00af6 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -77,11 +76,15 @@ public class AboutScene extends PixelScene {
 		archs.setSize( Camera.main.width, Camera.main.height );
 		addToBack( archs );
 		
+		ExitButton btnExit = new ExitButton();
+		btnExit.setPos( Camera.main.width - btnExit.width(), 0 );
+		add( btnExit );
+		
 		fadeIn();
 	}
 	
 	@Override
 	protected void onBackPressed() {
-		Game.switchScene( TitleScene.class );
+		PixelDungeon.switchNoFade( TitleScene.class );
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/scenes/AmuletScene.java b/core/src/com/watabou/pixeldungeon/scenes/AmuletScene.java
index 2de7870..cc8e265 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/AmuletScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/AmuletScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -23,6 +22,7 @@ import com.watabou.noosa.Game;
 import com.watabou.noosa.Image;
 import com.watabou.pixeldungeon.Assets;
 import com.watabou.pixeldungeon.Dungeon;
+import com.watabou.pixeldungeon.ResultDescriptions;
 import com.watabou.pixeldungeon.effects.Flare;
 import com.watabou.pixeldungeon.effects.Speck;
 import com.watabou.pixeldungeon.ui.RedButton;
@@ -66,6 +66,7 @@ public class AmuletScene extends PixelScene {
 		RedButton btnExit = new RedButton( TXT_EXIT ) {
 			@Override
 			protected void onClick() {
+				Dungeon.win( ResultDescriptions.WIN );
 				Dungeon.deleteGame( Dungeon.hero.heroClass, true );
 				Game.switchScene( noText ? TitleScene.class : RankingsScene.class );
 			}
diff --git a/core/src/com/watabou/pixeldungeon/scenes/BadgesScene.java b/core/src/com/watabou/pixeldungeon/scenes/BadgesScene.java
index 55579c1..2d33043 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/BadgesScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/BadgesScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -19,14 +18,15 @@ package com.watabou.pixeldungeon.scenes;
 
 import com.watabou.noosa.BitmapText;
 import com.watabou.noosa.Camera;
-import com.watabou.noosa.Game;
 import com.watabou.noosa.NinePatch;
 import com.watabou.noosa.audio.Music;
 import com.watabou.pixeldungeon.Assets;
 import com.watabou.pixeldungeon.Badges;
 import com.watabou.pixeldungeon.Chrome;
+import com.watabou.pixeldungeon.PixelDungeon;
 import com.watabou.pixeldungeon.ui.Archs;
 import com.watabou.pixeldungeon.ui.BadgesList;
+import com.watabou.pixeldungeon.ui.ExitButton;
 import com.watabou.pixeldungeon.ui.ScrollPane;
 import com.watabou.pixeldungeon.ui.Window;
 
@@ -51,8 +51,8 @@ public class BadgesScene extends PixelScene {
 		archs.setSize( w, h );
 		add( archs );
 		
-		int pw = Math.min( 160, w - 10 );
-		int ph = h - 24;
+		int pw = Math.min( 160, w - 6 );
+		int ph = h - 30;
 		
 		NinePatch panel = Chrome.get( Chrome.Type.WINDOW );
 		panel.size( pw, ph );
@@ -78,11 +78,15 @@ public class BadgesScene extends PixelScene {
 			panel.innerWidth(), 
 			panel.innerHeight() );
 		
+		ExitButton btnExit = new ExitButton();
+		btnExit.setPos( Camera.main.width - btnExit.width(), 0 );
+		add( btnExit );
+		
 		fadeIn();
 	}
 	
 	@Override
 	protected void onBackPressed() {
-		Game.switchScene( TitleScene.class );
+		PixelDungeon.switchNoFade( TitleScene.class );
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/scenes/CellSelector.java b/core/src/com/watabou/pixeldungeon/scenes/CellSelector.java
index 598e8dd..6e1feac 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/CellSelector.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/CellSelector.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -191,7 +190,7 @@ public class CellSelector extends TouchArea<GameAction> {
 			int zoom = Math.round( camera.zoom );
 			camera.zoom( zoom );
 			PixelDungeon.zoom( (int)(zoom - PixelScene.defaultZoom) );
-			
+
 			dragging = true;
 			if (t == touch) {
 				touch = another;
diff --git a/core/src/com/watabou/pixeldungeon/scenes/GameScene.java b/core/src/com/watabou/pixeldungeon/scenes/GameScene.java
index a2c08f1..730932e 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/GameScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/GameScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/InterlevelScene.java b/core/src/com/watabou/pixeldungeon/scenes/InterlevelScene.java
index 091470a..bfbb914 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/InterlevelScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/InterlevelScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -221,7 +220,7 @@ public class InterlevelScene extends PixelScene {
 			
 		case FADE_OUT:
 			message.alpha( p );
-
+			
 			if (mode == Mode.CONTINUE || (mode == Mode.DESCEND && Dungeon.depth == 1)) {
 				Music.INSTANCE.volume( p );
 			}
@@ -238,6 +237,7 @@ public class InterlevelScene extends PixelScene {
 						Game.switchScene( StartScene.class );
 					};
 				} );
+				error = null;
 			}
 			break;
 		}
diff --git a/core/src/com/watabou/pixeldungeon/scenes/IntroScene.java b/core/src/com/watabou/pixeldungeon/scenes/IntroScene.java
index a28d32e..6ab063d 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/IntroScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/IntroScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/PixelScene.java b/core/src/com/watabou/pixeldungeon/scenes/PixelScene.java
index 5910b46..26fc9ef 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/PixelScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/PixelScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -235,8 +234,13 @@ public class PixelScene extends Scene {
 		v.y = align( c, v.y );
 	}
 	
+	public static boolean noFade = false;
 	protected void fadeIn() {
-		fadeIn( 0xFF000000, false );
+		if (noFade) {
+			noFade = false;
+		} else {
+			fadeIn( 0xFF000000, false );
+		}
 	}
 	
 	protected void fadeIn( int color, boolean light ) {
diff --git a/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java b/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java
index 9d383d4..ff06a31 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -111,12 +110,16 @@ public class RankingsScene extends PixelScene {
 			
 		}
 		
+		ExitButton btnExit = new ExitButton();
+		btnExit.setPos( Camera.main.width - btnExit.width(), 0 );
+		add( btnExit );
+		
 		fadeIn();
 	}
 	
 	@Override
 	protected void onBackPressed() {
-		Game.switchScene( TitleScene.class );
+		PixelDungeon.switchNoFade( TitleScene.class );
 	}
 	
 	public static class Record extends Button<GameAction> {
diff --git a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
index 024bebc..2135b72 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -72,18 +71,13 @@ public class StartScene extends PixelScene {
 	
 	private static final String TXT_UNLOCK	= "To unlock this character class, slay the 3rd boss with any other class";
 	
-	private float width;
-	private float height;
-	private float top;
-	private float left;
+	private static final String TXT_WIN_THE_GAME = 
+		"To unlock \"Challenges\", win the game with any character class.";
 	
-	private static HashMap<HeroClass, GemButton> gems = new HashMap<HeroClass, StartScene.GemButton>();
+	private static final float WIDTH = 116;
+	private static final float HEIGHT = 220;
 	
-	private Avatar avatar;
-	private NinePatch frame;
-	private BitmapText className;
-	
-	private SimpleButton btnMastery;
+	private static HashMap<HeroClass, ClassShield> shields = new HashMap<HeroClass, ClassShield>();
 	
 	private GameButton btnLoad;
 	private GameButton btnNewGame;
@@ -104,47 +98,20 @@ public class StartScene extends PixelScene {
 		
 		int w = Camera.main.width;
 		int h = Camera.main.height;
-		
-		width = 128;
-		height = 220;
-		left = (w - width) / 2;
-		top = (h - height) / 2; 
+
+		float left = (w - WIDTH) / 2;
+		float top = (h - HEIGHT) / 2; 
+		float bottom = h - top;
 		
 		Archs archs = new Archs();
 		archs.setSize( w, h );
-		add( archs );
+		add( archs ); 
 		
-		BitmapText title = PixelScene.createText( TXT_TITLE, 9 );
-		title.hardlight( Window.TITLE_COLOR );
-		title.measure();
+		Image title = BannerSprites.get( Type.SELECT_YOUR_HERO );
 		title.x = align( (w - title.width()) / 2 );
-		title.y = align( top );
+		title.y = top;
 		add( title );
 		
-		float pos = title.y + title.height() + GAP;
-		
-		GemButton btns[] = {
-			new GemButton( HeroClass.WARRIOR ), 
-			new GemButton( HeroClass.MAGE ), 
-			new GemButton( HeroClass.ROGUE ), 
-			new GemButton( HeroClass.HUNTRESS ) };
-		
-		float space = width;
-		for (GemButton btn : btns) {
-			space -= btn.width();
-		}
-		
-		float p = 0;
-		for (GemButton btn : btns) {
-			add( btn );
-			btn.setPos( align( left + p ), align( pos ) );
-			p += btn.width() + space / 3;
-		}
-		
-		
-		frame = Chrome.get( Chrome.Type.TOAST_TR );
-		add( frame );
-		
 		btnNewGame = new GameButton( TXT_NEW ) {
 			@Override
 			protected void onClick() {
@@ -255,6 +222,10 @@ public class StartScene extends PixelScene {
 			}
 		}
 		
+		ExitButton btnExit = new ExitButton();
+		btnExit.setPos( Camera.main.width - btnExit.width(), 0 );
+		add( btnExit );
+		
 		curClass = null;
 		updateClass( HeroClass.values()[PixelDungeon.lastClass()] );
 		
@@ -264,24 +235,22 @@ public class StartScene extends PixelScene {
 	private void updateClass( HeroClass cl ) {
 		
 		if (curClass == cl) {
+			add( new WndClass( cl ) );
 			return;
 		}
 		
 		if (curClass != null) {
-			gems.get( curClass ).highlight( false );
+			shields.get( curClass ).highlight( false );
 		}
-		
-		gems.get( curClass = cl ).highlight( true );
-		
-		className.text( Utils.capitalize( cl.title() ) );
-		className.measure();
-		className.x = align( frame.center().x - className.width() / 2 );
+		shields.get( curClass = cl ).highlight( true );
 		
 		if (cl != HeroClass.HUNTRESS || huntressUnlocked) {
 		
 			unlock.visible = false;
+			 
+			float buttonPos = (Camera.main.height + HEIGHT) / 2 - BUTTON_HEIGHT;
 			
-			float buttonPos = frame.y + frame.innerBottom() - BUTTON_HEIGHT;
+			float left = (Camera.main.width - WIDTH) / 2;
 			
 			GamesInProgress.Info info = GamesInProgress.check( curClass );
 			if (info != null) {
@@ -291,10 +260,10 @@ public class StartScene extends PixelScene {
 				btnNewGame.visible = true;
 				btnNewGame.secondary( TXT_ERASE );
 				
-				float w = (frame.innerWidth() - GAP) / 2;
+				float w = (WIDTH - GAP) / 2;
 				
 				btnLoad.setRect(
-					frame.x + frame.marginLeft(), buttonPos, w, BUTTON_HEIGHT );
+					left, buttonPos, w, BUTTON_HEIGHT );
 				btnNewGame.setRect(
 					btnLoad.right() + GAP, buttonPos, w, BUTTON_HEIGHT );
 				
@@ -303,39 +272,16 @@ public class StartScene extends PixelScene {
 				
 				btnNewGame.visible = true;
 				btnNewGame.secondary( null );
-				btnNewGame.setRect(
-					frame.x + frame.marginLeft(), buttonPos, frame.innerWidth(), BUTTON_HEIGHT );
-			}
-			
-			Badges.Badge badgeToCheck = null;
-			switch (curClass) {
-			case WARRIOR:
-				badgeToCheck = Badges.Badge.MASTERY_WARRIOR;
-				break;
-			case MAGE:
-				badgeToCheck = Badges.Badge.MASTERY_MAGE;
-				break;
-			case ROGUE:
-				badgeToCheck = Badges.Badge.MASTERY_ROGUE;
-				break;
-			case HUNTRESS:
-				badgeToCheck = Badges.Badge.MASTERY_HUNTRESS;
-				break;
+				btnNewGame.setRect( left, buttonPos, WIDTH, BUTTON_HEIGHT );
 			}
-			btnMastery.active = 
-			btnMastery.visible = 
-				Badges.isUnlocked( badgeToCheck );
 			
 		} else {
 			
 			unlock.visible = true;
 			btnLoad.visible = false;
 			btnNewGame.visible = false;
-			btnMastery.active = btnMastery.visible = false;
 			
 		}
-		
-		avatar.selectClass( curClass );
 	}
 	
 	private void startNewGame() {
diff --git a/core/src/com/watabou/pixeldungeon/scenes/SurfaceScene.java b/core/src/com/watabou/pixeldungeon/scenes/SurfaceScene.java
index 7f7a431..190e159 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/SurfaceScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/SurfaceScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -29,6 +28,7 @@ import com.watabou.noosa.ColorBlock;
 import com.watabou.noosa.Game;
 import com.watabou.noosa.Group;
 import com.watabou.noosa.Image;
+import com.watabou.noosa.MovieClip;
 import com.watabou.noosa.NoosaScript;
 import com.watabou.noosa.TextureFilm;
 import com.watabou.noosa.TouchArea;
@@ -38,7 +38,6 @@ import com.watabou.pixeldungeon.Assets;
 import com.watabou.pixeldungeon.Badges;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.hero.HeroClass;
-import com.watabou.pixeldungeon.sprites.RatSprite;
 import com.watabou.pixeldungeon.ui.Archs;
 import com.watabou.pixeldungeon.ui.RedButton;
 import com.watabou.utils.Point;
@@ -114,8 +113,6 @@ public class SurfaceScene extends PixelScene {
 		}
 		
 		Avatar a = new Avatar( Dungeon.hero.heroClass );
-		// Removing semitransparent contour
-		a.am = 2; a.aa = -1;
 		a.x = PixelScene.align( (WIDTH - a.width) / 2 );
 		a.y = HEIGHT - a.height + 1;
 		window.add( a );
@@ -295,7 +292,7 @@ public class SurfaceScene extends PixelScene {
 	private static class Avatar extends Image {
 		
 		private static final int WIDTH	= 24;
-		private static final int HEIGHT	= 32;
+		private static final int HEIGHT	= 28;
 		
 		public Avatar( HeroClass cl ) {
 			super( Assets.AVATARS );
@@ -303,16 +300,35 @@ public class SurfaceScene extends PixelScene {
 		}
 	}
 	
-	private static class Pet extends RatSprite {
+	private static class Pet extends MovieClip implements MovieClip.Listener {
+		
+		private Animation idle;
+		private Animation jump;
+		
+		public Pet() {
+			super( Assets.PET );
+			
+			TextureFilm frames = new TextureFilm( texture, 16, 16 );
+			
+			idle = new Animation( 2, true );
+			idle.frames( frames, 0, 0, 0, 0, 0, 0, 1 );
+			
+			jump = new Animation( 10, false );
+			jump.frames( frames, 2, 3, 4, 5, 6 );
+			
+			listener = this;
+			
+			play( idle );
+		}
 		
 		public void jump() {
-			play( run );
+			play( jump );
 		}
 		
 		@Override
 		public void onComplete( Animation anim ) {
-			if (anim == run) {
-				idle();
+			if (anim == jump) {
+				play( idle );
 			}
 		}
 	}
diff --git a/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java b/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java
index 3c31368..07fc9a0 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -69,7 +68,7 @@ public class TitleScene extends PixelScene {
 		DashboardItem btnBadges = new DashboardItem( TXT_BADGES, 3 ) {
 			@Override
 			protected void onClick() {
-				Game.switchScene( BadgesScene.class );
+				PixelDungeon.switchNoFade( BadgesScene.class );
 			}
 		};
 		btnBadges.setPos( w / 2 - btnBadges.width(), (h + height) / 2 - DashboardItem.SIZE );
@@ -78,7 +77,7 @@ public class TitleScene extends PixelScene {
 		DashboardItem btnAbout = new DashboardItem( TXT_ABOUT, 1 ) {
 			@Override
 			protected void onClick() {
-				Game.switchScene( AboutScene.class );
+				PixelDungeon.switchNoFade( AboutScene.class );
 			}
 		};
 		btnAbout.setPos( w / 2, (h + height) / 2 - DashboardItem.SIZE );
@@ -87,7 +86,7 @@ public class TitleScene extends PixelScene {
 		DashboardItem btnPlay = new DashboardItem( TXT_PLAY, 0 ) {
 			@Override
 			protected void onClick() {
-				Game.switchScene( StartScene.class );
+				PixelDungeon.switchNoFade( StartScene.class );
 			}
 		};
 		btnPlay.setPos( w / 2 - btnPlay.width(), btnAbout.top() - DashboardItem.SIZE );
@@ -96,7 +95,7 @@ public class TitleScene extends PixelScene {
 		DashboardItem btnHighscores = new DashboardItem( TXT_HIGHSCORES, 2 ) {
 			@Override
 			protected void onClick() {
-				Game.switchScene( RankingsScene.class );
+				PixelDungeon.switchNoFade( RankingsScene.class );
 			}
 		};
 		btnHighscores.setPos( w / 2, btnPlay.top() );
@@ -110,9 +109,13 @@ public class TitleScene extends PixelScene {
 		add( version );
 		
 		PrefsButton btnPrefs = new PrefsButton();
-		btnPrefs.setPos( w - btnPrefs.width() - 1, 1 );
+		btnPrefs.setPos( 0, 0 );
 		add( btnPrefs );
 		
+		ExitButton btnExit = new ExitButton();
+		btnExit.setPos( w - btnExit.width(), 0 );
+		add( btnExit );
+		
 		fadeIn();
 	}
 	
diff --git a/core/src/com/watabou/pixeldungeon/sprites/AcidicSprite.java b/core/src/com/watabou/pixeldungeon/sprites/AcidicSprite.java
index eeac79c..49558e7 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/AcidicSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/AcidicSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/AlbinoSprite.java b/core/src/com/watabou/pixeldungeon/sprites/AlbinoSprite.java
index 473dcec..ba405d8 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/AlbinoSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/AlbinoSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BanditSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BanditSprite.java
index a4d8cc6..b6ac238 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BanditSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BanditSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BatSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BatSprite.java
index 050e139..e3aef16 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BatSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BatSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BlacksmithSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BlacksmithSprite.java
index fb8e6be..b6f485f 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BlacksmithSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BlacksmithSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BruteSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BruteSprite.java
index 90ccc92..17947d4 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BruteSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BruteSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BurningFistSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BurningFistSprite.java
index ae56f1d..c636d51 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BurningFistSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BurningFistSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/CharSprite.java b/core/src/com/watabou/pixeldungeon/sprites/CharSprite.java
index 24981b9..74b5a12 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/CharSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/CharSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -83,6 +82,9 @@ public class CharSprite extends MovieClip implements Tweener.Listener, MovieClip
 	// Char owner
 	public Char ch;
 	
+	// The sprite is currently in motion
+	public boolean isMoving = false;
+	
 	public CharSprite() {
 		super();
 		listener = this;
@@ -135,12 +137,16 @@ public class CharSprite extends MovieClip implements Tweener.Listener, MovieClip
 		motion = new PosTweener( this, worldToCamera( to ), MOVE_INTERVAL );
 		motion.listener = this;
 		parent.add( motion );
+
+		isMoving = true;
 		
 		turnTo( from , to );
 		
 		if (visible && Level.water[from] && !ch.flying) {
 			GameScene.ripple( from );
 		}
+		
+		ch.onMotionComplete();
 	}
 	
 	public void interruptMotion() {
@@ -376,9 +382,11 @@ public class CharSprite extends MovieClip implements Tweener.Listener, MovieClip
 	@Override
 	public void onComplete( Tweener tweener ) {
 		if (tweener == motion) {
+			
+			isMoving = false;
+			
 			motion.killAndErase();
 			motion = null;
-			ch.onMotionComplete();
 		}
 	}
 
diff --git a/core/src/com/watabou/pixeldungeon/sprites/CrabSprite.java b/core/src/com/watabou/pixeldungeon/sprites/CrabSprite.java
index f06c2f5..dc12ea3 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/CrabSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/CrabSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/DM300Sprite.java b/core/src/com/watabou/pixeldungeon/sprites/DM300Sprite.java
index 29527ef..7e464fa 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/DM300Sprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/DM300Sprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/DiscardedItemSprite.java b/core/src/com/watabou/pixeldungeon/sprites/DiscardedItemSprite.java
index 1f14ba9..20ebaee 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/DiscardedItemSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/DiscardedItemSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ElementalSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ElementalSprite.java
index a74a358..c002bdb 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ElementalSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ElementalSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/EyeSprite.java b/core/src/com/watabou/pixeldungeon/sprites/EyeSprite.java
index f56bd60..3fde2dd 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/EyeSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/EyeSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/FetidRatSprite.java b/core/src/com/watabou/pixeldungeon/sprites/FetidRatSprite.java
index 3942f40..5392aaf 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/FetidRatSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/FetidRatSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/GhostSprite.java b/core/src/com/watabou/pixeldungeon/sprites/GhostSprite.java
index 340708f..ee58ab7 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/GhostSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/GhostSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/GnollSprite.java b/core/src/com/watabou/pixeldungeon/sprites/GnollSprite.java
index a4bc706..37812af 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/GnollSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/GnollSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/GolemSprite.java b/core/src/com/watabou/pixeldungeon/sprites/GolemSprite.java
index 7179e9d..08cefb0 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/GolemSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/GolemSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/GooSprite.java b/core/src/com/watabou/pixeldungeon/sprites/GooSprite.java
index ae730e8..e42eccf 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/GooSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/GooSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java b/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java
index bc1bf3b..6554fb0 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -39,6 +38,9 @@ public class HeroSprite extends CharSprite {
 	
 	private Animation fly;
 	
+	private Tweener jumpTweener;
+	private Callback jumpCallback;
+	
 	public HeroSprite() {
 		super();
 		
@@ -90,6 +92,34 @@ public class HeroSprite extends CharSprite {
 		Camera.main.target = this;
 	}
 	
+	public void jump( int from, int to, Callback callback ) {	
+		jumpCallback = callback;
+		
+		int distance = Level.distance( from, to );
+		jumpTweener = new JumpTweener( this, worldToCamera( to ), distance * 4, distance * 0.1f );
+		jumpTweener.listener = this;
+		parent.add( jumpTweener );
+		
+		turnTo( from, to );
+		play( fly );
+	}
+	
+	@Override
+	public void onComplete( Tweener tweener ) {
+		if (tweener == jumpTweener) {
+			
+			if (visible && Level.water[ch.pos] && !ch.flying) {
+				GameScene.ripple( ch.pos );
+			}
+			if (jumpCallback != null) {
+				jumpCallback.call();
+			}
+			
+		} else {
+			super.onComplete( tweener );
+		}
+	}
+	
 	@Override
 	public void update() {
 		sleeping = ((Hero)ch).restoreHealth;
@@ -123,4 +153,28 @@ public class HeroSprite extends CharSprite {
 		return avatar;
 	}
 
+	private static class JumpTweener extends Tweener {
+
+		public Visual visual;
+		
+		public PointF start;
+		public PointF end;
+		
+		public float height;
+		
+		public JumpTweener( Visual visual, PointF pos, float height, float time ) {
+			super( visual, time );
+			
+			this.visual = visual;
+			start = visual.point();
+			end = pos;
+
+			this.height = height;
+		}
+
+		@Override
+		protected void updateValues( float progress ) {
+			visual.point( PointF.inter( start, end, progress ).offset( 0, -height * 4 * progress * (1 - progress) ) );
+		}
+	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ImpSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ImpSprite.java
index abd6ede..7f2912d 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ImpSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ImpSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java
index 858ef85..a90df16 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -140,6 +139,9 @@ public class ItemSprite extends MovieClip {
 			place( from );
 	
 			speed.offset( (px-x) / DROP_INTERVAL, (py-y) / DROP_INTERVAL );
+			
+			Log.d( "GAME", toString() );
+			Log.d( "GAME", String.format( "drop aside: %.1f %.1f", speed.x, speed.y ) );
 		}
 	}
 	
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ItemSpriteSheet.java b/core/src/com/watabou/pixeldungeon/sprites/ItemSpriteSheet.java
index f0b5a51..6897297 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ItemSpriteSheet.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ItemSpriteSheet.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -124,7 +123,7 @@ public class ItemSpriteSheet {
 	public static final int SEED_FIREBLOOM	= 88;
 	public static final int SEED_ICECAP		= 89;
 	public static final int SEED_SORROWMOSS	= 90;
-	public static final int SEED_BLINDWEED	= 91;
+	public static final int SEED_DREAMWEED	= 91;
 	public static final int SEED_SUNGRASS	= 92;
 	public static final int SEED_EARTHROOT	= 93;
 	public static final int SEED_FADELEAF	= 94;
@@ -169,4 +168,5 @@ public class ItemSpriteSheet {
 	public static final int KIT		= 86;
 	public static final int AMULET	= 87;
 	public static final int VIAL	= 120;
+	public static final int WEIGHT	= 123;
 }
diff --git a/core/src/com/watabou/pixeldungeon/sprites/KingSprite.java b/core/src/com/watabou/pixeldungeon/sprites/KingSprite.java
index 30b45ae..b067f2c 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/KingSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/KingSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/LarvaSprite.java b/core/src/com/watabou/pixeldungeon/sprites/LarvaSprite.java
index bb11bd4..2212ea4 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/LarvaSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/LarvaSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/MirrorSprite.java b/core/src/com/watabou/pixeldungeon/sprites/MirrorSprite.java
index 0f9335a..047501b 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/MirrorSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/MirrorSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/MissileSprite.java b/core/src/com/watabou/pixeldungeon/sprites/MissileSprite.java
index 2b3f460..c184163 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/MissileSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/MissileSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -57,10 +56,14 @@ public class MissileSprite extends ItemSprite implements Tweener.Listener {
 		speed.set( d ).normalize().scale( SPEED );
 		
 		if (image == 31 || image == 108 || image == 109 || image == 110) {
+
 			angularSpeed = 0;
 			angle = 135 - (float)(Math.atan2( d.x, d.y ) / 3.1415926 * 180);
+			
 		} else {
+			
 			angularSpeed = image == 15 || image == 106 ? 1440 : 720;
+			
 		}
 		
 		PosTweener tweener = new PosTweener( this, dest, d.length() / SPEED );
diff --git a/core/src/com/watabou/pixeldungeon/sprites/MobSprite.java b/core/src/com/watabou/pixeldungeon/sprites/MobSprite.java
index bbe59b0..9301535 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/MobSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/MobSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -31,8 +30,7 @@ public class MobSprite extends CharSprite {
 	
 	@Override
 	public void update() {
-		sleeping = ch != null && ((Mob)ch).state == Mob.State.SLEEPING;
-		
+		sleeping = ch != null && ((Mob)ch).state == ((Mob)ch).SLEEPEING;
 		super.update();
 	}
 	
diff --git a/core/src/com/watabou/pixeldungeon/sprites/MonkSprite.java b/core/src/com/watabou/pixeldungeon/sprites/MonkSprite.java
index 6dedb1d..be75d80 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/MonkSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/MonkSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/PiranhaSprite.java b/core/src/com/watabou/pixeldungeon/sprites/PiranhaSprite.java
index 77d1285..3d55f61 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/PiranhaSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/PiranhaSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/PlantSprite.java b/core/src/com/watabou/pixeldungeon/sprites/PlantSprite.java
index e4acaa4..9fdae8f 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/PlantSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/PlantSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -23,8 +22,8 @@ import com.watabou.noosa.TextureFilm;
 import com.watabou.pixeldungeon.Assets;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.DungeonTilemap;
-import com.watabou.pixeldungeon.levels.Level;
 import com.watabou.pixeldungeon.plants.Plant;
+import com.watabou.utils.PointF;
 
 public class PlantSprite extends Image {
 
@@ -65,8 +64,9 @@ public class PlantSprite extends Image {
 		alpha( 1f );
 		
 		pos = plant.pos;
-		x = pos % Level.WIDTH * DungeonTilemap.SIZE;
-		y = pos / Level.WIDTH * DungeonTilemap.SIZE;
+		PointF p = DungeonTilemap.tileToWorld( plant.pos );
+		x = p.x;
+		y = p.y;
 		
 		state = State.GROWING;
 		time = DELAY;
diff --git a/core/src/com/watabou/pixeldungeon/sprites/RatKingSprite.java b/core/src/com/watabou/pixeldungeon/sprites/RatKingSprite.java
index c0350bf..12a9839 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/RatKingSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/RatKingSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/RatSprite.java b/core/src/com/watabou/pixeldungeon/sprites/RatSprite.java
index 5cf5494..735f148 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/RatSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/RatSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/RottingFistSprite.java b/core/src/com/watabou/pixeldungeon/sprites/RottingFistSprite.java
index 76872c5..96d693d 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/RottingFistSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/RottingFistSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ScorpioSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ScorpioSprite.java
index c730ca2..4d10d5a 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ScorpioSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ScorpioSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SeniorSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SeniorSprite.java
index c32d2d4..759ead3 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SeniorSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SeniorSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ShamanSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ShamanSprite.java
index 8aefaf3..2f8d1bd 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ShamanSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ShamanSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SheepSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SheepSprite.java
index bd733e9..e2ab3cd 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SheepSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SheepSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ShieldedSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ShieldedSprite.java
index 705232b..0958c0b 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ShieldedSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ShieldedSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ShopkeeperSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ShopkeeperSprite.java
index a7094e0..8c85773 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ShopkeeperSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ShopkeeperSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SkeletonSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SkeletonSprite.java
index 4340d0d..590584d 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SkeletonSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SkeletonSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SpinnerSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SpinnerSprite.java
index 87f73c5..3f503e6 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SpinnerSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SpinnerSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/StatueSprite.java b/core/src/com/watabou/pixeldungeon/sprites/StatueSprite.java
index 39be305..f7034f2 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/StatueSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/StatueSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SuccubusSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SuccubusSprite.java
index 95fd8cd..04d11d1 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SuccubusSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SuccubusSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SwarmSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SwarmSprite.java
index d9a97ef..bae1938 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SwarmSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SwarmSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/TenguSprite.java b/core/src/com/watabou/pixeldungeon/sprites/TenguSprite.java
index 16fd336..5f2f0ca 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/TenguSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/TenguSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -60,9 +59,13 @@ public class TenguSprite extends MobSprite {
 		play( run );
 		turnTo( from , to );
 		
+		isMoving = true;
+		
 		if (Level.water[to]) {
 			GameScene.ripple( to );
 		}
+		
+		ch.onMotionComplete();
 	}
 	
 	@Override
@@ -90,8 +93,8 @@ public class TenguSprite extends MobSprite {
 	@Override
 	public void onComplete( Animation anim ) {
 		if (anim == run) {
+			isMoving = false;
 			idle();
-			ch.onMotionComplete();
 		} else {
 			super.onComplete( anim );
 		}
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ThiefSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ThiefSprite.java
index b1cb86f..33085f6 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ThiefSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ThiefSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/UndeadSprite.java b/core/src/com/watabou/pixeldungeon/sprites/UndeadSprite.java
index 52c5d5d..0db8e93 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/UndeadSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/UndeadSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/WandmakerSprite.java b/core/src/com/watabou/pixeldungeon/sprites/WandmakerSprite.java
index a736878..f4156fd 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/WandmakerSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/WandmakerSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/WarlockSprite.java b/core/src/com/watabou/pixeldungeon/sprites/WarlockSprite.java
index 21c51ab..d631e85 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/WarlockSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/WarlockSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/WraithSprite.java b/core/src/com/watabou/pixeldungeon/sprites/WraithSprite.java
index 1364948..78976ff 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/WraithSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/WraithSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/YogSprite.java b/core/src/com/watabou/pixeldungeon/sprites/YogSprite.java
index 848f324..68c54c5 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/YogSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/YogSprite.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Archs.java b/core/src/com/watabou/pixeldungeon/ui/Archs.java
index 6457967..e3bfab9 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Archs.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Archs.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -29,14 +28,19 @@ public class Archs extends Component {
 	private SkinnedBlock arcsBg;
 	private SkinnedBlock arcsFg;
 	
+	private static float offsB = 0;
+	private static float offsF = 0;
+	
 	public boolean reversed = false;
 	
 	@Override
 	protected void createChildren() {
 		arcsBg = new SkinnedBlock( 1, 1, Assets.ARCS_BG );
+		arcsBg.offsetTo( 0,  offsB );
 		add( arcsBg );
 		
 		arcsFg = new SkinnedBlock( 1, 1, Assets.ARCS_FG );
+		arcsFg.offsetTo( 0,  offsF );
 		add( arcsFg );
 	}
 	
@@ -61,5 +65,8 @@ public class Archs extends Component {
 		
 		arcsBg.offset( 0, shift );
 		arcsFg.offset( 0, shift * 2 );
+		
+		offsB = arcsBg.offsetY();
+		offsF = arcsFg.offsetY();
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/ui/AttackIndicator.java b/core/src/com/watabou/pixeldungeon/ui/AttackIndicator.java
index 240fbc3..1b42f44 100644
--- a/core/src/com/watabou/pixeldungeon/ui/AttackIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/AttackIndicator.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/BadgesList.java b/core/src/com/watabou/pixeldungeon/ui/BadgesList.java
index 044f6d0..b8a887f 100644
--- a/core/src/com/watabou/pixeldungeon/ui/BadgesList.java
+++ b/core/src/com/watabou/pixeldungeon/ui/BadgesList.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Banner.java b/core/src/com/watabou/pixeldungeon/ui/Banner.java
index 2dcb59d..e38b580 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Banner.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Banner.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/BuffIndicator.java b/core/src/com/watabou/pixeldungeon/ui/BuffIndicator.java
index 080edc0..10067aa 100644
--- a/core/src/com/watabou/pixeldungeon/ui/BuffIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/BuffIndicator.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -62,6 +61,7 @@ public class BuffIndicator extends Component {
 	public static final int BLEEDING	= 26;
 	public static final int MARK		= 27;
 	public static final int DEFERRED	= 28;
+	public static final int VERTIGO		= 29;
 	
 	public static final int SIZE	= 7;
 	
diff --git a/core/src/com/watabou/pixeldungeon/ui/BusyIndicator.java b/core/src/com/watabou/pixeldungeon/ui/BusyIndicator.java
index 3486aa0..c461154 100644
--- a/core/src/com/watabou/pixeldungeon/ui/BusyIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/BusyIndicator.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/CheckBox.java b/core/src/com/watabou/pixeldungeon/ui/CheckBox.java
index e736891..c65775c 100644
--- a/core/src/com/watabou/pixeldungeon/ui/CheckBox.java
+++ b/core/src/com/watabou/pixeldungeon/ui/CheckBox.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Compass.java b/core/src/com/watabou/pixeldungeon/ui/Compass.java
index 8bba032..3f29c21 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Compass.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Compass.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/DangerIndicator.java b/core/src/com/watabou/pixeldungeon/ui/DangerIndicator.java
index 51b5d2a..e7f7ac9 100644
--- a/core/src/com/watabou/pixeldungeon/ui/DangerIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/DangerIndicator.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -80,11 +79,11 @@ public class DangerIndicator extends Tag {
 			int v =  Dungeon.hero.visibleEnemies();
 			if (v != lastNumber) {
 				lastNumber = v;
-				if (visible = (lastNumber > 0)) {
+				if (visible = lastNumber > 0) {
 					number.text( Integer.toString( lastNumber ) );
 					number.measure();
 					placeNumber();
-
+					
 					flash();
 				}
 			}
diff --git a/core/src/com/watabou/pixeldungeon/ui/ExitButton.java b/core/src/com/watabou/pixeldungeon/ui/ExitButton.java
new file mode 100644
index 0000000..0346ae1
--- /dev/null
+++ b/core/src/com/watabou/pixeldungeon/ui/ExitButton.java
@@ -0,0 +1,73 @@
+/*
+ * Copyright (C) 2012-2014  Oleg Dolya
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>
+ */
+package com.watabou.pixeldungeon.ui;
+
+import com.watabou.noosa.Game;
+import com.watabou.noosa.Image;
+import com.watabou.noosa.audio.Sample;
+import com.watabou.noosa.ui.Button;
+import com.watabou.pixeldungeon.Assets;
+import com.watabou.pixeldungeon.PixelDungeon;
+import com.watabou.pixeldungeon.scenes.TitleScene;
+
+public class ExitButton extends Button {
+	
+	private Image image;
+	
+	public ExitButton() {
+		super();
+		
+		width = image.width;
+		height = image.height;
+	}
+	
+	@Override
+	protected void createChildren() {
+		super.createChildren();
+		
+		image = Icons.EXIT.get();
+		add( image );
+	}
+	
+	@Override
+	protected void layout() {
+		super.layout();
+		
+		image.x = x;
+		image.y = y;
+	}
+	
+	@Override
+	protected void onTouchDown() {
+		image.brightness( 1.5f );
+		Sample.INSTANCE.play( Assets.SND_CLICK );
+	}
+	
+	@Override
+	protected void onTouchUp() {
+		image.resetColor();
+	}
+	
+	@Override
+	protected void onClick() {
+		if (Game.scene() instanceof TitleScene) {
+			Game.instance.finish();
+		} else {
+			PixelDungeon.switchNoFade( TitleScene.class );
+		}
+	}
+}
diff --git a/core/src/com/watabou/pixeldungeon/ui/GameLog.java b/core/src/com/watabou/pixeldungeon/ui/GameLog.java
index 188a84b..52e3d2a 100644
--- a/core/src/com/watabou/pixeldungeon/ui/GameLog.java
+++ b/core/src/com/watabou/pixeldungeon/ui/GameLog.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -96,7 +95,7 @@ public class GameLog extends Component implements Signal.Listener<String> {
 	}
 	
 	@Override
-	protected void layout() {	
+	protected void layout() {
 		float pos = y;
 		for (int i=length-1; i >= 0; i--) {
 			BitmapTextMultiline entry = (BitmapTextMultiline)members.get( i );
diff --git a/core/src/com/watabou/pixeldungeon/ui/GoldIndicator.java b/core/src/com/watabou/pixeldungeon/ui/GoldIndicator.java
index 8586eb4..858102d 100644
--- a/core/src/com/watabou/pixeldungeon/ui/GoldIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/GoldIndicator.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/HealthIndicator.java b/core/src/com/watabou/pixeldungeon/ui/HealthIndicator.java
index 6415569..8df196f 100644
--- a/core/src/com/watabou/pixeldungeon/ui/HealthIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/HealthIndicator.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Icons.java b/core/src/com/watabou/pixeldungeon/ui/Icons.java
index aedd8d4..28741b6 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Icons.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Icons.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -26,11 +25,9 @@ public enum Icons {
 	SKULL,
 	BUSY,
 	COMPASS,
-	INFO, 
 	PREFS,
 	WARNING,
 	TARGET,
-	MASTERY,
 	WATA,
 	WARRIOR,
 	MAGE,
@@ -47,7 +44,10 @@ public enum Icons {
 	SCROLL_HOLDER,
 	WAND_HOLSTER,
 	CHECKED,
-	UNCHECKED;
+	UNCHECKED,
+	EXIT,
+	CHALLENGE_OFF,
+	CHALLENGE_ON;
 	
 	public Image get() {
 		return get( this );
@@ -65,9 +65,6 @@ public enum Icons {
 		case COMPASS:
 			icon.frame( icon.texture.uvRect( 0, 8, 7, 13 ) );
 			break;
-		case INFO:
-			icon.frame( icon.texture.uvRect( 16, 0, 30, 14 ) );
-			break;
 		case PREFS:
 			icon.frame( icon.texture.uvRect( 30, 0, 46, 16 ) );
 			break;
@@ -77,9 +74,6 @@ public enum Icons {
 		case TARGET:
 			icon.frame( icon.texture.uvRect( 0, 13, 16, 29 ) );
 			break;
-		case MASTERY:
-			icon.frame( icon.texture.uvRect( 16, 14, 30, 28 ) );
-			break;
 		case WATA:
 			icon.frame( icon.texture.uvRect( 30, 16, 45, 26 ) );
 			break;
@@ -131,6 +125,15 @@ public enum Icons {
 		case UNCHECKED:
 			icon.frame( icon.texture.uvRect( 66, 12, 78, 24 ) );
 			break;
+		case EXIT:
+			icon.frame( icon.texture.uvRect( 98, 0, 114, 16 ) );
+			break;
+		case CHALLENGE_OFF:
+			icon.frame( icon.texture.uvRect( 78, 16, 102, 40 ) );
+			break;
+		case CHALLENGE_ON:
+			icon.frame( icon.texture.uvRect( 102, 16, 126, 40 ) );
+			break;
 		}
 		return icon;
 	}
diff --git a/core/src/com/watabou/pixeldungeon/ui/ItemSlot.java b/core/src/com/watabou/pixeldungeon/ui/ItemSlot.java
index 6e8003c..cda1172 100644
--- a/core/src/com/watabou/pixeldungeon/ui/ItemSlot.java
+++ b/core/src/com/watabou/pixeldungeon/ui/ItemSlot.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -48,7 +47,6 @@ public class ItemSlot extends Button<GameAction> {
 	private static final String TXT_TYPICAL_STR	= "%d?";
 	
 	private static final String TXT_LEVEL	= "%+d";
-	private static final String TXT_CURSED	= "";
 	
 	// Special items for containers
 	public static final Item CHEST = new Item() {
@@ -162,7 +160,7 @@ public class ItemSlot extends Button<GameAction> {
 			int level = item.visiblyUpgraded(); 
 
 			if (level != 0 || (item.cursed && item.cursedKnown)) {
-				bottomRight.text( item.levelKnown ? Utils.format( TXT_LEVEL, level ) : TXT_CURSED );
+				bottomRight.text( item.levelKnown ? Utils.format( TXT_LEVEL, level ) : "" );
 				bottomRight.measure();
 				bottomRight.hardlight( level > 0 ? UPGRADED : DEGRADED );
 			} else {
diff --git a/core/src/com/watabou/pixeldungeon/ui/LootIndicator.java b/core/src/com/watabou/pixeldungeon/ui/LootIndicator.java
index dfaeee3..734d862 100644
--- a/core/src/com/watabou/pixeldungeon/ui/LootIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/LootIndicator.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/PrefsButton.java b/core/src/com/watabou/pixeldungeon/ui/PrefsButton.java
index 38548fd..dd0dafd 100644
--- a/core/src/com/watabou/pixeldungeon/ui/PrefsButton.java
+++ b/core/src/com/watabou/pixeldungeon/ui/PrefsButton.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/QuickSlot.java b/core/src/com/watabou/pixeldungeon/ui/QuickSlot.java
index b084240..f7b5911 100644
--- a/core/src/com/watabou/pixeldungeon/ui/QuickSlot.java
+++ b/core/src/com/watabou/pixeldungeon/ui/QuickSlot.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/RedButton.java b/core/src/com/watabou/pixeldungeon/ui/RedButton.java
index 5edc3b8..ef9d980 100644
--- a/core/src/com/watabou/pixeldungeon/ui/RedButton.java
+++ b/core/src/com/watabou/pixeldungeon/ui/RedButton.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/ScrollPane.java b/core/src/com/watabou/pixeldungeon/ui/ScrollPane.java
index 31872d5..03549b4 100644
--- a/core/src/com/watabou/pixeldungeon/ui/ScrollPane.java
+++ b/core/src/com/watabou/pixeldungeon/ui/ScrollPane.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/SimpleButton.java b/core/src/com/watabou/pixeldungeon/ui/SimpleButton.java
index ad20805..74df5da 100644
--- a/core/src/com/watabou/pixeldungeon/ui/SimpleButton.java
+++ b/core/src/com/watabou/pixeldungeon/ui/SimpleButton.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/StatusPane.java b/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
index 731c6ca..444fcd4 100644
--- a/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
+++ b/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -23,7 +22,9 @@ import com.watabou.noosa.Camera;
 import com.watabou.noosa.Image;
 import com.watabou.noosa.NinePatch;
 import com.watabou.noosa.TouchArea;
+import com.watabou.noosa.audio.Sample;
 import com.watabou.noosa.particles.Emitter;
+import com.watabou.noosa.ui.Button;
 import com.watabou.noosa.ui.Component;
 import com.watabou.pixeldungeon.Assets;
 import com.watabou.pixeldungeon.Dungeon;
@@ -61,10 +62,12 @@ public class StatusPane extends Component {
 	private BuffIndicator buffs;
 	private Compass compass;
 	
+	private MenuButton btnMenu;
+	
 	@Override
 	protected void createChildren() {
 		
-		shield = new NinePatch( Assets.STATUS, 80, 0, 30, 0 );
+		shield = new NinePatch( Assets.STATUS, 80, 0, 30   + 18, 0 );
 		add( shield );
 		
 		add( new TouchArea<GameAction>( 0, 1, 30, 30 ) {
@@ -98,6 +101,9 @@ public class StatusPane extends Component {
 			}			
 		} );
 		
+		btnMenu = new MenuButton();
+		add( btnMenu );
+		
 		avatar = HeroSprite.avatar( Dungeon.hero.heroClass, lastTier );
 		add( avatar );
 		
@@ -157,7 +163,7 @@ public class StatusPane extends Component {
 		hp.x = 30;
 		hp.y = 3;
 		
-		depth.x = width - 24 - depth.width();
+		depth.x = width - 24 - depth.width()    - 18;
 		depth.y = 6;
 		
 		keys.y = 6;
@@ -167,6 +173,8 @@ public class StatusPane extends Component {
 		loot.setPos( width - loot.width(),  danger.bottom() + 2 );
 		
 		buffs.setPos( 32, 11 );
+		
+		btnMenu.setPos( width - btnMenu.width(), 1 );
 	}
 	
 	@Override
@@ -205,12 +213,12 @@ public class StatusPane extends Component {
 			level.y = PixelScene.align( 27.5f - level.baseLine() / 2 );
 		}
 		
-		int k = IronKey.curDepthQunatity;
+		int k = IronKey.curDethQuantity;
 		if (k != lastKeys) {
 			lastKeys = k;
 			keys.text( Integer.toString( lastKeys ) );
 			keys.measure();
-			keys.x = width - 8 - keys.width();
+			keys.x = width - 8 - keys.width()    - 18;
 		}
 		
 		int tier = Dungeon.hero.tier();
@@ -219,4 +227,48 @@ public class StatusPane extends Component {
 			avatar.copy( HeroSprite.avatar( Dungeon.hero.heroClass, tier ) );
 		}
 	}
+	
+	private static class MenuButton extends Button {
+		
+		private Image image;
+		
+		public MenuButton() {
+			super();
+			
+			width = image.width + 4;
+			height = image.height + 4;
+		}
+		
+		@Override
+		protected void createChildren() {
+			super.createChildren();
+			
+			image = new Image( Assets.STATUS, 114, 3, 12, 11 );
+			add( image );
+		}
+		
+		@Override
+		protected void layout() {
+			super.layout();
+			
+			image.x = x + 2;
+			image.y = y + 2;
+		}
+		
+		@Override
+		protected void onTouchDown() {
+			image.brightness( 1.5f );
+			Sample.INSTANCE.play( Assets.SND_CLICK );
+		}
+		
+		@Override
+		protected void onTouchUp() {
+			image.resetColor();
+		}
+		
+		@Override
+		protected void onClick() {
+			GameScene.show( new WndGame() );
+		}
+	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/ui/Tag.java b/core/src/com/watabou/pixeldungeon/ui/Tag.java
index 33c46e7..8c7700d 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Tag.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Tag.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Toast.java b/core/src/com/watabou/pixeldungeon/ui/Toast.java
index 118b732..14abbb4 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Toast.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Toast.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Toolbar.java b/core/src/com/watabou/pixeldungeon/ui/Toolbar.java
index a3672fd..72b0f55 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Toolbar.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Toolbar.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Window.java b/core/src/com/watabou/pixeldungeon/ui/Window.java
index 7aed16a..f125d9e 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Window.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Window.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/utils/BArray.java b/core/src/com/watabou/pixeldungeon/utils/BArray.java
index c109f09..b513b66 100644
--- a/core/src/com/watabou/pixeldungeon/utils/BArray.java
+++ b/core/src/com/watabou/pixeldungeon/utils/BArray.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/utils/GLog.java b/core/src/com/watabou/pixeldungeon/utils/GLog.java
index f854d41..6a0f04a 100644
--- a/core/src/com/watabou/pixeldungeon/utils/GLog.java
+++ b/core/src/com/watabou/pixeldungeon/utils/GLog.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/utils/Utils.java b/core/src/com/watabou/pixeldungeon/utils/Utils.java
index 4cff2ab..6bdb978 100644
--- a/core/src/com/watabou/pixeldungeon/utils/Utils.java
+++ b/core/src/com/watabou/pixeldungeon/utils/Utils.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/IconTitle.java b/core/src/com/watabou/pixeldungeon/windows/IconTitle.java
index 92a648a..56996ba 100644
--- a/core/src/com/watabou/pixeldungeon/windows/IconTitle.java
+++ b/core/src/com/watabou/pixeldungeon/windows/IconTitle.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -20,8 +19,11 @@ package com.watabou.pixeldungeon.windows;
 import com.watabou.noosa.BitmapTextMultiline;
 import com.watabou.noosa.Image;
 import com.watabou.noosa.ui.Component;
+import com.watabou.pixeldungeon.items.Item;
 import com.watabou.pixeldungeon.scenes.PixelScene;
+import com.watabou.pixeldungeon.sprites.ItemSprite;
 import com.watabou.pixeldungeon.ui.Window;
+import com.watabou.pixeldungeon.utils.Utils;
 
 public class IconTitle extends Component {
 
@@ -36,6 +38,12 @@ public class IconTitle extends Component {
 		super();
 	}
 	
+	public IconTitle( Item item ) {
+		this( 
+			new ItemSprite( item.image(), item.glowing() ), 
+			Utils.capitalize( item.toString() ) );
+	}
+	
 	public IconTitle( Image icon, String label ) {
 		super();
 		
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndBadge.java b/core/src/com/watabou/pixeldungeon/windows/WndBadge.java
index b0cd1e0..837d013 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndBadge.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndBadge.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndBag.java b/core/src/com/watabou/pixeldungeon/windows/WndBag.java
index c218aa3..d7520af 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndBag.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndBag.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndBlacksmith.java b/core/src/com/watabou/pixeldungeon/windows/WndBlacksmith.java
index 49069ce..4df3da5 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndBlacksmith.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndBlacksmith.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndCatalogus.java b/core/src/com/watabou/pixeldungeon/windows/WndCatalogus.java
index b7a8f7c..76b608c 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndCatalogus.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndCatalogus.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndChallenges.java b/core/src/com/watabou/pixeldungeon/windows/WndChallenges.java
new file mode 100644
index 0000000..4e8f56a
--- /dev/null
+++ b/core/src/com/watabou/pixeldungeon/windows/WndChallenges.java
@@ -0,0 +1,88 @@
+/*
+ * Copyright (C) 2012-2014  Oleg Dolya
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>
+ */
+package com.watabou.pixeldungeon.windows;
+
+import java.util.ArrayList;
+
+import com.watabou.noosa.BitmapText;
+import com.watabou.pixeldungeon.Challenges;
+import com.watabou.pixeldungeon.PixelDungeon;
+import com.watabou.pixeldungeon.scenes.PixelScene;
+import com.watabou.pixeldungeon.ui.CheckBox;
+import com.watabou.pixeldungeon.ui.Window;
+
+public class WndChallenges extends Window {
+
+	private static final int WIDTH		= 108;
+	private static final int BTN_HEIGHT	= 20;
+	private static final int GAP		= 2;
+	
+	private static final String TITLE	= "Challenges";
+	
+	private boolean editable;
+	private ArrayList<CheckBox> boxes;
+	
+	public WndChallenges( int checked, boolean editable ) {
+		
+		super();
+		
+		this.editable = editable;
+		
+		BitmapText title = PixelScene.createText( TITLE, 9 );
+		title.hardlight( TITLE_COLOR );
+		title.measure();
+		title.x = PixelScene.align( camera, (WIDTH - title.width()) / 2 );
+		add( title );
+		
+		boxes = new ArrayList<CheckBox>();
+		
+		float pos = title.height() + GAP;
+		for (int i=0; i < Challenges.NAMES.length; i++) {
+			
+			CheckBox cb = new CheckBox( Challenges.NAMES[i] );
+			cb.checked( (checked & Challenges.MASKS[i]) != 0 );
+			cb.active = editable;
+			
+			if (i > 0) {
+				pos += GAP;
+			}
+			cb.setRect( 0, pos, WIDTH, BTN_HEIGHT );
+			pos = cb.bottom();
+			
+			add( cb );
+			boxes.add( cb );
+		}
+		
+		resize( WIDTH, (int)pos );
+	}
+	
+	@Override
+	public void onBackPressed() {
+		
+		if (editable) {
+			int value = 0;
+			for (int i=0; i < boxes.size(); i++) {
+				if (boxes.get( i ).checked()) {
+					value |= Challenges.MASKS[i];
+				}
+			}	
+			PixelDungeon.challenges( value );
+		}
+		
+		super.onBackPressed();
+	}
+}
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndChooseWay.java b/core/src/com/watabou/pixeldungeon/windows/WndChooseWay.java
index c6daf2c..937bf50 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndChooseWay.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndChooseWay.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndClass.java b/core/src/com/watabou/pixeldungeon/windows/WndClass.java
new file mode 100644
index 0000000..0388b2d
--- /dev/null
+++ b/core/src/com/watabou/pixeldungeon/windows/WndClass.java
@@ -0,0 +1,198 @@
+/*
+ * Copyright (C) 2012-2014  Oleg Dolya
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program.  If not, see <http://www.gnu.org/licenses/>
+ */
+package com.watabou.pixeldungeon.windows;
+
+import com.watabou.noosa.BitmapText;
+import com.watabou.noosa.BitmapTextMultiline;
+import com.watabou.noosa.Group;
+import com.watabou.pixeldungeon.Badges;
+import com.watabou.pixeldungeon.actors.hero.HeroClass;
+import com.watabou.pixeldungeon.actors.hero.HeroSubClass;
+import com.watabou.pixeldungeon.scenes.PixelScene;
+import com.watabou.pixeldungeon.utils.Utils;
+
+public class WndClass extends WndTabbed {
+	
+	private static final String TXT_MASTERY	= "Mastery";
+	
+	private static final int WIDTH			= 110;
+	
+	private static final int TAB_WIDTH	= 50;
+	
+	private HeroClass cl;
+	
+	private PerksTab tabPerks;
+	private MasteryTab tabMastery;
+	
+	public WndClass( HeroClass cl ) {
+		
+		super();
+		
+		this.cl = cl;
+		
+		tabPerks = new PerksTab();
+		add( tabPerks );
+		
+		Tab tab = new RankingTab( Utils.capitalize( cl.title() ), tabPerks );
+		tab.setSize( TAB_WIDTH, tabHeight() );
+		add( tab );
+		
+		if (Badges.isUnlocked( cl.masteryBadge() )) {
+			tabMastery = new MasteryTab();
+			add( tabMastery );
+			
+			tab = new RankingTab( TXT_MASTERY, tabMastery );
+			tab.setSize( TAB_WIDTH, tabHeight() );
+			add( tab );
+			
+			resize( 
+				(int)Math.max( tabPerks.width, tabMastery.width ), 
+				(int)Math.max( tabPerks.height, tabMastery.height ) );
+		} else {
+			resize( (int)tabPerks.width, (int)tabPerks.height );
+		}
+		
+		select( 0 );
+	}
+
+	private class RankingTab extends LabeledTab {
+		
+		private Group page;
+		
+		public RankingTab( String label, Group page ) {
+			super( label );
+			this.page = page;
+		}
+		
+		@Override
+		protected void select( boolean value ) {
+			super.select( value );
+			if (page != null) {
+				page.visible = page.active = selected;
+			}
+		}
+	}
+	
+	private class PerksTab extends Group {
+		
+		private static final int MARGIN	= 4;
+		private static final int GAP	= 4;
+		
+		private static final String DOT	= "\u007F";
+		
+		public float height;
+		public float width;
+		
+		public PerksTab() {
+			super();
+			
+			float dotWidth = 0;
+			
+			String[] items = cl.perks();
+			float pos = MARGIN;
+			
+			for (int i=0; i < items.length; i++) {
+				
+				if (i > 0) {
+					pos += GAP;
+				}
+				
+				BitmapText dot = PixelScene.createText( DOT, 6 );
+				dot.x = MARGIN;
+				dot.y = pos;
+				if (dotWidth == 0) {
+					dot.measure();
+					dotWidth = dot.width();
+				}
+				add( dot );
+				
+				BitmapTextMultiline item = PixelScene.createMultiline( items[i], 6 );
+				item.x = dot.x + dotWidth;
+				item.y = pos;
+				item.maxWidth = (int)(WIDTH - MARGIN * 2 - dotWidth);
+				item.measure();
+				add( item );
+				
+				pos += item.height();
+				float w = item.width();
+				if (w > width) {
+					width = w;
+				}
+			}
+			
+			width += MARGIN + dotWidth;
+			height = pos + MARGIN;
+		}
+	}
+	
+	private class MasteryTab extends Group {
+		
+		private static final int MARGIN	= 4;
+		
+		private BitmapTextMultiline normal;
+		private BitmapTextMultiline highlighted;
+		
+		public float height;
+		public float width;
+		
+		public MasteryTab() {
+			super();
+			
+			String text = null;
+			switch (cl) {
+			case WARRIOR:
+				text = HeroSubClass.GLADIATOR.desc() + "\n\n" + HeroSubClass.BERSERKER.desc();
+				break;
+			case MAGE:
+				text = HeroSubClass.BATTLEMAGE.desc() + "\n\n" + HeroSubClass.WARLOCK.desc();
+				break;
+			case ROGUE:
+				text = HeroSubClass.FREERUNNER.desc() + "\n\n" + HeroSubClass.ASSASSIN.desc();
+				break;
+			case HUNTRESS:
+				text = HeroSubClass.SNIPER.desc() + "\n\n" + HeroSubClass.WARDEN.desc();
+				break;
+			}
+			
+			Highlighter hl = new Highlighter( text );
+			
+			normal = PixelScene.createMultiline( hl.text, 6 );
+			normal.maxWidth = WIDTH - MARGIN * 2;
+			normal.measure();
+			normal.x = MARGIN;
+			normal.y = MARGIN;
+			add( normal );
+			
+			if (hl.isHighlighted()) {
+				normal.mask = hl.inverted();
+				
+				highlighted = PixelScene.createMultiline( hl.text, 6 );
+				highlighted.maxWidth = normal.maxWidth;
+				highlighted.measure();
+				highlighted.x = normal.x;
+				highlighted.y = normal.y;
+				add( highlighted );
+		
+				highlighted.mask = hl.mask;
+				highlighted.hardlight( TITLE_COLOR );
+			}
+			
+			height = normal.y + normal.height() + MARGIN;
+			width = normal.x + normal.width() + MARGIN;
+		}
+	}
+}
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndError.java b/core/src/com/watabou/pixeldungeon/windows/WndError.java
index 099f86e..8633455 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndError.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndError.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndGame.java b/core/src/com/watabou/pixeldungeon/windows/WndGame.java
index 4fef81e..270bc5c 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndGame.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndGame.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -21,6 +20,7 @@ import java.io.IOException;
 
 import com.watabou.noosa.Game;
 import com.watabou.pixeldungeon.Dungeon;
+import com.watabou.pixeldungeon.PixelDungeon;
 import com.watabou.pixeldungeon.scenes.GameScene;
 import com.watabou.pixeldungeon.scenes.InterlevelScene;
 import com.watabou.pixeldungeon.scenes.RankingsScene;
@@ -32,6 +32,7 @@ import com.watabou.pixeldungeon.ui.Window;
 public class WndGame extends Window {
 	
 	private static final String TXT_SETTINGS	= "Settings";
+	private static final String TXT_CHALLEGES	= "Challenges";
 	private static final String TXT_RANKINGS	= "Rankings";
 	private static final String TXT_START		= "Start New Game";
 	private static final String TXT_MENU		= "Main Menu";
@@ -56,7 +57,16 @@ public class WndGame extends Window {
 			}
 		} );
 		
-		// Restart
+		if (Dungeon.challenges > 0) {
+			addButton( new RedButton( TXT_CHALLEGES ) {
+				@Override
+				protected void onClick() {
+					hide();
+					GameScene.show( new WndChallenges( Dungeon.challenges, false ) );
+				}
+			} );
+		}
+		
 		if (!Dungeon.hero.isAlive()) {
 			
 			RedButton btnStart;
@@ -64,6 +74,7 @@ public class WndGame extends Window {
 				@Override
 				protected void onClick() {
 					Dungeon.hero = null;
+					PixelDungeon.challenges( Dungeon.challenges );
 					InterlevelScene.mode = InterlevelScene.Mode.DESCEND;
 					InterlevelScene.noStory = true;
 					Game.switchScene( InterlevelScene.class );
@@ -80,7 +91,6 @@ public class WndGame extends Window {
 			} );
 		}
 				
-		// Main menu
 		addButton( new RedButton( TXT_MENU ) {
 			@Override
 			protected void onClick() {
@@ -93,7 +103,6 @@ public class WndGame extends Window {
 			}
 		} );
 		
-		// Exit
 		addButton( new RedButton( TXT_EXIT ) {
 			@Override
 			protected void onClick() {
@@ -101,7 +110,6 @@ public class WndGame extends Window {
 			}
 		} );
 		
-		// Cancel
 		addButton( new RedButton( TXT_RETURN ) {
 			@Override
 			protected void onClick() {
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndHero.java b/core/src/com/watabou/pixeldungeon/windows/WndHero.java
index d32cc39..834db06 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndHero.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndHero.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndImp.java b/core/src/com/watabou/pixeldungeon/windows/WndImp.java
index 8f51447..c9855e5 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndImp.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndImp.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndInfoCell.java b/core/src/com/watabou/pixeldungeon/windows/WndInfoCell.java
index 4220c0f..299000a 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndInfoCell.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndInfoCell.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndInfoItem.java b/core/src/com/watabou/pixeldungeon/windows/WndInfoItem.java
index 8188d33..814deb6 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndInfoItem.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndInfoItem.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndInfoMob.java b/core/src/com/watabou/pixeldungeon/windows/WndInfoMob.java
index bb77435..47057bc 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndInfoMob.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndInfoMob.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -27,13 +26,7 @@ import com.watabou.pixeldungeon.ui.BuffIndicator;
 import com.watabou.pixeldungeon.utils.Utils;
 
 public class WndInfoMob extends WndTitledMessage {
-	
-	private static final String TXT_SLEEPNIG	= "\n\nThis %s is sleeping.";
-	private static final String TXT_HUNTING		= "\n\nThis %s is hunting.";
-	private static final String TXT_WANDERING	= "\n\nThis %s is wandering.";
-	private static final String TXT_FLEEING		= "\n\nThis %s is fleeing.";
-	private static final String TXT_PASSIVE		= "\n\nThe %s is passive.";
-	
+
 	public WndInfoMob( Mob mob ) {
 		
 		super( new MobTitle( mob ), desc( mob ) );
@@ -44,23 +37,7 @@ public class WndInfoMob extends WndTitledMessage {
 		
 		StringBuilder builder = new StringBuilder( mob.description() );
 		
-		switch (mob.state) {
-		case SLEEPING:
-			builder.append( String.format( TXT_SLEEPNIG, mob.name ) );
-			break;
-		case HUNTING:
-			builder.append( String.format( TXT_HUNTING, mob.name ) );
-			break;
-		case WANDERING:
-			builder.append( String.format( TXT_WANDERING, mob.name ) );
-			break;
-		case FLEEING:
-			builder.append( String.format( TXT_FLEEING, mob.name ) );
-			break;
-		case PASSIVE:
-			builder.append( String.format( TXT_PASSIVE, mob.name ) );
-			break;
-		}
+		builder.append( "\n\n" + mob.state.status() + "." );
 		
 		return builder.toString();
 	}
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndInfoPlant.java b/core/src/com/watabou/pixeldungeon/windows/WndInfoPlant.java
index f749828..e7bb85a 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndInfoPlant.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndInfoPlant.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndItem.java b/core/src/com/watabou/pixeldungeon/windows/WndItem.java
index 66326a2..98e3f60 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndItem.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndItem.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndJournal.java b/core/src/com/watabou/pixeldungeon/windows/WndJournal.java
index 3439134..203be12 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndJournal.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndJournal.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndMessage.java b/core/src/com/watabou/pixeldungeon/windows/WndMessage.java
index 3d8833e..9e1aafd 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndMessage.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndMessage.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndOptions.java b/core/src/com/watabou/pixeldungeon/windows/WndOptions.java
index db236db..73836cc 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndOptions.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndOptions.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndQuest.java b/core/src/com/watabou/pixeldungeon/windows/WndQuest.java
index d9c068c..b31378f 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndQuest.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndQuest.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -17,12 +16,12 @@
  */
 package com.watabou.pixeldungeon.windows;
 
-import com.watabou.pixeldungeon.actors.mobs.Mob;
+import com.watabou.pixeldungeon.actors.mobs.npcs.NPC;
 import com.watabou.pixeldungeon.utils.Utils;
 
 public class WndQuest extends WndTitledMessage {
 	
-	public WndQuest( Mob.NPC questgiver, String text ) {
+	public WndQuest( NPC questgiver, String text ) {
 		super( questgiver.sprite(), Utils.capitalize( questgiver.name ), text );
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndRanking.java b/core/src/com/watabou/pixeldungeon/windows/WndRanking.java
index e34fa60..5ead9c9 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndRanking.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndRanking.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -38,6 +37,7 @@ import com.watabou.pixeldungeon.sprites.HeroSprite;
 import com.watabou.pixeldungeon.ui.BadgesList;
 import com.watabou.pixeldungeon.ui.Icons;
 import com.watabou.pixeldungeon.ui.ItemSlot;
+import com.watabou.pixeldungeon.ui.RedButton;
 import com.watabou.pixeldungeon.ui.ScrollPane;
 import com.watabou.pixeldungeon.utils.Utils;
 
@@ -142,7 +142,9 @@ public class WndRanking extends WndTabbed {
 		
 		private static final int GAP	= 4;
 		
-		private static final String TXT_TITLE		= "Level %d %s";
+		private static final String TXT_TITLE	= "Level %d %s";
+		
+		private static final String TXT_CHALLENGES	= "Challenges";
 		
 		private static final String TXT_HEALTH	= "Health";
 		private static final String TXT_STR		= "Strength";
@@ -168,7 +170,22 @@ public class WndRanking extends WndTabbed {
 			title.setRect( 0, 0, WIDTH, 0 );
 			add( title );
 			
-			float pos = title.bottom() + GAP + GAP;
+			float pos = title.bottom();
+			
+			if (Dungeon.challenges > 0) {
+				RedButton btnCatalogus = new RedButton( TXT_CHALLENGES ) {
+					@Override
+					protected void onClick() {
+						Game.scene().add( new WndChallenges( Dungeon.challenges, false ) );
+					}
+				};
+				btnCatalogus.setRect( 0, pos + GAP, btnCatalogus.reqWidth() + 2, btnCatalogus.reqHeight() + 2 );
+				add( btnCatalogus );
+				
+				pos = btnCatalogus.bottom();
+			}
+			
+			pos += GAP + GAP;
 			
 			pos = statSlot( this, TXT_STR, Integer.toString( Dungeon.hero.STR ), pos );
 			pos = statSlot( this, TXT_HEALTH, Integer.toString( Dungeon.hero.HT ), pos );
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndResurrect.java b/core/src/com/watabou/pixeldungeon/windows/WndResurrect.java
index 8a8ce7f..f4d3dac 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndResurrect.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndResurrect.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndSadGhost.java b/core/src/com/watabou/pixeldungeon/windows/WndSadGhost.java
index 35287fe..d598e74 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndSadGhost.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndSadGhost.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndSettings.java b/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
index 8e62c89..478a191 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -36,6 +35,7 @@ public class WndSettings extends Window {
 	private static final String TXT_ZOOM_DEFAULT	= "Default Zoom";
 
 	private static final String TXT_SCALE_UP		= "Scale up UI";
+	private static final String TXT_IMMERSIVE		= "Immersive mode";
 	
 	private static final String TXT_MUSIC	= "Music";
 	
@@ -61,10 +61,11 @@ public class WndSettings extends Window {
 	public WndSettings( boolean inGame ) {
 		super();
 		
+		CheckBox btnImmersive = null;
+		
 		if (inGame) {
 			int w = BTN_HEIGHT;
 			
-			// Zoom out
 			btnZoomOut = new RedButton( TXT_ZOOM_OUT ) {
 				@Override
 				protected void onClick() {
@@ -73,7 +74,6 @@ public class WndSettings extends Window {
 			};
 			add( btnZoomOut.setRect( 0, 0, w, BTN_HEIGHT) );
 			
-			// Zoom in
 			btnZoomIn = new RedButton( TXT_ZOOM_IN ) {
 				@Override
 				protected void onClick() {
@@ -82,7 +82,6 @@ public class WndSettings extends Window {
 			};
 			add( btnZoomIn.setRect( WIDTH - w, 0, w, BTN_HEIGHT) );
 			
-			// Default zoom
 			add( new RedButton( TXT_ZOOM_DEFAULT ) {
 				@Override
 				protected void onClick() {
@@ -105,6 +104,18 @@ public class WndSettings extends Window {
 			btnScaleUp.checked( PixelDungeon.scaleUp() );
 			add( btnScaleUp );
 			
+			btnImmersive = new CheckBox( TXT_IMMERSIVE ) {
+				@Override
+				protected void onClick() {
+					super.onClick();
+					PixelDungeon.immerse( checked() );
+				}
+			};
+			btnImmersive.setRect( 0, btnScaleUp.bottom() + GAP, WIDTH, BTN_HEIGHT );
+			btnImmersive.checked( PixelDungeon.immersed() );
+			btnImmersive.enable( android.os.Build.VERSION.SDK_INT >= 19 );
+			add( btnImmersive );
+			
 		}
 		
 		CheckBox btnMusic = new CheckBox( TXT_MUSIC ) {
@@ -114,7 +125,7 @@ public class WndSettings extends Window {
 				PixelDungeon.music( checked() );
 			}
 		};
-		btnMusic.setRect( 0, BTN_HEIGHT + GAP, WIDTH, BTN_HEIGHT );
+		btnMusic.setRect( 0, (btnImmersive != null ? btnImmersive.bottom() : BTN_HEIGHT) + GAP, WIDTH, BTN_HEIGHT );
 		btnMusic.checked( PixelDungeon.music() );
 		add( btnMusic );
 		
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndStory.java b/core/src/com/watabou/pixeldungeon/windows/WndStory.java
index f302e15..2e0e0ac 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndStory.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndStory.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndTabbed.java b/core/src/com/watabou/pixeldungeon/windows/WndTabbed.java
index 7cfa544..7386202 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndTabbed.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndTabbed.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndTitledMessage.java b/core/src/com/watabou/pixeldungeon/windows/WndTitledMessage.java
index 7e94cef..8f29fd5 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndTitledMessage.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndTitledMessage.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndTradeItem.java b/core/src/com/watabou/pixeldungeon/windows/WndTradeItem.java
index e485597..f100211 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndTradeItem.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndTradeItem.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndWandmaker.java b/core/src/com/watabou/pixeldungeon/windows/WndWandmaker.java
index 50e808f..41630f5 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndWandmaker.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndWandmaker.java
@@ -1,5 +1,4 @@
 /*
- * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
-- 
2.1.2


From 92a1122cda28c9eca46c29c990339a0684c33d46 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 06:17:46 -0400
Subject: [PATCH 02/13] Merged the unclean part of the 1.7.2 update

---
 core/src/com/watabou/pixeldungeon/Dungeon.java     |   6 +-
 .../src/com/watabou/pixeldungeon/PixelDungeon.java |  18 +-
 core/src/com/watabou/pixeldungeon/items/Item.java  |  10 +-
 .../pixeldungeon/items/armor/glyphs/Bounce.java    |   2 +-
 .../watabou/pixeldungeon/levels/RegularLevel.java  |   2 +-
 .../watabou/pixeldungeon/scenes/AboutScene.java    |   2 +
 .../com/watabou/pixeldungeon/scenes/GameScene.java |   5 +-
 .../watabou/pixeldungeon/scenes/RankingsScene.java |   3 +-
 .../watabou/pixeldungeon/scenes/StartScene.java    | 300 ++++++++++-----------
 .../watabou/pixeldungeon/scenes/TitleScene.java    |   2 +
 .../watabou/pixeldungeon/sprites/HeroSprite.java   |   6 +
 .../com/watabou/pixeldungeon/ui/StatusPane.java    |   1 +
 12 files changed, 191 insertions(+), 166 deletions(-)

diff --git a/core/src/com/watabou/pixeldungeon/Dungeon.java b/core/src/com/watabou/pixeldungeon/Dungeon.java
index c0f2016..48bcacc 100644
--- a/core/src/com/watabou/pixeldungeon/Dungeon.java
+++ b/core/src/com/watabou/pixeldungeon/Dungeon.java
@@ -113,7 +113,8 @@ public class Dungeon {
 	public static boolean dewVial;		// true if the dew vial can be spawned
 	public static int transmutation;	// depth number for a well of transmutation
 	
-
+	public static int challenges;
+	
 	public static Hero hero;
 	public static Level level;
 	
@@ -464,8 +465,7 @@ public class Dungeon {
 		Bundle bundle = new Bundle();
 		bundle.put( LEVEL, level );
 		
-		OutputStream output = Game.instance.openFileOutput( 
-			Utils.format( depthFile( hero.heroClass ), depth ) );
+		OutputStream output = Game.instance.openFileOutput( Utils.format( depthFile( hero.heroClass ), depth ), Game.MODE_PRIVATE );
 		Bundle.write( bundle, output );
 		output.close();
 	}
diff --git a/core/src/com/watabou/pixeldungeon/PixelDungeon.java b/core/src/com/watabou/pixeldungeon/PixelDungeon.java
index 94d07b1..65cdce7 100644
--- a/core/src/com/watabou/pixeldungeon/PixelDungeon.java
+++ b/core/src/com/watabou/pixeldungeon/PixelDungeon.java
@@ -25,6 +25,7 @@ import com.watabou.noosa.audio.Music;
 import com.watabou.noosa.audio.Sample;
 import com.watabou.pixeldungeon.input.GameAction;
 import com.watabou.pixeldungeon.scenes.GameScene;
+import com.watabou.pixeldungeon.scenes.PixelScene;
 import com.watabou.pixeldungeon.scenes.TitleScene;
 import com.watabou.utils.PDPlatformSupport;
 import com.watabou.utils.Signal;
@@ -83,6 +84,13 @@ public class PixelDungeon extends Game<GameAction> {
 		com.watabou.utils.Bundle.addAlias( 
 			com.watabou.pixeldungeon.items.rings.RingOfPower.class,
 			"com.watabou.pixeldungeon.items.rings.RingOfEnergy" );
+		// 1.7.2
+		com.watabou.utils.Bundle.addAlias( 
+			com.watabou.pixeldungeon.plants.Dreamweed.class,
+			"com.watabou.pixeldungeon.plants.Blindweed" );
+		com.watabou.utils.Bundle.addAlias( 
+			com.watabou.pixeldungeon.plants.Dreamweed.Seed.class,
+			"com.watabou.pixeldungeon.plants.Blindweed$Seed" );
 	}
 	
 	@Override
@@ -210,6 +218,14 @@ public class PixelDungeon extends Game<GameAction> {
 		return Preferences.INSTANCE.getInt( Preferences.KEY_LAST_CLASS, 0 );
 	}
 	
+	public static void challenges( int value ) {
+		Preferences.INSTANCE.put( Preferences.KEY_CHALLENGES, value );
+	}
+	
+	public static int challenges() {
+		return Preferences.INSTANCE.getInt( Preferences.KEY_CHALLENGES, 0 );
+	}
+	
 	public static void intro( boolean value ) {
 		Preferences.INSTANCE.put( Preferences.KEY_INTRO, value );
 	}
@@ -240,4 +256,4 @@ public class PixelDungeon extends Game<GameAction> {
 	public static void reportException( Exception e ) {
 		Gdx.app.error("PD", e.getMessage(), e);
 	}
-}
\ No newline at end of file
+}
diff --git a/core/src/com/watabou/pixeldungeon/items/Item.java b/core/src/com/watabou/pixeldungeon/items/Item.java
index 2966005..71bdf29 100644
--- a/core/src/com/watabou/pixeldungeon/items/Item.java
+++ b/core/src/com/watabou/pixeldungeon/items/Item.java
@@ -206,24 +206,26 @@ public class Item implements Bundlable {
 			updateQuickslot();
 			
 			try { 
-				return ClassReflection.newInstance(getClass());
+				Item detached = ClassReflection.newInstance(getClass());
+				detached.onDetach( );
+				return detached;
 			} catch (Exception e) {
 				return null;
 			}
 		}
 	}
 	
-	public Item detachAll( Bag container ) {
+	public final Item detachAll( Bag container ) {
 		for (Item item : container.items) {
 			if (item == this) {
 				container.items.remove( this );
+				item.onDetach( );
 				QuickSlot.refresh();
 				return this;
 			} else if (item instanceof Bag) {
 				Bag bag = (Bag)item;
 				if (bag.contains( this )) {
-					detachAll( bag );
-					return this;
+					return detachAll( bag );
 				}
 			}
 		}
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java
index b48ce2f..9eb3fd6 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java
@@ -46,7 +46,7 @@ public class Bounce extends Glyph {
 						Actor.addDelayed( new Pushing( attacker, attacker.pos, newPos ), -1 );
 						
 						attacker.pos = newPos;
-						// :(
+						// FIXME
 						if (attacker instanceof Mob) {
 							Dungeon.level.mobPress( (Mob)attacker );
 						} else {
diff --git a/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java b/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java
index c3a8df5..50c4401 100644
--- a/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java
@@ -681,7 +681,7 @@ public abstract class RegularLevel extends Level {
 	@Override
 	public void restoreFromBundle( Bundle bundle ) {
 		super.restoreFromBundle( bundle );
-
+		
 		rooms = new HashSet( bundle.getCollection( "rooms" ) );
 		for (Room r : rooms) {
 			if (r.type == Type.WEAK_FLOOR) {
diff --git a/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java b/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java
index dc00af6..a9de8b1 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java
@@ -19,8 +19,10 @@ package com.watabou.pixeldungeon.scenes;
 import com.badlogic.gdx.Gdx;
 import com.watabou.input.NoosaInputProcessor;
 import com.watabou.noosa.*;
+import com.watabou.pixeldungeon.PixelDungeon;
 import com.watabou.pixeldungeon.effects.Flare;
 import com.watabou.pixeldungeon.ui.Archs;
+import com.watabou.pixeldungeon.ui.ExitButton;
 import com.watabou.pixeldungeon.ui.Icons;
 import com.watabou.pixeldungeon.ui.Window;
 
diff --git a/core/src/com/watabou/pixeldungeon/scenes/GameScene.java b/core/src/com/watabou/pixeldungeon/scenes/GameScene.java
index 730932e..2a78970 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/GameScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/GameScene.java
@@ -658,11 +658,12 @@ public class GameScene extends PixelScene {
 	private static final CellSelector.Listener defaultCellListener = new CellSelector.Listener() {
 		@Override
 		public void onSelect( Integer cell ) {
-			if (cell != -1) {
+			if (Dungeon.hero.handle( cell )) {
                 if (NoosaInputProcessor.modifier) {
                     examineCell( cell );
                 } else {
-                    Dungeon.hero.handle(cell);
+				//	Actor.next();
+					Dungeon.hero.next();
                 }
 			}
 		}
diff --git a/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java b/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java
index ff06a31..3b48420 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java
@@ -19,17 +19,18 @@ package com.watabou.pixeldungeon.scenes;
 import com.watabou.noosa.BitmapText;
 import com.watabou.noosa.BitmapTextMultiline;
 import com.watabou.noosa.Camera;
-import com.watabou.noosa.Game;
 import com.watabou.noosa.Image;
 import com.watabou.noosa.audio.Music;
 import com.watabou.noosa.ui.Button;
 import com.watabou.pixeldungeon.Assets;
+import com.watabou.pixeldungeon.PixelDungeon;
 import com.watabou.pixeldungeon.Rankings;
 import com.watabou.pixeldungeon.effects.Flare;
 import com.watabou.pixeldungeon.input.GameAction;
 import com.watabou.pixeldungeon.sprites.ItemSprite;
 import com.watabou.pixeldungeon.sprites.ItemSpriteSheet;
 import com.watabou.pixeldungeon.ui.Archs;
+import com.watabou.pixeldungeon.ui.ExitButton;
 import com.watabou.pixeldungeon.ui.Icons;
 import com.watabou.pixeldungeon.ui.Window;
 import com.watabou.pixeldungeon.utils.Utils;
diff --git a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
index 2135b72..5764f7c 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
@@ -18,46 +18,40 @@ package com.watabou.pixeldungeon.scenes;
 
 import java.util.HashMap;
 
-import com.watabou.input.NoosaInputProcessor;
 import com.watabou.noosa.BitmapText;
 import com.watabou.noosa.BitmapTextMultiline;
 import com.watabou.noosa.Camera;
 import com.watabou.noosa.Game;
 import com.watabou.noosa.Group;
 import com.watabou.noosa.Image;
-import com.watabou.noosa.NinePatch;
-import com.watabou.noosa.TextureFilm;
-import com.watabou.noosa.TouchArea;
 import com.watabou.noosa.audio.Sample;
 import com.watabou.noosa.particles.Emitter;
 import com.watabou.noosa.ui.Button;
 import com.watabou.pixeldungeon.Assets;
 import com.watabou.pixeldungeon.Badges;
-import com.watabou.pixeldungeon.Chrome;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.GamesInProgress;
 import com.watabou.pixeldungeon.PixelDungeon;
 import com.watabou.pixeldungeon.actors.hero.HeroClass;
-import com.watabou.pixeldungeon.actors.hero.HeroSubClass;
+import com.watabou.pixeldungeon.effects.BannerSprites;
 import com.watabou.pixeldungeon.effects.Speck;
+import com.watabou.pixeldungeon.effects.BannerSprites.Type;
 import com.watabou.pixeldungeon.input.GameAction;
 import com.watabou.pixeldungeon.ui.Archs;
+import com.watabou.pixeldungeon.ui.ExitButton;
 import com.watabou.pixeldungeon.ui.Icons;
 import com.watabou.pixeldungeon.ui.RedButton;
-import com.watabou.pixeldungeon.ui.SimpleButton;
-import com.watabou.pixeldungeon.ui.Window;
 import com.watabou.pixeldungeon.utils.Utils;
-import com.watabou.pixeldungeon.windows.WndList;
+import com.watabou.pixeldungeon.windows.WndChallenges;
+import com.watabou.pixeldungeon.windows.WndClass;
+import com.watabou.pixeldungeon.windows.WndMessage;
 import com.watabou.pixeldungeon.windows.WndOptions;
-import com.watabou.pixeldungeon.windows.WndTitledMessage;
 
 public class StartScene extends PixelScene {
 
 	private static final float BUTTON_HEIGHT	= 24;
 	private static final float GAP				= 2;
 	
-	private static final String TXT_TITLE	= "Select Your Hero";
-	
 	private static final String TXT_LOAD	= "Load Game";
 	private static final String TXT_NEW		= "New Game";
 	
@@ -139,82 +133,45 @@ public class StartScene extends PixelScene {
 				Game.switchScene( InterlevelScene.class );
 			}
 		};
-		add( btnLoad );
-		
-		frame.size( width, BUTTON_HEIGHT + frame.marginVer() );
-		frame.x = align( left );
-		frame.y = align( h - top - frame.height() );
-		
-		avatar = new Avatar();
-		
-		NinePatch avFrame = Chrome.get( Chrome.Type.TOAST_TR );
-		avFrame.size( avatar.width() * 1.6f, avatar.height() * 1.6f );
-		avFrame.x = align( (w - avFrame.width()) / 2 );
-		avFrame.y = align( (frame.y + btns[0].bottom() - avFrame.height()) / 2 );
-		add( avFrame );
-		
-		className = PixelScene.createText( "Placeholder", 9 );
-		className.measure();
-		className.y = align( avFrame.y + avFrame.innerBottom() - className.height() );
-		add( className );
-		
-		avatar.point( avFrame.center() );
-		avatar.camera = Camera.main;
-		align( avatar );
-		add( avatar );
-		
-		Image iconInfo = Icons.INFO.get();
-		iconInfo.x = avFrame.x + avFrame.innerRight() - iconInfo.width();
-		iconInfo.y = avFrame.y + avFrame.marginTop();
-		add( iconInfo );
+		add( btnLoad ); 
 		
-		add( new TouchArea( avFrame ) {
-			@Override
-			protected void onClick( NoosaInputProcessor.Touch touch ) {
-				add( new WndList( curClass.perks() ) );
-			}
-		} );
-		
-		btnMastery = new SimpleButton( Icons.MASTERY.get() ) {
-			@Override
-			protected void onClick() {
-				String text = null;
-				switch (curClass) {
-				case WARRIOR:
-					text = HeroSubClass.GLADIATOR.desc() + "\n\n" + HeroSubClass.BERSERKER.desc();
-					break;
-				case MAGE:
-					text = HeroSubClass.BATTLEMAGE.desc() + "\n\n" + HeroSubClass.WARLOCK.desc();
-					break;
-				case ROGUE:
-					text = HeroSubClass.FREERUNNER.desc() + "\n\n" + HeroSubClass.ASSASSIN.desc();
-					break;
-				case HUNTRESS:
-					text = HeroSubClass.SNIPER.desc() + "\n\n" + HeroSubClass.WARDEN.desc();
-					break;
-				}
-				StartScene.this.add( new WndTitledMessage( Icons.MASTERY.get(), "Mastery", text ) );
-			}
+		HeroClass[] classes = {
+			HeroClass.WARRIOR, HeroClass.MAGE, HeroClass.ROGUE, HeroClass.HUNTRESS	
 		};
-		btnMastery.setPos( 
-			avFrame.x + avFrame.innerRight() - btnMastery.width(),
-			avFrame.y + avFrame.innerBottom() - btnMastery.height() );
-		add( btnMastery );
+		float shieldW = WIDTH / 2;
+		float shieldH = Math.min( (bottom - BUTTON_HEIGHT - title.y - title.height()) / 2, shieldW * 1.2f );
+		top = (bottom - BUTTON_HEIGHT + title.y + title.height() - shieldH * 2) / 2;
+		for (int i=0; i < classes.length; i++) {
+			ClassShield shield = new ClassShield( classes[i] );
+			shield.setRect( 
+				left + (i % 2) * shieldW, 
+				top + (i / 2) * shieldH, 
+				shieldW, shieldH );
+			add( shield );
+			
+			shields.put( classes[i], shield );
+		}
 		
 		unlock = new Group();
 		add( unlock );
 		
+		ChallengeButton challenge = new ChallengeButton();
+		challenge.setPos( 
+			w / 2 - challenge.width() / 2,
+			top + shieldH - challenge.height() / 2 );
+		add( challenge );
+		
 		if (!(huntressUnlocked = Badges.isUnlocked( Badges.Badge.BOSS_SLAIN_3 ))) {
 		
-			BitmapTextMultiline text = PixelScene.createMultiline( TXT_UNLOCK, 5 );
-			text.maxWidth = (int)frame.innerWidth();
+			BitmapTextMultiline text = PixelScene.createMultiline( TXT_UNLOCK, 9 );
+			text.maxWidth = (int)WIDTH;
 			text.measure();
 			
-			pos = frame.center().y - text.height() / 2;
+			float pos = (bottom - BUTTON_HEIGHT) + (BUTTON_HEIGHT - text.height()) / 2;
 			for (BitmapText line : text.new LineSplitter().split()) {
 				line.measure();
 				line.hardlight( 0xFFFF00 );
-				line.x = PixelScene.align( frame.center().x - line.width() / 2 );
+				line.x = PixelScene.align( left + WIDTH / 2 - line.width() / 2 );
 				line.y = PixelScene.align( pos );
 				unlock.add( line );
 				
@@ -299,159 +256,196 @@ public class StartScene extends PixelScene {
 	
 	@Override
 	protected void onBackPressed() {
-		Game.switchScene( TitleScene.class );
+		PixelDungeon.switchNoFade( TitleScene.class );
 	}
 	
-	private static class Avatar extends Image {
-		
-		private static final int WIDTH	= 24;
-		private static final int HEIGHT	= 32;
-		private static final int SCALE	= 2;
+	private static class GameButton extends RedButton {
 		
-		private TextureFilm frames;
+		private static final int SECONDARY_COLOR	= 0xCACFC2;
 		
-		private float brightness = 0;
+		private BitmapText secondary;
 		
-		public Avatar() {
-			super( Assets.AVATARS );
-			
-			frames = new TextureFilm( texture, WIDTH, HEIGHT );
-			selectClass( HeroClass.WARRIOR );
-			scale.set( SCALE );
+		public GameButton( String primary ) {
+			super( primary );
 			
-			origin.set( width() / 2, height() / 2 );
-		}
-		
-		public void selectClass( HeroClass cl ) {
-			frame( frames.get( cl.ordinal() ) );
+			this.secondary.text( null );
 		}
 		
-		public void flash() {
-			brightness = 1f;
+		@Override
+		protected void createChildren() {
+			super.createChildren();
+			
+			secondary = createText( 6 );
+			secondary.hardlight( SECONDARY_COLOR );
+			add( secondary );
 		}
 		
 		@Override
-		public void update() {
-			super.update();
-		
-			if (brightness > 0) {
-				ra = ga = ba = brightness;
-				brightness -= Game.elapsed * 4;
-				if (brightness < 0) {
-					resetColor();
-				}
+		protected void layout() {
+			super.layout();
+			
+			if (secondary.text().length() > 0) {
+				text.y = align( y + (height - text.height() - secondary.baseLine()) / 2 );
+				
+				secondary.x = align( x + (width - secondary.width()) / 2 );
+				secondary.y = align( text.y + text.height() ); 
+			} else {
+				text.y = align( y + (height - text.baseLine()) / 2 );
 			}
 		}
 	}
+		
+		public void secondary( String text ) {
+			secondary.text( text );
+			secondary.measure();
+		}
 	
-	private class GemButton extends Button<GameAction> {
+	private class ClassShield extends Button<GameAction> {
 		
-		private NinePatch bg;
-		private Image icon;
+		private static final float MIN_BRIGHTNESS	= 0.6f;
+		
+		private static final int WIDTH	= 24;
+		private static final int HEIGHT	= 28;
+		private static final int SCALE	= 2;
 		
 		private HeroClass cl;
 		
-		public GemButton( HeroClass cl ) {
+		private Image avatar;
+		private BitmapText name;
+		private Emitter emitter;
+		
+		private float brightness;
+		
+		public ClassShield( HeroClass cl ) {
 			super();
 			
 			this.cl = cl;
-			gems.put( cl, this );
+			avatar.frame( cl.ordinal() * WIDTH, 0, WIDTH, HEIGHT );
+			avatar.scale.set( SCALE );
 			
-			icon.copy( Icons.get( cl ) );
-			setSize( 32, 32 );
+			name.text( cl.name() );
+			name.measure();
 			
-			highlight( false );
+			brightness = MIN_BRIGHTNESS;
+			updateBrightness();
 		}
 		
 		@Override
 		protected void createChildren() {
+			
 			super.createChildren();
 			
-			bg = Chrome.get( Chrome.Type.GEM );
-			add( bg );
+			avatar = new Image( Assets.AVATARS );
+			add( avatar );
 			
-			icon = new Image();
-			add( icon );
+			name = PixelScene.createText( 9 );
+			add( name );
+			
+			emitter = new Emitter();
+			add( emitter );
 		}
 		
 		@Override
 		protected void layout() {
 			super.layout();
 			
-			bg.x = x;
-			bg.y = y;
-			bg.size( width, height );
+			avatar.x = align( x + (width - avatar.width()) / 2 );
+			avatar.y = align( y + (height - avatar.height() - name.height()) / 2 );
+			
+			name.x = align( x + (width - name.width()) / 2 );
+			name.y = avatar.y + avatar.height() + SCALE;
 			
-			icon.x = x + (width - icon.width) / 2;
-			icon.y = y + (height - icon.height) / 2;
+			emitter.pos( avatar.x, avatar.y, avatar.width(), avatar.height() );
 		}
 		
 		@Override
 		protected void onTouchDown() {
-			Emitter emitter = (Emitter)recycle( Emitter.class );
+			
 			emitter.revive();
-			emitter.pos( bg );
-			emitter.burst( Speck.factory( Speck.LIGHT ), 3 );
+			emitter.start( Speck.factory( Speck.LIGHT ), 0.05f, 7 );
 			
+			if (brightness < 1.0f && brightness > MIN_BRIGHTNESS) {
+				if ((brightness -= Game.elapsed) <= MIN_BRIGHTNESS) {
+					brightness = MIN_BRIGHTNESS;
+				}
+				updateBrightness();
+			}
 			updateClass( cl );
-			avatar.flash();
+		}
+		
+		@Override
+		public void update() {
+			super.update();
 			
 			Sample.INSTANCE.play( Assets.SND_CLICK, 1, 1, 1.2f );
 		}
 		
 		public void highlight( boolean value ) {
 			if (value) {
-				bg.rm = 1.2f;
-				bg.gm = 1.2f;
-				bg.bm = 1.1f;
-				bg.am = 0.8f;
+				brightness = 1.0f;
+				name.hardlight( 0xCACFC2 );
 			} else {
-				bg.rm = 1.0f;
-				bg.gm = 1.0f;
-				bg.bm = 1.0f;
-				bg.am = 0.6f;
+				brightness = 0.999f;
+				name.hardlight( 0x444444 );
 			}
+
+			updateBrightness();
+		}
+		
+		private void updateBrightness() {
+			avatar.gm = avatar.bm = avatar.rm = avatar.am = brightness;
 		}
 	}
 	
-	private static class GameButton extends RedButton {
+	private class ChallengeButton extends Button {
 		
-		private static final int SECONDARY_COLOR	= 0xCACFC2;
+		private Image image;
 		
-		private BitmapText secondary;
-		
-		public GameButton( String primary ) {
-			super( primary );
+		public ChallengeButton() {
+			super();
 			
-			this.secondary.text( null );
+			width = image.width;
+			height = image.height;
+			
+			image.am = Badges.isUnlocked( Badges.Badge.VICTORY ) ? 1.0f : 0.5f;
 		}
 		
 		@Override
 		protected void createChildren() {
+			
 			super.createChildren();
 			
-			secondary = createText( 6 );
-			secondary.hardlight( SECONDARY_COLOR );
-			add( secondary );
+			image = Icons.get( PixelDungeon.challenges() > 0 ? Icons.CHALLENGE_ON :Icons.CHALLENGE_OFF );
+			add( image );
 		}
 		
 		@Override
 		protected void layout() {
+			
 			super.layout();
 			
-			if (secondary.text().length() > 0) {
-				text.y = y + (height - text.height() - secondary.baseLine()) / 2;
-				
-				secondary.x = align( x + (width - secondary.width()) / 2 );
-				secondary.y = align( text.y + text.height() ); 
+			image.x = align( x );
+			image.y = align( y  );
+		}
+		
+		@Override
+		protected void onClick() {
+			if (Badges.isUnlocked( Badges.Badge.VICTORY )) {
+				add( new WndChallenges( PixelDungeon.challenges(), true ) {
+					public void onBackPressed() {
+						super.onBackPressed();
+						image.copy( Icons.get( PixelDungeon.challenges() > 0 ? 
+							Icons.CHALLENGE_ON :Icons.CHALLENGE_OFF ) );
+					};
+				} );
 			} else {
-				text.y = y + (height - text.baseLine()) / 2;
+				add( new WndMessage( TXT_WIN_THE_GAME ) );
 			}
 		}
 		
-		public void secondary( String text ) {
-			secondary.text( text );
-			secondary.measure();
+		@Override
+		protected void onTouchDown() {
+			Sample.INSTANCE.play( Assets.SND_CLICK );
 		}
 	}
 }
diff --git a/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java b/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java
index 07fc9a0..c2f3636 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java
@@ -24,10 +24,12 @@ import com.watabou.noosa.audio.Music;
 import com.watabou.noosa.audio.Sample;
 import com.watabou.noosa.ui.Button;
 import com.watabou.pixeldungeon.Assets;
+import com.watabou.pixeldungeon.PixelDungeon;
 import com.watabou.pixeldungeon.effects.BannerSprites;
 import com.watabou.pixeldungeon.effects.Fireball;
 import com.watabou.pixeldungeon.input.GameAction;
 import com.watabou.pixeldungeon.ui.Archs;
+import com.watabou.pixeldungeon.ui.ExitButton;
 import com.watabou.pixeldungeon.ui.PrefsButton;
 
 public class TitleScene extends PixelScene {
diff --git a/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java b/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java
index 6554fb0..34e066d 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java
@@ -21,10 +21,16 @@ import com.watabou.gltextures.TextureCache;
 import com.watabou.noosa.Camera;
 import com.watabou.noosa.Image;
 import com.watabou.noosa.TextureFilm;
+import com.watabou.noosa.Visual;
+import com.watabou.noosa.tweeners.Tweener;
 import com.watabou.pixeldungeon.Assets;
 import com.watabou.pixeldungeon.Dungeon;
 import com.watabou.pixeldungeon.actors.hero.Hero;
 import com.watabou.pixeldungeon.actors.hero.HeroClass;
+import com.watabou.pixeldungeon.levels.Level;
+import com.watabou.pixeldungeon.scenes.GameScene;
+import com.watabou.utils.Callback;
+import com.watabou.utils.PointF;
 import com.watabou.utils.RectF;
 
 public class HeroSprite extends CharSprite {
diff --git a/core/src/com/watabou/pixeldungeon/ui/StatusPane.java b/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
index 444fcd4..bcab28d 100644
--- a/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
+++ b/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
@@ -35,6 +35,7 @@ import com.watabou.pixeldungeon.items.keys.IronKey;
 import com.watabou.pixeldungeon.scenes.GameScene;
 import com.watabou.pixeldungeon.scenes.PixelScene;
 import com.watabou.pixeldungeon.sprites.HeroSprite;
+import com.watabou.pixeldungeon.windows.WndGame;
 import com.watabou.pixeldungeon.windows.WndCatalogus;
 import com.watabou.pixeldungeon.windows.WndHero;
 import com.watabou.pixeldungeon.windows.WndJournal;
-- 
2.1.2


From 888b64afd77757d6f9be885cf989ed2a24b59b60 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 06:19:40 -0400
Subject: [PATCH 03/13] Merged the update to the license information

---
 core/src/com/watabou/pixeldungeon/Assets.java      |  1 +
 core/src/com/watabou/pixeldungeon/Badges.java      |  1 +
 core/src/com/watabou/pixeldungeon/Bones.java       |  1 +
 core/src/com/watabou/pixeldungeon/Challenges.java  |  1 +
 core/src/com/watabou/pixeldungeon/Chrome.java      |  1 +
 core/src/com/watabou/pixeldungeon/Dungeon.java     |  1 +
 .../com/watabou/pixeldungeon/DungeonTilemap.java   |  1 +
 core/src/com/watabou/pixeldungeon/FogOfWar.java    |  1 +
 .../com/watabou/pixeldungeon/GamesInProgress.java  |  1 +
 core/src/com/watabou/pixeldungeon/Journal.java     |  1 +
 .../src/com/watabou/pixeldungeon/PixelDungeon.java |  1 +
 core/src/com/watabou/pixeldungeon/Preferences.java |  1 +
 core/src/com/watabou/pixeldungeon/Rankings.java    |  1 +
 .../watabou/pixeldungeon/ResultDescriptions.java   |  1 +
 core/src/com/watabou/pixeldungeon/Statistics.java  |  1 +
 .../src/com/watabou/pixeldungeon/actors/Actor.java |  1 +
 core/src/com/watabou/pixeldungeon/actors/Char.java |  1 +
 .../watabou/pixeldungeon/actors/blobs/Alchemy.java |  1 +
 .../watabou/pixeldungeon/actors/blobs/Blob.java    |  1 +
 .../pixeldungeon/actors/blobs/ConfusionGas.java    |  1 +
 .../watabou/pixeldungeon/actors/blobs/Fire.java    |  1 +
 .../watabou/pixeldungeon/actors/blobs/Foliage.java |  1 +
 .../pixeldungeon/actors/blobs/Freezing.java        |  1 +
 .../pixeldungeon/actors/blobs/ParalyticGas.java    |  1 +
 .../pixeldungeon/actors/blobs/Regrowth.java        |  1 +
 .../pixeldungeon/actors/blobs/ToxicGas.java        |  1 +
 .../actors/blobs/WaterOfAwareness.java             |  1 +
 .../pixeldungeon/actors/blobs/WaterOfHealth.java   |  1 +
 .../actors/blobs/WaterOfTransmutation.java         |  1 +
 .../com/watabou/pixeldungeon/actors/blobs/Web.java |  1 +
 .../pixeldungeon/actors/blobs/WellWater.java       |  1 +
 .../watabou/pixeldungeon/actors/buffs/Amok.java    |  1 +
 .../pixeldungeon/actors/buffs/Awareness.java       |  1 +
 .../pixeldungeon/actors/buffs/Barkskin.java        |  1 +
 .../pixeldungeon/actors/buffs/Bleeding.java        |  1 +
 .../pixeldungeon/actors/buffs/Blindness.java       |  1 +
 .../watabou/pixeldungeon/actors/buffs/Buff.java    |  1 +
 .../watabou/pixeldungeon/actors/buffs/Burning.java |  1 +
 .../watabou/pixeldungeon/actors/buffs/Charm.java   |  1 +
 .../watabou/pixeldungeon/actors/buffs/Combo.java   |  1 +
 .../watabou/pixeldungeon/actors/buffs/Cripple.java |  1 +
 .../pixeldungeon/actors/buffs/FlavourBuff.java     |  1 +
 .../watabou/pixeldungeon/actors/buffs/Frost.java   |  1 +
 .../watabou/pixeldungeon/actors/buffs/Fury.java    |  1 +
 .../pixeldungeon/actors/buffs/GasesImmunity.java   |  1 +
 .../watabou/pixeldungeon/actors/buffs/Hunger.java  |  1 +
 .../pixeldungeon/actors/buffs/Invisibility.java    |  1 +
 .../pixeldungeon/actors/buffs/Levitation.java      |  1 +
 .../watabou/pixeldungeon/actors/buffs/Light.java   |  1 +
 .../pixeldungeon/actors/buffs/MindVision.java      |  1 +
 .../watabou/pixeldungeon/actors/buffs/Ooze.java    |  1 +
 .../pixeldungeon/actors/buffs/Paralysis.java       |  1 +
 .../watabou/pixeldungeon/actors/buffs/Poison.java  |  1 +
 .../pixeldungeon/actors/buffs/Regeneration.java    |  6 +-
 .../watabou/pixeldungeon/actors/buffs/Roots.java   |  1 +
 .../watabou/pixeldungeon/actors/buffs/Shadows.java |  1 +
 .../watabou/pixeldungeon/actors/buffs/Sleep.java   |  1 +
 .../watabou/pixeldungeon/actors/buffs/Slow.java    |  1 +
 .../pixeldungeon/actors/buffs/SnipersMark.java     |  1 +
 .../watabou/pixeldungeon/actors/buffs/Speed.java   |  1 +
 .../watabou/pixeldungeon/actors/buffs/Terror.java  |  1 +
 .../watabou/pixeldungeon/actors/buffs/Vertigo.java |  1 +
 .../pixeldungeon/actors/buffs/Weakness.java        |  1 +
 .../pixeldungeon/actors/hero/Belongings.java       |  1 +
 .../com/watabou/pixeldungeon/actors/hero/Hero.java |  1 +
 .../pixeldungeon/actors/hero/HeroAction.java       |  1 +
 .../pixeldungeon/actors/hero/HeroClass.java        |  1 +
 .../pixeldungeon/actors/hero/HeroSubClass.java     |  1 +
 .../watabou/pixeldungeon/actors/mobs/Acidic.java   |  1 +
 .../watabou/pixeldungeon/actors/mobs/Albino.java   |  1 +
 .../watabou/pixeldungeon/actors/mobs/Bandit.java   |  1 +
 .../com/watabou/pixeldungeon/actors/mobs/Bat.java  |  1 +
 .../watabou/pixeldungeon/actors/mobs/Bestiary.java |  1 +
 .../watabou/pixeldungeon/actors/mobs/Brute.java    |  1 +
 .../com/watabou/pixeldungeon/actors/mobs/Crab.java |  1 +
 .../watabou/pixeldungeon/actors/mobs/DM300.java    |  1 +
 .../pixeldungeon/actors/mobs/Elemental.java        |  1 +
 .../com/watabou/pixeldungeon/actors/mobs/Eye.java  |  1 +
 .../watabou/pixeldungeon/actors/mobs/Gnoll.java    |  1 +
 .../watabou/pixeldungeon/actors/mobs/Golem.java    |  1 +
 .../com/watabou/pixeldungeon/actors/mobs/Goo.java  |  1 +
 .../com/watabou/pixeldungeon/actors/mobs/King.java |  1 +
 .../com/watabou/pixeldungeon/actors/mobs/Mob.java  |  1 +
 .../com/watabou/pixeldungeon/actors/mobs/Monk.java |  1 +
 .../watabou/pixeldungeon/actors/mobs/Piranha.java  |  1 +
 .../com/watabou/pixeldungeon/actors/mobs/Rat.java  |  1 +
 .../watabou/pixeldungeon/actors/mobs/Scorpio.java  |  1 +
 .../watabou/pixeldungeon/actors/mobs/Senior.java   |  1 +
 .../watabou/pixeldungeon/actors/mobs/Shaman.java   |  1 +
 .../watabou/pixeldungeon/actors/mobs/Shielded.java |  1 +
 .../watabou/pixeldungeon/actors/mobs/Skeleton.java |  1 +
 .../watabou/pixeldungeon/actors/mobs/Spinner.java  |  1 +
 .../watabou/pixeldungeon/actors/mobs/Statue.java   |  1 +
 .../watabou/pixeldungeon/actors/mobs/Succubus.java |  1 +
 .../watabou/pixeldungeon/actors/mobs/Swarm.java    |  1 +
 .../watabou/pixeldungeon/actors/mobs/Tengu.java    |  1 +
 .../watabou/pixeldungeon/actors/mobs/Thief.java    |  1 +
 .../watabou/pixeldungeon/actors/mobs/Warlock.java  |  1 +
 .../watabou/pixeldungeon/actors/mobs/Wraith.java   |  1 +
 .../com/watabou/pixeldungeon/actors/mobs/Yog.java  |  1 +
 .../pixeldungeon/actors/mobs/npcs/Blacksmith.java  |  1 +
 .../pixeldungeon/actors/mobs/npcs/Ghost.java       |  1 +
 .../watabou/pixeldungeon/actors/mobs/npcs/Imp.java |  1 +
 .../actors/mobs/npcs/ImpShopkeeper.java            |  1 +
 .../pixeldungeon/actors/mobs/npcs/MirrorImage.java |  1 +
 .../watabou/pixeldungeon/actors/mobs/npcs/NPC.java |  1 +
 .../pixeldungeon/actors/mobs/npcs/RatKing.java     |  1 +
 .../pixeldungeon/actors/mobs/npcs/Shopkeeper.java  |  1 +
 .../pixeldungeon/actors/mobs/npcs/Wandmaker.java   |  1 +
 .../watabou/pixeldungeon/effects/BadgeBanner.java  |  1 +
 .../pixeldungeon/effects/BannerSprites.java        |  1 +
 .../watabou/pixeldungeon/effects/BlobEmitter.java  |  1 +
 .../watabou/pixeldungeon/effects/CellEmitter.java  |  1 +
 .../watabou/pixeldungeon/effects/CheckedCell.java  |  1 +
 .../com/watabou/pixeldungeon/effects/DeathRay.java |  1 +
 .../com/watabou/pixeldungeon/effects/Effects.java  |  1 +
 .../com/watabou/pixeldungeon/effects/EmoIcon.java  |  1 +
 .../com/watabou/pixeldungeon/effects/Fireball.java |  1 +
 .../com/watabou/pixeldungeon/effects/Flare.java    |  1 +
 .../watabou/pixeldungeon/effects/FloatingText.java |  1 +
 .../src/com/watabou/pixeldungeon/effects/Halo.java |  1 +
 .../com/watabou/pixeldungeon/effects/IceBlock.java |  1 +
 .../pixeldungeon/effects/Identification.java       |  1 +
 .../watabou/pixeldungeon/effects/Lightning.java    |  1 +
 .../watabou/pixeldungeon/effects/MagicMissile.java |  1 +
 .../com/watabou/pixeldungeon/effects/Pushing.java  |  1 +
 .../com/watabou/pixeldungeon/effects/Ripple.java   |  1 +
 .../com/watabou/pixeldungeon/effects/Speck.java    |  1 +
 .../watabou/pixeldungeon/effects/SpellSprite.java  |  1 +
 .../com/watabou/pixeldungeon/effects/Splash.java   |  1 +
 .../watabou/pixeldungeon/effects/TorchHalo.java    |  1 +
 .../com/watabou/pixeldungeon/effects/Wound.java    |  1 +
 .../effects/particles/BloodParticle.java           |  1 +
 .../effects/particles/EarthParticle.java           |  1 +
 .../effects/particles/ElmoParticle.java            |  1 +
 .../effects/particles/EnergyParticle.java          |  1 +
 .../effects/particles/FlameParticle.java           |  1 +
 .../effects/particles/FlowParticle.java            |  1 +
 .../effects/particles/LeafParticle.java            |  1 +
 .../effects/particles/PoisonParticle.java          |  1 +
 .../effects/particles/PurpleParticle.java          |  1 +
 .../effects/particles/ShadowParticle.java          |  1 +
 .../effects/particles/ShaftParticle.java           |  1 +
 .../effects/particles/SnowParticle.java            |  1 +
 .../effects/particles/SparkParticle.java           |  1 +
 .../effects/particles/WebParticle.java             |  1 +
 .../effects/particles/WindParticle.java            |  1 +
 .../effects/particles/WoolParticle.java            |  1 +
 .../src/com/watabou/pixeldungeon/items/Amulet.java |  1 +
 core/src/com/watabou/pixeldungeon/items/Ankh.java  |  1 +
 .../com/watabou/pixeldungeon/items/ArmorKit.java   |  1 +
 .../com/watabou/pixeldungeon/items/DewVial.java    |  1 +
 .../com/watabou/pixeldungeon/items/Dewdrop.java    |  1 +
 .../watabou/pixeldungeon/items/EquipableItem.java  |  1 +
 .../com/watabou/pixeldungeon/items/Generator.java  |  1 +
 core/src/com/watabou/pixeldungeon/items/Gold.java  |  1 +
 core/src/com/watabou/pixeldungeon/items/Heap.java  |  1 +
 core/src/com/watabou/pixeldungeon/items/Item.java  |  1 +
 .../pixeldungeon/items/ItemStatusHandler.java      |  1 +
 .../watabou/pixeldungeon/items/KindOfWeapon.java   |  1 +
 .../watabou/pixeldungeon/items/LloydsBeacon.java   |  1 +
 .../src/com/watabou/pixeldungeon/items/Stylus.java |  1 +
 .../watabou/pixeldungeon/items/TomeOfMastery.java  |  1 +
 core/src/com/watabou/pixeldungeon/items/Torch.java |  1 +
 .../watabou/pixeldungeon/items/Weightstone.java    |  1 +
 .../watabou/pixeldungeon/items/armor/Armor.java    |  1 +
 .../pixeldungeon/items/armor/ClassArmor.java       |  1 +
 .../pixeldungeon/items/armor/ClothArmor.java       |  1 +
 .../pixeldungeon/items/armor/HuntressArmor.java    |  1 +
 .../pixeldungeon/items/armor/LeatherArmor.java     |  1 +
 .../pixeldungeon/items/armor/MageArmor.java        |  1 +
 .../pixeldungeon/items/armor/MailArmor.java        |  1 +
 .../pixeldungeon/items/armor/PlateArmor.java       |  1 +
 .../pixeldungeon/items/armor/RogueArmor.java       |  1 +
 .../pixeldungeon/items/armor/ScaleArmor.java       |  1 +
 .../pixeldungeon/items/armor/WarriorArmor.java     |  1 +
 .../pixeldungeon/items/armor/glyphs/Affection.java |  1 +
 .../items/armor/glyphs/AntiEntropy.java            |  1 +
 .../pixeldungeon/items/armor/glyphs/Bounce.java    |  1 +
 .../items/armor/glyphs/Displacement.java           |  1 +
 .../items/armor/glyphs/Entanglement.java           |  1 +
 .../items/armor/glyphs/Metabolism.java             |  1 +
 .../items/armor/glyphs/Multiplicity.java           |  1 +
 .../pixeldungeon/items/armor/glyphs/Potential.java |  1 +
 .../pixeldungeon/items/armor/glyphs/Stench.java    |  1 +
 .../pixeldungeon/items/armor/glyphs/Viscosity.java |  1 +
 .../com/watabou/pixeldungeon/items/bags/Bag.java   |  1 +
 .../pixeldungeon/items/bags/ScrollHolder.java      |  1 +
 .../watabou/pixeldungeon/items/bags/SeedPouch.java |  1 +
 .../pixeldungeon/items/bags/WandHolster.java       |  1 +
 .../pixeldungeon/items/food/ChargrilledMeat.java   |  1 +
 .../com/watabou/pixeldungeon/items/food/Food.java  |  1 +
 .../pixeldungeon/items/food/FrozenCarpaccio.java   |  1 +
 .../pixeldungeon/items/food/MysteryMeat.java       |  1 +
 .../pixeldungeon/items/food/OverpricedRation.java  |  1 +
 .../com/watabou/pixeldungeon/items/food/Pasty.java |  1 +
 .../watabou/pixeldungeon/items/keys/GoldenKey.java |  1 +
 .../watabou/pixeldungeon/items/keys/IronKey.java   |  1 +
 .../com/watabou/pixeldungeon/items/keys/Key.java   |  1 +
 .../pixeldungeon/items/keys/SkeletonKey.java       |  1 +
 .../watabou/pixeldungeon/items/potions/Potion.java |  1 +
 .../items/potions/PotionOfExperience.java          |  1 +
 .../pixeldungeon/items/potions/PotionOfFrost.java  |  1 +
 .../items/potions/PotionOfHealing.java             |  1 +
 .../items/potions/PotionOfInvisibility.java        |  1 +
 .../items/potions/PotionOfLevitation.java          |  1 +
 .../items/potions/PotionOfLiquidFlame.java         |  1 +
 .../pixeldungeon/items/potions/PotionOfMight.java  |  1 +
 .../items/potions/PotionOfMindVision.java          |  1 +
 .../items/potions/PotionOfParalyticGas.java        |  1 +
 .../pixeldungeon/items/potions/PotionOfPurity.java |  1 +
 .../items/potions/PotionOfStrength.java            |  1 +
 .../items/potions/PotionOfToxicGas.java            |  1 +
 .../pixeldungeon/items/quest/CorpseDust.java       |  1 +
 .../watabou/pixeldungeon/items/quest/DarkGold.java |  1 +
 .../pixeldungeon/items/quest/DriedRose.java        |  1 +
 .../pixeldungeon/items/quest/DwarfToken.java       |  1 +
 .../watabou/pixeldungeon/items/quest/Pickaxe.java  |  1 +
 .../watabou/pixeldungeon/items/quest/RatSkull.java |  1 +
 .../com/watabou/pixeldungeon/items/rings/Ring.java |  1 +
 .../pixeldungeon/items/rings/RingOfAccuracy.java   |  1 +
 .../pixeldungeon/items/rings/RingOfDetection.java  |  1 +
 .../pixeldungeon/items/rings/RingOfElements.java   |  1 +
 .../pixeldungeon/items/rings/RingOfEvasion.java    |  1 +
 .../pixeldungeon/items/rings/RingOfHaggler.java    |  1 +
 .../pixeldungeon/items/rings/RingOfHaste.java      |  1 +
 .../pixeldungeon/items/rings/RingOfHerbalism.java  |  1 +
 .../pixeldungeon/items/rings/RingOfMending.java    |  1 +
 .../pixeldungeon/items/rings/RingOfPower.java      |  1 +
 .../pixeldungeon/items/rings/RingOfSatiety.java    |  1 +
 .../pixeldungeon/items/rings/RingOfShadows.java    |  1 +
 .../pixeldungeon/items/rings/RingOfThorns.java     |  1 +
 .../items/scrolls/InventoryScroll.java             |  1 +
 .../watabou/pixeldungeon/items/scrolls/Scroll.java |  1 +
 .../items/scrolls/ScrollOfChallenge.java           |  1 +
 .../items/scrolls/ScrollOfIdentify.java            |  1 +
 .../items/scrolls/ScrollOfLullaby.java             |  1 +
 .../items/scrolls/ScrollOfMagicMapping.java        |  1 +
 .../items/scrolls/ScrollOfMirrorImage.java         |  1 +
 .../items/scrolls/ScrollOfPsionicBlast.java        |  1 +
 .../items/scrolls/ScrollOfRecharging.java          |  1 +
 .../items/scrolls/ScrollOfRemoveCurse.java         |  1 +
 .../items/scrolls/ScrollOfTeleportation.java       |  1 +
 .../pixeldungeon/items/scrolls/ScrollOfTerror.java |  1 +
 .../items/scrolls/ScrollOfUpgrade.java             |  1 +
 .../items/scrolls/ScrollOfWeaponUpgrade.java       |  1 +
 .../com/watabou/pixeldungeon/items/wands/Wand.java |  1 +
 .../pixeldungeon/items/wands/WandOfAmok.java       |  1 +
 .../pixeldungeon/items/wands/WandOfAvalanche.java  |  1 +
 .../pixeldungeon/items/wands/WandOfBlink.java      |  1 +
 .../items/wands/WandOfDisintegration.java          |  1 +
 .../pixeldungeon/items/wands/WandOfFirebolt.java   |  1 +
 .../pixeldungeon/items/wands/WandOfFlock.java      |  1 +
 .../pixeldungeon/items/wands/WandOfLightning.java  |  1 +
 .../items/wands/WandOfMagicMissile.java            |  1 +
 .../pixeldungeon/items/wands/WandOfPoison.java     |  1 +
 .../pixeldungeon/items/wands/WandOfRegrowth.java   |  1 +
 .../pixeldungeon/items/wands/WandOfSlowness.java   |  1 +
 .../items/wands/WandOfTelekinesis.java             |  1 +
 .../items/wands/WandOfTeleportation.java           |  1 +
 .../watabou/pixeldungeon/items/weapon/Weapon.java  |  1 +
 .../items/weapon/enchantments/Death.java           |  1 +
 .../items/weapon/enchantments/Fire.java            |  1 +
 .../items/weapon/enchantments/Horror.java          |  1 +
 .../items/weapon/enchantments/Instability.java     |  1 +
 .../items/weapon/enchantments/Leech.java           |  1 +
 .../items/weapon/enchantments/Luck.java            |  1 +
 .../items/weapon/enchantments/Paralysis.java       |  1 +
 .../items/weapon/enchantments/Piercing.java        |  1 +
 .../items/weapon/enchantments/Poison.java          |  1 +
 .../items/weapon/enchantments/Slow.java            |  1 +
 .../items/weapon/enchantments/Swing.java           |  1 +
 .../pixeldungeon/items/weapon/melee/BattleAxe.java |  1 +
 .../pixeldungeon/items/weapon/melee/Dagger.java    |  1 +
 .../pixeldungeon/items/weapon/melee/Glaive.java    |  1 +
 .../pixeldungeon/items/weapon/melee/Knuckles.java  |  1 +
 .../pixeldungeon/items/weapon/melee/Longsword.java |  1 +
 .../pixeldungeon/items/weapon/melee/Mace.java      |  1 +
 .../items/weapon/melee/MeleeWeapon.java            |  1 +
 .../items/weapon/melee/Quarterstaff.java           |  1 +
 .../items/weapon/melee/ShortSword.java             |  1 +
 .../pixeldungeon/items/weapon/melee/Spear.java     |  1 +
 .../pixeldungeon/items/weapon/melee/Sword.java     |  1 +
 .../pixeldungeon/items/weapon/melee/WarHammer.java |  1 +
 .../items/weapon/missiles/Boomerang.java           |  1 +
 .../items/weapon/missiles/CurareDart.java          |  1 +
 .../pixeldungeon/items/weapon/missiles/Dart.java   |  1 +
 .../items/weapon/missiles/IncendiaryDart.java      |  1 +
 .../items/weapon/missiles/Javelin.java             |  1 +
 .../items/weapon/missiles/MissileWeapon.java       |  1 +
 .../items/weapon/missiles/Shuriken.java            |  1 +
 .../items/weapon/missiles/Tamahawk.java            |  1 +
 .../pixeldungeon/levels/CavesBossLevel.java        |  1 +
 .../watabou/pixeldungeon/levels/CavesLevel.java    |  1 +
 .../watabou/pixeldungeon/levels/CityBossLevel.java |  1 +
 .../com/watabou/pixeldungeon/levels/CityLevel.java |  1 +
 .../watabou/pixeldungeon/levels/DeadEndLevel.java  |  1 +
 .../pixeldungeon/levels/HallsBossLevel.java        |  1 +
 .../watabou/pixeldungeon/levels/HallsLevel.java    |  1 +
 .../com/watabou/pixeldungeon/levels/LastLevel.java |  1 +
 .../watabou/pixeldungeon/levels/LastShopLevel.java |  1 +
 .../src/com/watabou/pixeldungeon/levels/Level.java |  1 +
 .../src/com/watabou/pixeldungeon/levels/Patch.java |  1 +
 .../pixeldungeon/levels/PrisonBossLevel.java       |  1 +
 .../watabou/pixeldungeon/levels/PrisonLevel.java   |  1 +
 .../watabou/pixeldungeon/levels/RegularLevel.java  |  1 +
 core/src/com/watabou/pixeldungeon/levels/Room.java |  1 +
 .../pixeldungeon/levels/SewerBossLevel.java        |  1 +
 .../watabou/pixeldungeon/levels/SewerLevel.java    |  1 +
 .../com/watabou/pixeldungeon/levels/Terrain.java   |  1 +
 .../pixeldungeon/levels/features/AlchemyPot.java   |  1 +
 .../pixeldungeon/levels/features/Chasm.java        |  1 +
 .../watabou/pixeldungeon/levels/features/Door.java |  1 +
 .../pixeldungeon/levels/features/HighGrass.java    |  1 +
 .../levels/painters/ArmoryPainter.java             |  1 +
 .../levels/painters/BlacksmithPainter.java         |  1 +
 .../levels/painters/BossExitPainter.java           |  1 +
 .../pixeldungeon/levels/painters/CryptPainter.java |  1 +
 .../levels/painters/EntrancePainter.java           |  1 +
 .../pixeldungeon/levels/painters/ExitPainter.java  |  1 +
 .../levels/painters/GardenPainter.java             |  1 +
 .../levels/painters/LaboratoryPainter.java         |  1 +
 .../levels/painters/LibraryPainter.java            |  1 +
 .../levels/painters/MagicWellPainter.java          |  1 +
 .../pixeldungeon/levels/painters/Painter.java      |  1 +
 .../levels/painters/PassagePainter.java            |  1 +
 .../pixeldungeon/levels/painters/PitPainter.java   |  1 +
 .../pixeldungeon/levels/painters/PoolPainter.java  |  1 +
 .../levels/painters/RatKingPainter.java            |  1 +
 .../pixeldungeon/levels/painters/ShopPainter.java  |  1 +
 .../levels/painters/StandardPainter.java           |  1 +
 .../levels/painters/StatuePainter.java             |  1 +
 .../levels/painters/StoragePainter.java            |  1 +
 .../pixeldungeon/levels/painters/TrapsPainter.java |  1 +
 .../levels/painters/TreasuryPainter.java           |  1 +
 .../levels/painters/TunnelPainter.java             |  1 +
 .../pixeldungeon/levels/painters/VaultPainter.java |  1 +
 .../levels/painters/WeakFloorPainter.java          |  1 +
 .../pixeldungeon/levels/traps/AlarmTrap.java       |  1 +
 .../pixeldungeon/levels/traps/FireTrap.java        |  1 +
 .../pixeldungeon/levels/traps/GrippingTrap.java    |  1 +
 .../pixeldungeon/levels/traps/LightningTrap.java   |  1 +
 .../pixeldungeon/levels/traps/ParalyticTrap.java   |  1 +
 .../pixeldungeon/levels/traps/PoisonTrap.java      |  1 +
 .../pixeldungeon/levels/traps/SummoningTrap.java   |  1 +
 .../pixeldungeon/levels/traps/ToxicTrap.java       |  1 +
 .../watabou/pixeldungeon/mechanics/Ballistica.java |  1 +
 .../pixeldungeon/mechanics/ShadowCaster.java       |  1 +
 .../com/watabou/pixeldungeon/plants/Blindweed.java | 80 ----------------------
 .../com/watabou/pixeldungeon/plants/Dreamweed.java |  1 +
 .../com/watabou/pixeldungeon/plants/Earthroot.java |  1 +
 .../com/watabou/pixeldungeon/plants/Fadeleaf.java  |  1 +
 .../com/watabou/pixeldungeon/plants/Firebloom.java |  1 +
 .../com/watabou/pixeldungeon/plants/Icecap.java    |  1 +
 .../src/com/watabou/pixeldungeon/plants/Plant.java |  1 +
 .../watabou/pixeldungeon/plants/Sorrowmoss.java    |  1 +
 .../com/watabou/pixeldungeon/plants/Sungrass.java  |  1 +
 .../watabou/pixeldungeon/scenes/AboutScene.java    |  1 +
 .../watabou/pixeldungeon/scenes/AmuletScene.java   |  1 +
 .../watabou/pixeldungeon/scenes/BadgesScene.java   |  1 +
 .../watabou/pixeldungeon/scenes/CellSelector.java  |  1 +
 .../com/watabou/pixeldungeon/scenes/GameScene.java |  1 +
 .../pixeldungeon/scenes/InterlevelScene.java       |  1 +
 .../watabou/pixeldungeon/scenes/IntroScene.java    |  1 +
 .../watabou/pixeldungeon/scenes/PixelScene.java    |  1 +
 .../watabou/pixeldungeon/scenes/RankingsScene.java |  1 +
 .../watabou/pixeldungeon/scenes/StartScene.java    |  1 +
 .../watabou/pixeldungeon/scenes/SurfaceScene.java  |  1 +
 .../watabou/pixeldungeon/scenes/TitleScene.java    |  1 +
 .../watabou/pixeldungeon/sprites/AcidicSprite.java |  1 +
 .../watabou/pixeldungeon/sprites/AlbinoSprite.java |  1 +
 .../watabou/pixeldungeon/sprites/BanditSprite.java |  1 +
 .../watabou/pixeldungeon/sprites/BatSprite.java    |  1 +
 .../pixeldungeon/sprites/BlacksmithSprite.java     |  1 +
 .../watabou/pixeldungeon/sprites/BruteSprite.java  |  1 +
 .../pixeldungeon/sprites/BurningFistSprite.java    |  1 +
 .../watabou/pixeldungeon/sprites/CharSprite.java   |  1 +
 .../watabou/pixeldungeon/sprites/CrabSprite.java   |  1 +
 .../watabou/pixeldungeon/sprites/DM300Sprite.java  |  1 +
 .../pixeldungeon/sprites/DiscardedItemSprite.java  |  1 +
 .../pixeldungeon/sprites/ElementalSprite.java      |  1 +
 .../watabou/pixeldungeon/sprites/EyeSprite.java    |  1 +
 .../pixeldungeon/sprites/FetidRatSprite.java       |  1 +
 .../watabou/pixeldungeon/sprites/GhostSprite.java  |  1 +
 .../watabou/pixeldungeon/sprites/GnollSprite.java  |  1 +
 .../watabou/pixeldungeon/sprites/GolemSprite.java  |  1 +
 .../watabou/pixeldungeon/sprites/GooSprite.java    |  1 +
 .../watabou/pixeldungeon/sprites/HeroSprite.java   |  1 +
 .../watabou/pixeldungeon/sprites/ImpSprite.java    |  1 +
 .../watabou/pixeldungeon/sprites/ItemSprite.java   |  1 +
 .../pixeldungeon/sprites/ItemSpriteSheet.java      |  1 +
 .../watabou/pixeldungeon/sprites/KingSprite.java   |  1 +
 .../watabou/pixeldungeon/sprites/LarvaSprite.java  |  1 +
 .../watabou/pixeldungeon/sprites/MirrorSprite.java |  1 +
 .../pixeldungeon/sprites/MissileSprite.java        |  1 +
 .../watabou/pixeldungeon/sprites/MobSprite.java    |  1 +
 .../watabou/pixeldungeon/sprites/MonkSprite.java   |  1 +
 .../pixeldungeon/sprites/PiranhaSprite.java        |  1 +
 .../watabou/pixeldungeon/sprites/PlantSprite.java  |  1 +
 .../pixeldungeon/sprites/RatKingSprite.java        |  1 +
 .../watabou/pixeldungeon/sprites/RatSprite.java    |  1 +
 .../pixeldungeon/sprites/RottingFistSprite.java    |  1 +
 .../pixeldungeon/sprites/ScorpioSprite.java        |  1 +
 .../watabou/pixeldungeon/sprites/SeniorSprite.java |  1 +
 .../watabou/pixeldungeon/sprites/ShamanSprite.java |  1 +
 .../watabou/pixeldungeon/sprites/SheepSprite.java  |  1 +
 .../pixeldungeon/sprites/ShieldedSprite.java       |  1 +
 .../pixeldungeon/sprites/ShopkeeperSprite.java     |  1 +
 .../pixeldungeon/sprites/SkeletonSprite.java       |  1 +
 .../pixeldungeon/sprites/SpinnerSprite.java        |  1 +
 .../watabou/pixeldungeon/sprites/StatueSprite.java |  1 +
 .../pixeldungeon/sprites/SuccubusSprite.java       |  1 +
 .../watabou/pixeldungeon/sprites/SwarmSprite.java  |  1 +
 .../watabou/pixeldungeon/sprites/TenguSprite.java  |  1 +
 .../watabou/pixeldungeon/sprites/ThiefSprite.java  |  1 +
 .../watabou/pixeldungeon/sprites/UndeadSprite.java |  1 +
 .../pixeldungeon/sprites/WandmakerSprite.java      |  1 +
 .../pixeldungeon/sprites/WarlockSprite.java        |  1 +
 .../watabou/pixeldungeon/sprites/WraithSprite.java |  1 +
 .../watabou/pixeldungeon/sprites/YogSprite.java    |  1 +
 core/src/com/watabou/pixeldungeon/ui/Archs.java    |  1 +
 .../watabou/pixeldungeon/ui/AttackIndicator.java   |  1 +
 .../com/watabou/pixeldungeon/ui/BadgesList.java    |  1 +
 core/src/com/watabou/pixeldungeon/ui/Banner.java   |  1 +
 .../com/watabou/pixeldungeon/ui/BuffIndicator.java |  1 +
 .../com/watabou/pixeldungeon/ui/BusyIndicator.java |  1 +
 core/src/com/watabou/pixeldungeon/ui/CheckBox.java |  1 +
 core/src/com/watabou/pixeldungeon/ui/Compass.java  |  1 +
 .../watabou/pixeldungeon/ui/DangerIndicator.java   |  1 +
 .../com/watabou/pixeldungeon/ui/ExitButton.java    |  1 +
 core/src/com/watabou/pixeldungeon/ui/GameLog.java  |  1 +
 .../com/watabou/pixeldungeon/ui/GoldIndicator.java |  1 +
 .../watabou/pixeldungeon/ui/HealthIndicator.java   |  1 +
 core/src/com/watabou/pixeldungeon/ui/Icons.java    |  1 +
 core/src/com/watabou/pixeldungeon/ui/ItemSlot.java |  1 +
 .../com/watabou/pixeldungeon/ui/LootIndicator.java |  1 +
 .../com/watabou/pixeldungeon/ui/PrefsButton.java   |  1 +
 .../src/com/watabou/pixeldungeon/ui/QuickSlot.java |  1 +
 .../src/com/watabou/pixeldungeon/ui/RedButton.java |  1 +
 .../com/watabou/pixeldungeon/ui/ScrollPane.java    |  1 +
 .../com/watabou/pixeldungeon/ui/SimpleButton.java  |  1 +
 .../com/watabou/pixeldungeon/ui/StatusPane.java    |  1 +
 core/src/com/watabou/pixeldungeon/ui/Tag.java      |  1 +
 core/src/com/watabou/pixeldungeon/ui/Toast.java    |  1 +
 core/src/com/watabou/pixeldungeon/ui/Toolbar.java  |  1 +
 core/src/com/watabou/pixeldungeon/ui/Window.java   |  1 +
 .../src/com/watabou/pixeldungeon/utils/BArray.java |  1 +
 core/src/com/watabou/pixeldungeon/utils/GLog.java  |  1 +
 core/src/com/watabou/pixeldungeon/utils/Utils.java |  1 +
 .../watabou/pixeldungeon/windows/IconTitle.java    |  1 +
 .../com/watabou/pixeldungeon/windows/WndBadge.java |  1 +
 .../com/watabou/pixeldungeon/windows/WndBag.java   |  1 +
 .../pixeldungeon/windows/WndBlacksmith.java        |  1 +
 .../watabou/pixeldungeon/windows/WndCatalogus.java |  1 +
 .../pixeldungeon/windows/WndChallenges.java        |  1 +
 .../watabou/pixeldungeon/windows/WndChooseWay.java |  1 +
 .../com/watabou/pixeldungeon/windows/WndClass.java |  1 +
 .../com/watabou/pixeldungeon/windows/WndError.java |  1 +
 .../com/watabou/pixeldungeon/windows/WndGame.java  |  1 +
 .../com/watabou/pixeldungeon/windows/WndHero.java  |  1 +
 .../com/watabou/pixeldungeon/windows/WndImp.java   |  1 +
 .../watabou/pixeldungeon/windows/WndInfoCell.java  |  1 +
 .../watabou/pixeldungeon/windows/WndInfoItem.java  |  1 +
 .../watabou/pixeldungeon/windows/WndInfoMob.java   |  1 +
 .../watabou/pixeldungeon/windows/WndInfoPlant.java |  1 +
 .../com/watabou/pixeldungeon/windows/WndItem.java  |  1 +
 .../watabou/pixeldungeon/windows/WndJournal.java   |  1 +
 .../watabou/pixeldungeon/windows/WndMessage.java   |  1 +
 .../watabou/pixeldungeon/windows/WndOptions.java   |  1 +
 .../com/watabou/pixeldungeon/windows/WndQuest.java |  1 +
 .../watabou/pixeldungeon/windows/WndRanking.java   |  1 +
 .../watabou/pixeldungeon/windows/WndResurrect.java |  1 +
 .../watabou/pixeldungeon/windows/WndSadGhost.java  |  1 +
 .../watabou/pixeldungeon/windows/WndSettings.java  |  1 +
 .../com/watabou/pixeldungeon/windows/WndStory.java |  1 +
 .../watabou/pixeldungeon/windows/WndTabbed.java    |  1 +
 .../pixeldungeon/windows/WndTitledMessage.java     |  1 +
 .../watabou/pixeldungeon/windows/WndTradeItem.java |  1 +
 .../watabou/pixeldungeon/windows/WndWandmaker.java |  1 +
 479 files changed, 478 insertions(+), 85 deletions(-)
 delete mode 100644 core/src/com/watabou/pixeldungeon/plants/Blindweed.java

diff --git a/core/src/com/watabou/pixeldungeon/Assets.java b/core/src/com/watabou/pixeldungeon/Assets.java
index 20c9ceb..7ad4b01 100644
--- a/core/src/com/watabou/pixeldungeon/Assets.java
+++ b/core/src/com/watabou/pixeldungeon/Assets.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Badges.java b/core/src/com/watabou/pixeldungeon/Badges.java
index 142bc89..baba532 100644
--- a/core/src/com/watabou/pixeldungeon/Badges.java
+++ b/core/src/com/watabou/pixeldungeon/Badges.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Bones.java b/core/src/com/watabou/pixeldungeon/Bones.java
index d8e6741..e741b52 100644
--- a/core/src/com/watabou/pixeldungeon/Bones.java
+++ b/core/src/com/watabou/pixeldungeon/Bones.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Challenges.java b/core/src/com/watabou/pixeldungeon/Challenges.java
index e65ccba..c0bb978 100644
--- a/core/src/com/watabou/pixeldungeon/Challenges.java
+++ b/core/src/com/watabou/pixeldungeon/Challenges.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Chrome.java b/core/src/com/watabou/pixeldungeon/Chrome.java
index 3420574..2cb5958 100644
--- a/core/src/com/watabou/pixeldungeon/Chrome.java
+++ b/core/src/com/watabou/pixeldungeon/Chrome.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Dungeon.java b/core/src/com/watabou/pixeldungeon/Dungeon.java
index 48bcacc..f93365e 100644
--- a/core/src/com/watabou/pixeldungeon/Dungeon.java
+++ b/core/src/com/watabou/pixeldungeon/Dungeon.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/DungeonTilemap.java b/core/src/com/watabou/pixeldungeon/DungeonTilemap.java
index b0c7d4b..4d0e727 100644
--- a/core/src/com/watabou/pixeldungeon/DungeonTilemap.java
+++ b/core/src/com/watabou/pixeldungeon/DungeonTilemap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/FogOfWar.java b/core/src/com/watabou/pixeldungeon/FogOfWar.java
index aea4464..9e86ee2 100644
--- a/core/src/com/watabou/pixeldungeon/FogOfWar.java
+++ b/core/src/com/watabou/pixeldungeon/FogOfWar.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/GamesInProgress.java b/core/src/com/watabou/pixeldungeon/GamesInProgress.java
index fe7d62a..797170e 100644
--- a/core/src/com/watabou/pixeldungeon/GamesInProgress.java
+++ b/core/src/com/watabou/pixeldungeon/GamesInProgress.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Journal.java b/core/src/com/watabou/pixeldungeon/Journal.java
index 8a3bea8..3edf2b4 100644
--- a/core/src/com/watabou/pixeldungeon/Journal.java
+++ b/core/src/com/watabou/pixeldungeon/Journal.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/PixelDungeon.java b/core/src/com/watabou/pixeldungeon/PixelDungeon.java
index 65cdce7..f71089a 100644
--- a/core/src/com/watabou/pixeldungeon/PixelDungeon.java
+++ b/core/src/com/watabou/pixeldungeon/PixelDungeon.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Preferences.java b/core/src/com/watabou/pixeldungeon/Preferences.java
index e88fcd9..2fba0c0 100644
--- a/core/src/com/watabou/pixeldungeon/Preferences.java
+++ b/core/src/com/watabou/pixeldungeon/Preferences.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Rankings.java b/core/src/com/watabou/pixeldungeon/Rankings.java
index 0db1c46..9e8fc98 100644
--- a/core/src/com/watabou/pixeldungeon/Rankings.java
+++ b/core/src/com/watabou/pixeldungeon/Rankings.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ResultDescriptions.java b/core/src/com/watabou/pixeldungeon/ResultDescriptions.java
index e218e9d..27248a0 100644
--- a/core/src/com/watabou/pixeldungeon/ResultDescriptions.java
+++ b/core/src/com/watabou/pixeldungeon/ResultDescriptions.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/Statistics.java b/core/src/com/watabou/pixeldungeon/Statistics.java
index 2409be5..2b74531 100644
--- a/core/src/com/watabou/pixeldungeon/Statistics.java
+++ b/core/src/com/watabou/pixeldungeon/Statistics.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/Actor.java b/core/src/com/watabou/pixeldungeon/actors/Actor.java
index 8d3af6a..e7c80fa 100644
--- a/core/src/com/watabou/pixeldungeon/actors/Actor.java
+++ b/core/src/com/watabou/pixeldungeon/actors/Actor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/Char.java b/core/src/com/watabou/pixeldungeon/actors/Char.java
index f7b1b40..3ccb823 100644
--- a/core/src/com/watabou/pixeldungeon/actors/Char.java
+++ b/core/src/com/watabou/pixeldungeon/actors/Char.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Alchemy.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Alchemy.java
index cc8cf6b..fc02374 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Alchemy.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Alchemy.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Blob.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Blob.java
index 960a640..8bbda7e 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Blob.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Blob.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/ConfusionGas.java b/core/src/com/watabou/pixeldungeon/actors/blobs/ConfusionGas.java
index 2d28c6a..49e03d1 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/ConfusionGas.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/ConfusionGas.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Fire.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Fire.java
index adfd079..79fe55a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Fire.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Fire.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Foliage.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Foliage.java
index 0fa643d..f6099c3 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Foliage.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Foliage.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Freezing.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Freezing.java
index 2eb4f80..9ec2aec 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Freezing.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Freezing.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/ParalyticGas.java b/core/src/com/watabou/pixeldungeon/actors/blobs/ParalyticGas.java
index c9a1d94..cae7c22 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/ParalyticGas.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/ParalyticGas.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Regrowth.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Regrowth.java
index 4985591..794c024 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Regrowth.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Regrowth.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/ToxicGas.java b/core/src/com/watabou/pixeldungeon/actors/blobs/ToxicGas.java
index a3df0e9..e9e7dcf 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/ToxicGas.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/ToxicGas.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfAwareness.java b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfAwareness.java
index bee36c7..4a589a3 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfAwareness.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfAwareness.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfHealth.java b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfHealth.java
index 450737e..0710151 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfHealth.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfHealth.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfTransmutation.java b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfTransmutation.java
index 6537ca6..07c82c3 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfTransmutation.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/WaterOfTransmutation.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/Web.java b/core/src/com/watabou/pixeldungeon/actors/blobs/Web.java
index 0d2eaaf..00695bb 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/Web.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/Web.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/blobs/WellWater.java b/core/src/com/watabou/pixeldungeon/actors/blobs/WellWater.java
index 3d98f88..d59956d 100644
--- a/core/src/com/watabou/pixeldungeon/actors/blobs/WellWater.java
+++ b/core/src/com/watabou/pixeldungeon/actors/blobs/WellWater.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Amok.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Amok.java
index 14ce3d3..48a260a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Amok.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Amok.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Awareness.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Awareness.java
index b60d12e..252e901 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Awareness.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Awareness.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Barkskin.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Barkskin.java
index b049bee..d61cdd3 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Barkskin.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Barkskin.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Bleeding.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Bleeding.java
index febc3c7..32f8d9f 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Bleeding.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Bleeding.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Blindness.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Blindness.java
index ef30f4c..a23f343 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Blindness.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Blindness.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Buff.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Buff.java
index 85ccf50..d3ab358 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Buff.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Buff.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Burning.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Burning.java
index 4997af4..e88687b 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Burning.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Burning.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Charm.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Charm.java
index 3d5f6ec..d363acc 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Charm.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Charm.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Combo.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Combo.java
index b78f9a1..9956f47 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Combo.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Combo.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Cripple.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Cripple.java
index 0939b49..c50c3b4 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Cripple.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Cripple.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/FlavourBuff.java b/core/src/com/watabou/pixeldungeon/actors/buffs/FlavourBuff.java
index 32c4eba..452c15b 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/FlavourBuff.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/FlavourBuff.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Frost.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Frost.java
index ea76b32..18546ce 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Frost.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Frost.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Fury.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Fury.java
index 7f6d0ee..fb2777a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Fury.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Fury.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/GasesImmunity.java b/core/src/com/watabou/pixeldungeon/actors/buffs/GasesImmunity.java
index d39fc2e..fab1d89 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/GasesImmunity.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/GasesImmunity.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Hunger.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Hunger.java
index c9c5892..4e4ea63 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Hunger.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Hunger.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Invisibility.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Invisibility.java
index 6518b9d..cf44544 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Invisibility.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Invisibility.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Levitation.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Levitation.java
index 3b064d0..c3d64c8 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Levitation.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Levitation.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Light.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Light.java
index b17743a..7f2baa4 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Light.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Light.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/MindVision.java b/core/src/com/watabou/pixeldungeon/actors/buffs/MindVision.java
index 7537949..4032e60 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/MindVision.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/MindVision.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Ooze.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Ooze.java
index 359be06..564e46d 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Ooze.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Ooze.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Paralysis.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Paralysis.java
index 13c0607..ed69359 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Paralysis.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Paralysis.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Poison.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Poison.java
index 2e03bec..83ac449 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Poison.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Poison.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Regeneration.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Regeneration.java
index 5fa02a3..fd1a028 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Regeneration.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Regeneration.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
@@ -19,11 +20,6 @@ package com.watabou.pixeldungeon.actors.buffs;
 import com.watabou.pixeldungeon.actors.hero.Hero;
 import com.watabou.pixeldungeon.items.rings.RingOfMending;
 
-/**
- *          .
- *     ,    
- * ()  
- */
 public class Regeneration extends Buff {
 	
 	private static final float REGENERATION_DELAY = 10;
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Roots.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Roots.java
index a6a4d6a..932dfbb 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Roots.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Roots.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Shadows.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Shadows.java
index 584ebdf..ae6e4fc 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Shadows.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Shadows.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Sleep.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Sleep.java
index 3b0cea4..7ffff90 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Sleep.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Sleep.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Slow.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Slow.java
index 9cacf80..80f3b7f 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Slow.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Slow.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/SnipersMark.java b/core/src/com/watabou/pixeldungeon/actors/buffs/SnipersMark.java
index d8a5b5e..01ca64f 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/SnipersMark.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/SnipersMark.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Speed.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Speed.java
index 6635c81..cccdc69 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Speed.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Speed.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Terror.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Terror.java
index 574b374..d905e2d 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Terror.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Terror.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Vertigo.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Vertigo.java
index 72eba20..6afd048 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Vertigo.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Vertigo.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/buffs/Weakness.java b/core/src/com/watabou/pixeldungeon/actors/buffs/Weakness.java
index 647d10f..52df8f8 100644
--- a/core/src/com/watabou/pixeldungeon/actors/buffs/Weakness.java
+++ b/core/src/com/watabou/pixeldungeon/actors/buffs/Weakness.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java b/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java
index cff405e..45ab3cb 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java b/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java
index cb24cf7..18d7235 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/HeroAction.java b/core/src/com/watabou/pixeldungeon/actors/hero/HeroAction.java
index 5e934cd..717e131 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/HeroAction.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/HeroAction.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/HeroClass.java b/core/src/com/watabou/pixeldungeon/actors/hero/HeroClass.java
index 12d4bc1..d009473 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/HeroClass.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/HeroClass.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/HeroSubClass.java b/core/src/com/watabou/pixeldungeon/actors/hero/HeroSubClass.java
index 614c709..99f932a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/HeroSubClass.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/HeroSubClass.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Acidic.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Acidic.java
index 3ff0723..82f7339 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Acidic.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Acidic.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Albino.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Albino.java
index b4dfbc6..8dd19bb 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Albino.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Albino.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Bandit.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Bandit.java
index 2407adb..5245bfa 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Bandit.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Bandit.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Bat.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Bat.java
index 1dfb916..4da00ce 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Bat.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Bat.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Bestiary.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Bestiary.java
index c6b3397..042db67 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Bestiary.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Bestiary.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Brute.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Brute.java
index 018ee06..acc104c 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Brute.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Brute.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Crab.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Crab.java
index 6a30147..53ccd7c 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Crab.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Crab.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/DM300.java b/core/src/com/watabou/pixeldungeon/actors/mobs/DM300.java
index 4f665f7..a1f63e6 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/DM300.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/DM300.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Elemental.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Elemental.java
index 39c0065..6954ce9 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Elemental.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Elemental.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java
index a94de5a..1b8fe37 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Gnoll.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Gnoll.java
index 1d318e8..caa13a4 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Gnoll.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Gnoll.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Golem.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Golem.java
index b818178..f1e633a 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Golem.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Golem.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Goo.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Goo.java
index 9a09246..9f1fcfc 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Goo.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Goo.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/King.java b/core/src/com/watabou/pixeldungeon/actors/mobs/King.java
index 7f9e606..ff9b060 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/King.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/King.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Mob.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Mob.java
index befc05c..4c68835 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Mob.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Mob.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Monk.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Monk.java
index bc67e8f..f3697ac 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Monk.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Monk.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Piranha.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Piranha.java
index 63f2ace..551f5be 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Piranha.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Piranha.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Rat.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Rat.java
index 43dc546..cb06ea2 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Rat.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Rat.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Scorpio.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Scorpio.java
index dab7ba4..86bc08b 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Scorpio.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Scorpio.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Senior.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Senior.java
index 838d05f..4f1e2cc 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Senior.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Senior.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Shaman.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Shaman.java
index 9955787..97515f9 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Shaman.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Shaman.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Shielded.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Shielded.java
index 3009e48..c4e4329 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Shielded.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Shielded.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Skeleton.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Skeleton.java
index 87c18e9..4c9b3a3 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Skeleton.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Skeleton.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Spinner.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Spinner.java
index 5e8d23c..b68fa39 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Spinner.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Spinner.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Statue.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Statue.java
index 8fe5cc8..e5ecd87 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Statue.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Statue.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Succubus.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Succubus.java
index 8e33f2a..764c593 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Succubus.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Succubus.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Swarm.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Swarm.java
index 38493ee..afbe3da 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Swarm.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Swarm.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Tengu.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Tengu.java
index 571dc74..8bdd93b 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Tengu.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Tengu.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Thief.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Thief.java
index f275750..46e06aa 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Thief.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Thief.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Warlock.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Warlock.java
index d373d25..de3e863 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Warlock.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Warlock.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Wraith.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Wraith.java
index d7377ba..4f54bc8 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Wraith.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Wraith.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Yog.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Yog.java
index 3f2651b..8168d20 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Yog.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Yog.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Blacksmith.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Blacksmith.java
index bad5c0d..cebcb2b 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Blacksmith.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Blacksmith.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Ghost.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Ghost.java
index 5e507b7..eee7709 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Ghost.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Ghost.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Imp.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Imp.java
index 87f7419..330d46b 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Imp.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Imp.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/ImpShopkeeper.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/ImpShopkeeper.java
index be8e099..eed5255 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/ImpShopkeeper.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/ImpShopkeeper.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/MirrorImage.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/MirrorImage.java
index 9ec4f63..0cc3434 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/MirrorImage.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/MirrorImage.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/NPC.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/NPC.java
index 1eb325c..fadb76d 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/NPC.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/NPC.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/RatKing.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/RatKing.java
index 8801bdf..a9e9be8 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/RatKing.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/RatKing.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Shopkeeper.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Shopkeeper.java
index 684ca39..5bcd01b 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Shopkeeper.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Shopkeeper.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Wandmaker.java b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Wandmaker.java
index e27db2c..d91fb01 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Wandmaker.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/npcs/Wandmaker.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/BadgeBanner.java b/core/src/com/watabou/pixeldungeon/effects/BadgeBanner.java
index d32d525..4ae696d 100644
--- a/core/src/com/watabou/pixeldungeon/effects/BadgeBanner.java
+++ b/core/src/com/watabou/pixeldungeon/effects/BadgeBanner.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/BannerSprites.java b/core/src/com/watabou/pixeldungeon/effects/BannerSprites.java
index 4d0f503..c7e347e 100644
--- a/core/src/com/watabou/pixeldungeon/effects/BannerSprites.java
+++ b/core/src/com/watabou/pixeldungeon/effects/BannerSprites.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/BlobEmitter.java b/core/src/com/watabou/pixeldungeon/effects/BlobEmitter.java
index 48ccbc2..2e14219 100644
--- a/core/src/com/watabou/pixeldungeon/effects/BlobEmitter.java
+++ b/core/src/com/watabou/pixeldungeon/effects/BlobEmitter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/CellEmitter.java b/core/src/com/watabou/pixeldungeon/effects/CellEmitter.java
index bdebcb9..bb2751e 100644
--- a/core/src/com/watabou/pixeldungeon/effects/CellEmitter.java
+++ b/core/src/com/watabou/pixeldungeon/effects/CellEmitter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/CheckedCell.java b/core/src/com/watabou/pixeldungeon/effects/CheckedCell.java
index cf70dd4..154000b 100644
--- a/core/src/com/watabou/pixeldungeon/effects/CheckedCell.java
+++ b/core/src/com/watabou/pixeldungeon/effects/CheckedCell.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/DeathRay.java b/core/src/com/watabou/pixeldungeon/effects/DeathRay.java
index cbf65b3..8efbe30 100644
--- a/core/src/com/watabou/pixeldungeon/effects/DeathRay.java
+++ b/core/src/com/watabou/pixeldungeon/effects/DeathRay.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Effects.java b/core/src/com/watabou/pixeldungeon/effects/Effects.java
index 2c0c742..744961c 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Effects.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Effects.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/EmoIcon.java b/core/src/com/watabou/pixeldungeon/effects/EmoIcon.java
index 798a491..f7601c1 100644
--- a/core/src/com/watabou/pixeldungeon/effects/EmoIcon.java
+++ b/core/src/com/watabou/pixeldungeon/effects/EmoIcon.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Fireball.java b/core/src/com/watabou/pixeldungeon/effects/Fireball.java
index 1756b3e..96648f1 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Fireball.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Fireball.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Flare.java b/core/src/com/watabou/pixeldungeon/effects/Flare.java
index aeb8cfb..c03e55b 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Flare.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Flare.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/FloatingText.java b/core/src/com/watabou/pixeldungeon/effects/FloatingText.java
index 4444b16..1654eed 100644
--- a/core/src/com/watabou/pixeldungeon/effects/FloatingText.java
+++ b/core/src/com/watabou/pixeldungeon/effects/FloatingText.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Halo.java b/core/src/com/watabou/pixeldungeon/effects/Halo.java
index 5e425fc..20bc803 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Halo.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Halo.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/IceBlock.java b/core/src/com/watabou/pixeldungeon/effects/IceBlock.java
index b0750f8..24c69b5 100644
--- a/core/src/com/watabou/pixeldungeon/effects/IceBlock.java
+++ b/core/src/com/watabou/pixeldungeon/effects/IceBlock.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Identification.java b/core/src/com/watabou/pixeldungeon/effects/Identification.java
index 1f59aee..44a68d2 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Identification.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Identification.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Lightning.java b/core/src/com/watabou/pixeldungeon/effects/Lightning.java
index 9e19d3e..20dd6b8 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Lightning.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Lightning.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/MagicMissile.java b/core/src/com/watabou/pixeldungeon/effects/MagicMissile.java
index 70d0a18..9e93814 100644
--- a/core/src/com/watabou/pixeldungeon/effects/MagicMissile.java
+++ b/core/src/com/watabou/pixeldungeon/effects/MagicMissile.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Pushing.java b/core/src/com/watabou/pixeldungeon/effects/Pushing.java
index 9427a5c..7dfbb84 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Pushing.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Pushing.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Ripple.java b/core/src/com/watabou/pixeldungeon/effects/Ripple.java
index c25bac0..d45c8df 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Ripple.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Ripple.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Speck.java b/core/src/com/watabou/pixeldungeon/effects/Speck.java
index 0019cee..0f228db 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Speck.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Speck.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/SpellSprite.java b/core/src/com/watabou/pixeldungeon/effects/SpellSprite.java
index 90a7a3a..f27e178 100644
--- a/core/src/com/watabou/pixeldungeon/effects/SpellSprite.java
+++ b/core/src/com/watabou/pixeldungeon/effects/SpellSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Splash.java b/core/src/com/watabou/pixeldungeon/effects/Splash.java
index f22b25a..cf2d9ea 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Splash.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Splash.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/TorchHalo.java b/core/src/com/watabou/pixeldungeon/effects/TorchHalo.java
index 12c0c53..3f2afd4 100644
--- a/core/src/com/watabou/pixeldungeon/effects/TorchHalo.java
+++ b/core/src/com/watabou/pixeldungeon/effects/TorchHalo.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/Wound.java b/core/src/com/watabou/pixeldungeon/effects/Wound.java
index b0d4820..6e4c603 100644
--- a/core/src/com/watabou/pixeldungeon/effects/Wound.java
+++ b/core/src/com/watabou/pixeldungeon/effects/Wound.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/BloodParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/BloodParticle.java
index e879eec..33b91e5 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/BloodParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/BloodParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/EarthParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/EarthParticle.java
index 72d01c7..1d1cb4a 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/EarthParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/EarthParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/ElmoParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/ElmoParticle.java
index 4bbf5a0..d87cf01 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/ElmoParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/ElmoParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/EnergyParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/EnergyParticle.java
index fe97daa..31c97d5 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/EnergyParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/EnergyParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/FlameParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/FlameParticle.java
index 4ded626..ae344f5 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/FlameParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/FlameParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/FlowParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/FlowParticle.java
index 6b34a23..e627800 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/FlowParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/FlowParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/LeafParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/LeafParticle.java
index c8010ac..a0112a4 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/LeafParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/LeafParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/PoisonParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/PoisonParticle.java
index bc3da56..16554f6 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/PoisonParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/PoisonParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/PurpleParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/PurpleParticle.java
index 056ef23..ca378fe 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/PurpleParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/PurpleParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/ShadowParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/ShadowParticle.java
index 68ed798..0df7264 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/ShadowParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/ShadowParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/ShaftParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/ShaftParticle.java
index 106bd8d..ba4c276 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/ShaftParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/ShaftParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/SnowParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/SnowParticle.java
index a55231e..8b4b809 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/SnowParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/SnowParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/SparkParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/SparkParticle.java
index cda0685..f817e43 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/SparkParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/SparkParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/WebParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/WebParticle.java
index 49dceee..4b9ef61 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/WebParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/WebParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/WindParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/WindParticle.java
index ab8433c..676fd29 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/WindParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/WindParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/effects/particles/WoolParticle.java b/core/src/com/watabou/pixeldungeon/effects/particles/WoolParticle.java
index 6bd267e..1361d96 100644
--- a/core/src/com/watabou/pixeldungeon/effects/particles/WoolParticle.java
+++ b/core/src/com/watabou/pixeldungeon/effects/particles/WoolParticle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Amulet.java b/core/src/com/watabou/pixeldungeon/items/Amulet.java
index 92e5181..8e2ef18 100644
--- a/core/src/com/watabou/pixeldungeon/items/Amulet.java
+++ b/core/src/com/watabou/pixeldungeon/items/Amulet.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Ankh.java b/core/src/com/watabou/pixeldungeon/items/Ankh.java
index 979fa01..d7e94f0 100644
--- a/core/src/com/watabou/pixeldungeon/items/Ankh.java
+++ b/core/src/com/watabou/pixeldungeon/items/Ankh.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/ArmorKit.java b/core/src/com/watabou/pixeldungeon/items/ArmorKit.java
index 84cb16d..487de42 100644
--- a/core/src/com/watabou/pixeldungeon/items/ArmorKit.java
+++ b/core/src/com/watabou/pixeldungeon/items/ArmorKit.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/DewVial.java b/core/src/com/watabou/pixeldungeon/items/DewVial.java
index 912327b..5776334 100644
--- a/core/src/com/watabou/pixeldungeon/items/DewVial.java
+++ b/core/src/com/watabou/pixeldungeon/items/DewVial.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Dewdrop.java b/core/src/com/watabou/pixeldungeon/items/Dewdrop.java
index c8f39ec..6bcc6f4 100644
--- a/core/src/com/watabou/pixeldungeon/items/Dewdrop.java
+++ b/core/src/com/watabou/pixeldungeon/items/Dewdrop.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/EquipableItem.java b/core/src/com/watabou/pixeldungeon/items/EquipableItem.java
index db1df2f..3481ce6 100644
--- a/core/src/com/watabou/pixeldungeon/items/EquipableItem.java
+++ b/core/src/com/watabou/pixeldungeon/items/EquipableItem.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Generator.java b/core/src/com/watabou/pixeldungeon/items/Generator.java
index 5ed3bda..8f4d59e 100644
--- a/core/src/com/watabou/pixeldungeon/items/Generator.java
+++ b/core/src/com/watabou/pixeldungeon/items/Generator.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Gold.java b/core/src/com/watabou/pixeldungeon/items/Gold.java
index 4102d91..26ea0f8 100644
--- a/core/src/com/watabou/pixeldungeon/items/Gold.java
+++ b/core/src/com/watabou/pixeldungeon/items/Gold.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Heap.java b/core/src/com/watabou/pixeldungeon/items/Heap.java
index 90749ae..7992251 100644
--- a/core/src/com/watabou/pixeldungeon/items/Heap.java
+++ b/core/src/com/watabou/pixeldungeon/items/Heap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Item.java b/core/src/com/watabou/pixeldungeon/items/Item.java
index 71bdf29..614a21b 100644
--- a/core/src/com/watabou/pixeldungeon/items/Item.java
+++ b/core/src/com/watabou/pixeldungeon/items/Item.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/ItemStatusHandler.java b/core/src/com/watabou/pixeldungeon/items/ItemStatusHandler.java
index 62335db..ca3e41c 100644
--- a/core/src/com/watabou/pixeldungeon/items/ItemStatusHandler.java
+++ b/core/src/com/watabou/pixeldungeon/items/ItemStatusHandler.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/KindOfWeapon.java b/core/src/com/watabou/pixeldungeon/items/KindOfWeapon.java
index 84b2cc0..2dc90a2 100644
--- a/core/src/com/watabou/pixeldungeon/items/KindOfWeapon.java
+++ b/core/src/com/watabou/pixeldungeon/items/KindOfWeapon.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/LloydsBeacon.java b/core/src/com/watabou/pixeldungeon/items/LloydsBeacon.java
index 3eaa861..5be1939 100644
--- a/core/src/com/watabou/pixeldungeon/items/LloydsBeacon.java
+++ b/core/src/com/watabou/pixeldungeon/items/LloydsBeacon.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Stylus.java b/core/src/com/watabou/pixeldungeon/items/Stylus.java
index 708f796..2ad363f 100644
--- a/core/src/com/watabou/pixeldungeon/items/Stylus.java
+++ b/core/src/com/watabou/pixeldungeon/items/Stylus.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/TomeOfMastery.java b/core/src/com/watabou/pixeldungeon/items/TomeOfMastery.java
index 76c2724..6b27c0b 100644
--- a/core/src/com/watabou/pixeldungeon/items/TomeOfMastery.java
+++ b/core/src/com/watabou/pixeldungeon/items/TomeOfMastery.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Torch.java b/core/src/com/watabou/pixeldungeon/items/Torch.java
index 0810982..d4b2104 100644
--- a/core/src/com/watabou/pixeldungeon/items/Torch.java
+++ b/core/src/com/watabou/pixeldungeon/items/Torch.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/Weightstone.java b/core/src/com/watabou/pixeldungeon/items/Weightstone.java
index c20b687..784575a 100644
--- a/core/src/com/watabou/pixeldungeon/items/Weightstone.java
+++ b/core/src/com/watabou/pixeldungeon/items/Weightstone.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/Armor.java b/core/src/com/watabou/pixeldungeon/items/armor/Armor.java
index 26a98a9..ad32aff 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/Armor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/Armor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/ClassArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/ClassArmor.java
index 6932f1f..58c720c 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/ClassArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/ClassArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/ClothArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/ClothArmor.java
index 8b5da95..182bb0d 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/ClothArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/ClothArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/HuntressArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/HuntressArmor.java
index 37a4149..cc3ec8d 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/HuntressArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/HuntressArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/LeatherArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/LeatherArmor.java
index 0f61e86..e4e5343 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/LeatherArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/LeatherArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/MageArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/MageArmor.java
index e7bb8ff..7e2f5a2 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/MageArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/MageArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/MailArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/MailArmor.java
index ec8362e..1039c5f 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/MailArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/MailArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/PlateArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/PlateArmor.java
index 1a26bdd..c69822b 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/PlateArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/PlateArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/RogueArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/RogueArmor.java
index 236d326..d38a490 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/RogueArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/RogueArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/ScaleArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/ScaleArmor.java
index 990606f..5d46e31 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/ScaleArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/ScaleArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/WarriorArmor.java b/core/src/com/watabou/pixeldungeon/items/armor/WarriorArmor.java
index 7f26432..f285c7a 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/WarriorArmor.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/WarriorArmor.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Affection.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Affection.java
index ee26f0d..7e62d96 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Affection.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Affection.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/AntiEntropy.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/AntiEntropy.java
index aa6b84f..86a4283 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/AntiEntropy.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/AntiEntropy.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java
index 9eb3fd6..050fed1 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Bounce.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Displacement.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Displacement.java
index fa0f50f..6174244 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Displacement.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Displacement.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Entanglement.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Entanglement.java
index 3eb6d0d..e41652b 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Entanglement.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Entanglement.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Metabolism.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Metabolism.java
index d80c6b6..20e6c6a 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Metabolism.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Metabolism.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Multiplicity.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Multiplicity.java
index cabc91c..9ce857f 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Multiplicity.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Multiplicity.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Potential.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Potential.java
index 7f6bd37..331cfb5 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Potential.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Potential.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Stench.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Stench.java
index 512defe..af2e29a 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Stench.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Stench.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Viscosity.java b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Viscosity.java
index 0bac8a7..5f688c4 100644
--- a/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Viscosity.java
+++ b/core/src/com/watabou/pixeldungeon/items/armor/glyphs/Viscosity.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/bags/Bag.java b/core/src/com/watabou/pixeldungeon/items/bags/Bag.java
index b3ebf6f..de91ca9 100644
--- a/core/src/com/watabou/pixeldungeon/items/bags/Bag.java
+++ b/core/src/com/watabou/pixeldungeon/items/bags/Bag.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/bags/ScrollHolder.java b/core/src/com/watabou/pixeldungeon/items/bags/ScrollHolder.java
index 191fd2d..0bef891 100644
--- a/core/src/com/watabou/pixeldungeon/items/bags/ScrollHolder.java
+++ b/core/src/com/watabou/pixeldungeon/items/bags/ScrollHolder.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/bags/SeedPouch.java b/core/src/com/watabou/pixeldungeon/items/bags/SeedPouch.java
index 46f74f9..b3515d3 100644
--- a/core/src/com/watabou/pixeldungeon/items/bags/SeedPouch.java
+++ b/core/src/com/watabou/pixeldungeon/items/bags/SeedPouch.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/bags/WandHolster.java b/core/src/com/watabou/pixeldungeon/items/bags/WandHolster.java
index 3b6e221..7339c66 100644
--- a/core/src/com/watabou/pixeldungeon/items/bags/WandHolster.java
+++ b/core/src/com/watabou/pixeldungeon/items/bags/WandHolster.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/ChargrilledMeat.java b/core/src/com/watabou/pixeldungeon/items/food/ChargrilledMeat.java
index 7cf64dd..67ffbde 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/ChargrilledMeat.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/ChargrilledMeat.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/Food.java b/core/src/com/watabou/pixeldungeon/items/food/Food.java
index a69dafd..00e7fbf 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/Food.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/Food.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/FrozenCarpaccio.java b/core/src/com/watabou/pixeldungeon/items/food/FrozenCarpaccio.java
index 2170ce0..a280076 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/FrozenCarpaccio.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/FrozenCarpaccio.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/MysteryMeat.java b/core/src/com/watabou/pixeldungeon/items/food/MysteryMeat.java
index 3528e51..6b3a181 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/MysteryMeat.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/MysteryMeat.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/OverpricedRation.java b/core/src/com/watabou/pixeldungeon/items/food/OverpricedRation.java
index a7783dd..4e33d64 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/OverpricedRation.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/OverpricedRation.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/food/Pasty.java b/core/src/com/watabou/pixeldungeon/items/food/Pasty.java
index 3f94291..af0706d 100644
--- a/core/src/com/watabou/pixeldungeon/items/food/Pasty.java
+++ b/core/src/com/watabou/pixeldungeon/items/food/Pasty.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/keys/GoldenKey.java b/core/src/com/watabou/pixeldungeon/items/keys/GoldenKey.java
index 829ac40..40048bc 100644
--- a/core/src/com/watabou/pixeldungeon/items/keys/GoldenKey.java
+++ b/core/src/com/watabou/pixeldungeon/items/keys/GoldenKey.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java b/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java
index 4ceca08..7e0ff93 100644
--- a/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java
+++ b/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/keys/Key.java b/core/src/com/watabou/pixeldungeon/items/keys/Key.java
index f47fe07..38bda0f 100644
--- a/core/src/com/watabou/pixeldungeon/items/keys/Key.java
+++ b/core/src/com/watabou/pixeldungeon/items/keys/Key.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/keys/SkeletonKey.java b/core/src/com/watabou/pixeldungeon/items/keys/SkeletonKey.java
index ff3af47..7843271 100644
--- a/core/src/com/watabou/pixeldungeon/items/keys/SkeletonKey.java
+++ b/core/src/com/watabou/pixeldungeon/items/keys/SkeletonKey.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/Potion.java b/core/src/com/watabou/pixeldungeon/items/potions/Potion.java
index 1b0f0d4..07ed50a 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/Potion.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/Potion.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfExperience.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfExperience.java
index a52aa08..2288619 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfExperience.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfExperience.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfFrost.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfFrost.java
index d8fd362..408b918 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfFrost.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfFrost.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfHealing.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfHealing.java
index 76992a1..aa2e46a 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfHealing.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfHealing.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfInvisibility.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfInvisibility.java
index f3483cd..5cd804f 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfInvisibility.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfInvisibility.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLevitation.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLevitation.java
index 8386c32..cc5e9d7 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLevitation.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLevitation.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLiquidFlame.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLiquidFlame.java
index 6da7a93..f728124 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLiquidFlame.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfLiquidFlame.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMight.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMight.java
index ef12f97..d560a55 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMight.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMight.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMindVision.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMindVision.java
index 8fd3886..7b155bb 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMindVision.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfMindVision.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfParalyticGas.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfParalyticGas.java
index 1b4447c..7678bd2 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfParalyticGas.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfParalyticGas.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfPurity.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfPurity.java
index 04f7515..d0e04ff 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfPurity.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfPurity.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfStrength.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfStrength.java
index 3b3734e..1e0b072 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfStrength.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfStrength.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfToxicGas.java b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfToxicGas.java
index 60ba8e7..be8a32c 100644
--- a/core/src/com/watabou/pixeldungeon/items/potions/PotionOfToxicGas.java
+++ b/core/src/com/watabou/pixeldungeon/items/potions/PotionOfToxicGas.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/CorpseDust.java b/core/src/com/watabou/pixeldungeon/items/quest/CorpseDust.java
index 38bb7b9..be30f17 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/CorpseDust.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/CorpseDust.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/DarkGold.java b/core/src/com/watabou/pixeldungeon/items/quest/DarkGold.java
index 7206ade..ef94c85 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/DarkGold.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/DarkGold.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/DriedRose.java b/core/src/com/watabou/pixeldungeon/items/quest/DriedRose.java
index 651ca00..be751a5 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/DriedRose.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/DriedRose.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/DwarfToken.java b/core/src/com/watabou/pixeldungeon/items/quest/DwarfToken.java
index 69a8929..3ab8873 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/DwarfToken.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/DwarfToken.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/Pickaxe.java b/core/src/com/watabou/pixeldungeon/items/quest/Pickaxe.java
index f6db373..03caf59 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/Pickaxe.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/Pickaxe.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/quest/RatSkull.java b/core/src/com/watabou/pixeldungeon/items/quest/RatSkull.java
index c581689..612e0af 100644
--- a/core/src/com/watabou/pixeldungeon/items/quest/RatSkull.java
+++ b/core/src/com/watabou/pixeldungeon/items/quest/RatSkull.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/Ring.java b/core/src/com/watabou/pixeldungeon/items/rings/Ring.java
index fbdc707..38f90ce 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/Ring.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/Ring.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfAccuracy.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfAccuracy.java
index 0f3bbc9..1fd4799 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfAccuracy.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfAccuracy.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfDetection.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfDetection.java
index 080c623..6f54dfa 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfDetection.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfDetection.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfElements.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfElements.java
index 0a962f7..bfc8ab1 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfElements.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfElements.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfEvasion.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfEvasion.java
index 835d4db..bcdadbc 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfEvasion.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfEvasion.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaggler.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaggler.java
index 2ccad74..704641f 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaggler.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaggler.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaste.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaste.java
index 461f1c6..26c9afb 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaste.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHaste.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHerbalism.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHerbalism.java
index d9ac8d3..4ed07ec 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfHerbalism.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfHerbalism.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfMending.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfMending.java
index 2c6eaba..f1a3490 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfMending.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfMending.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfPower.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfPower.java
index 0b7166b..372a300 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfPower.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfPower.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfSatiety.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfSatiety.java
index 5b20202..c2adb20 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfSatiety.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfSatiety.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfShadows.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfShadows.java
index 1e9ab28..999f829 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfShadows.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfShadows.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/rings/RingOfThorns.java b/core/src/com/watabou/pixeldungeon/items/rings/RingOfThorns.java
index 1d4046e..43bd431 100644
--- a/core/src/com/watabou/pixeldungeon/items/rings/RingOfThorns.java
+++ b/core/src/com/watabou/pixeldungeon/items/rings/RingOfThorns.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/InventoryScroll.java b/core/src/com/watabou/pixeldungeon/items/scrolls/InventoryScroll.java
index d4dc4ba..340a762 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/InventoryScroll.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/InventoryScroll.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/Scroll.java b/core/src/com/watabou/pixeldungeon/items/scrolls/Scroll.java
index c28aef8..711dac2 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/Scroll.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/Scroll.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfChallenge.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfChallenge.java
index ff5445e..b15446e 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfChallenge.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfChallenge.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfIdentify.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfIdentify.java
index 46641b2..b4c8929 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfIdentify.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfIdentify.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfLullaby.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfLullaby.java
index 477f310..439fd4d 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfLullaby.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfLullaby.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMagicMapping.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMagicMapping.java
index ea5bb5c..5401396 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMagicMapping.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMagicMapping.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMirrorImage.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMirrorImage.java
index 070d7ab..7048b5a 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMirrorImage.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfMirrorImage.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfPsionicBlast.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfPsionicBlast.java
index 324dc56..82c50cd 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfPsionicBlast.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfPsionicBlast.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRecharging.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRecharging.java
index 5de40ed..c20ca6e 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRecharging.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRecharging.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRemoveCurse.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRemoveCurse.java
index 6ff4d12..93cdd93 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRemoveCurse.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfRemoveCurse.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTeleportation.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTeleportation.java
index f1d2ce5..a0e7df6 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTeleportation.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTeleportation.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTerror.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTerror.java
index c982e72..71c1b78 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTerror.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfTerror.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfUpgrade.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfUpgrade.java
index 652f985..ae6bf80 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfUpgrade.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfUpgrade.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfWeaponUpgrade.java b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfWeaponUpgrade.java
index cb818e6..2666c1f 100644
--- a/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfWeaponUpgrade.java
+++ b/core/src/com/watabou/pixeldungeon/items/scrolls/ScrollOfWeaponUpgrade.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/Wand.java b/core/src/com/watabou/pixeldungeon/items/wands/Wand.java
index 390f04b..c31dd69 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/Wand.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/Wand.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfAmok.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfAmok.java
index 907f592..5e9eb99 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfAmok.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfAmok.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfAvalanche.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfAvalanche.java
index 525b469..45f98d5 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfAvalanche.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfAvalanche.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfBlink.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfBlink.java
index 9285bf9..1389f81 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfBlink.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfBlink.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfDisintegration.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfDisintegration.java
index 7f5ea52..de315f3 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfDisintegration.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfDisintegration.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfFirebolt.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfFirebolt.java
index 8169523..f6b1841 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfFirebolt.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfFirebolt.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfFlock.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfFlock.java
index 926c3ca..50fbbda 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfFlock.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfFlock.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfLightning.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfLightning.java
index 997cadf..5b32ecd 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfLightning.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfLightning.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfMagicMissile.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfMagicMissile.java
index 098804a..0858ce4 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfMagicMissile.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfMagicMissile.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfPoison.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfPoison.java
index 2444971..333f794 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfPoison.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfPoison.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfRegrowth.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfRegrowth.java
index bffab45..cedf5ab 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfRegrowth.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfRegrowth.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfSlowness.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfSlowness.java
index 5b0ad96..80f1104 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfSlowness.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfSlowness.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfTelekinesis.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfTelekinesis.java
index 0c0d5a4..84a299d 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfTelekinesis.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfTelekinesis.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/wands/WandOfTeleportation.java b/core/src/com/watabou/pixeldungeon/items/wands/WandOfTeleportation.java
index 5b2a8d3..889d637 100644
--- a/core/src/com/watabou/pixeldungeon/items/wands/WandOfTeleportation.java
+++ b/core/src/com/watabou/pixeldungeon/items/wands/WandOfTeleportation.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/Weapon.java b/core/src/com/watabou/pixeldungeon/items/weapon/Weapon.java
index 1fa8c37..b2d5f61 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/Weapon.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/Weapon.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Death.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Death.java
index 46058ac..4aad905 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Death.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Death.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Fire.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Fire.java
index e879705..2418420 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Fire.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Fire.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Horror.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Horror.java
index 258caab..db202c9 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Horror.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Horror.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Instability.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Instability.java
index 2bbbc4d..f728b44 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Instability.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Instability.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Leech.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Leech.java
index 4b4a65b..9fca84d 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Leech.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Leech.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Luck.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Luck.java
index 814cde0..0d7e265 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Luck.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Luck.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Paralysis.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Paralysis.java
index c79b348..5223a96 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Paralysis.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Paralysis.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Piercing.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Piercing.java
index 5feb4e6..674ded3 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Piercing.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Piercing.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Poison.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Poison.java
index d66f121..6d2bb58 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Poison.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Poison.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Slow.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Slow.java
index c9e7245..b34fefd 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Slow.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Slow.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Swing.java b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Swing.java
index d6772d7..3719c09 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Swing.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/enchantments/Swing.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/BattleAxe.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/BattleAxe.java
index 7a5b081..e658df7 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/BattleAxe.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/BattleAxe.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Dagger.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Dagger.java
index 54cec7b..baab2fd 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Dagger.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Dagger.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Glaive.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Glaive.java
index 53d77f6..965855c 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Glaive.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Glaive.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Knuckles.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Knuckles.java
index aa9d3b3..5f0cdf3 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Knuckles.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Knuckles.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Longsword.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Longsword.java
index ef4047a..9ea2945 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Longsword.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Longsword.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Mace.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Mace.java
index e7d190b..4e4d987 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Mace.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Mace.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/MeleeWeapon.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/MeleeWeapon.java
index e2dbc41..af49f61 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/MeleeWeapon.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/MeleeWeapon.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Quarterstaff.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Quarterstaff.java
index 54016d2..98dc763 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Quarterstaff.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Quarterstaff.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/ShortSword.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/ShortSword.java
index 7c777c8..1531b32 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/ShortSword.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/ShortSword.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Spear.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Spear.java
index cfccc5d..0a9e711 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Spear.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Spear.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Sword.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Sword.java
index 869eb3f..14b015f 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/Sword.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/Sword.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/melee/WarHammer.java b/core/src/com/watabou/pixeldungeon/items/weapon/melee/WarHammer.java
index e370faa..3a8a325 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/melee/WarHammer.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/melee/WarHammer.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Boomerang.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Boomerang.java
index 6bb3aee..0f103e9 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Boomerang.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Boomerang.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/CurareDart.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/CurareDart.java
index 6c0ec70..409be7d 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/CurareDart.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/CurareDart.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Dart.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Dart.java
index 3b8fce8..bebc579 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Dart.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Dart.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/IncendiaryDart.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/IncendiaryDart.java
index aef2575..d8bbc88 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/IncendiaryDart.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/IncendiaryDart.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Javelin.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Javelin.java
index a8a9321..6fb7cc7 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Javelin.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Javelin.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/MissileWeapon.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/MissileWeapon.java
index 5d8767d..5bbf02b 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/MissileWeapon.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/MissileWeapon.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Shuriken.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Shuriken.java
index c301b52..a5f37a7 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Shuriken.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Shuriken.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Tamahawk.java b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Tamahawk.java
index ea24ff7..baa9cd1 100644
--- a/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Tamahawk.java
+++ b/core/src/com/watabou/pixeldungeon/items/weapon/missiles/Tamahawk.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/CavesBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/CavesBossLevel.java
index ff52496..5142b9c 100644
--- a/core/src/com/watabou/pixeldungeon/levels/CavesBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/CavesBossLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/CavesLevel.java b/core/src/com/watabou/pixeldungeon/levels/CavesLevel.java
index 080b35a..0a17449 100644
--- a/core/src/com/watabou/pixeldungeon/levels/CavesLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/CavesLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/CityBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/CityBossLevel.java
index 9e911ec..03c114c 100644
--- a/core/src/com/watabou/pixeldungeon/levels/CityBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/CityBossLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/CityLevel.java b/core/src/com/watabou/pixeldungeon/levels/CityLevel.java
index 50802d1..38778a4 100644
--- a/core/src/com/watabou/pixeldungeon/levels/CityLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/CityLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/DeadEndLevel.java b/core/src/com/watabou/pixeldungeon/levels/DeadEndLevel.java
index 41d1398..5d87f4b 100644
--- a/core/src/com/watabou/pixeldungeon/levels/DeadEndLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/DeadEndLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/HallsBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/HallsBossLevel.java
index 30cba8a..0345ae9 100644
--- a/core/src/com/watabou/pixeldungeon/levels/HallsBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/HallsBossLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/HallsLevel.java b/core/src/com/watabou/pixeldungeon/levels/HallsLevel.java
index c0419ac..d7db473 100644
--- a/core/src/com/watabou/pixeldungeon/levels/HallsLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/HallsLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/LastLevel.java b/core/src/com/watabou/pixeldungeon/levels/LastLevel.java
index 0709233..f39f1d9 100644
--- a/core/src/com/watabou/pixeldungeon/levels/LastLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/LastLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/LastShopLevel.java b/core/src/com/watabou/pixeldungeon/levels/LastShopLevel.java
index 7448807..981cbc1 100644
--- a/core/src/com/watabou/pixeldungeon/levels/LastShopLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/LastShopLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/Level.java b/core/src/com/watabou/pixeldungeon/levels/Level.java
index 59f2ff0..9f282bc 100644
--- a/core/src/com/watabou/pixeldungeon/levels/Level.java
+++ b/core/src/com/watabou/pixeldungeon/levels/Level.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/Patch.java b/core/src/com/watabou/pixeldungeon/levels/Patch.java
index 0589da2..85563a8 100644
--- a/core/src/com/watabou/pixeldungeon/levels/Patch.java
+++ b/core/src/com/watabou/pixeldungeon/levels/Patch.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/PrisonBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/PrisonBossLevel.java
index 52e222b..dc97bc1 100644
--- a/core/src/com/watabou/pixeldungeon/levels/PrisonBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/PrisonBossLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/PrisonLevel.java b/core/src/com/watabou/pixeldungeon/levels/PrisonLevel.java
index 598dae2..92773a7 100644
--- a/core/src/com/watabou/pixeldungeon/levels/PrisonLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/PrisonLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java b/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java
index 50c4401..8f2014f 100644
--- a/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/RegularLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/Room.java b/core/src/com/watabou/pixeldungeon/levels/Room.java
index cae9412..b4ff9f4 100644
--- a/core/src/com/watabou/pixeldungeon/levels/Room.java
+++ b/core/src/com/watabou/pixeldungeon/levels/Room.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/SewerBossLevel.java b/core/src/com/watabou/pixeldungeon/levels/SewerBossLevel.java
index dd8adea..a8f5a65 100644
--- a/core/src/com/watabou/pixeldungeon/levels/SewerBossLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/SewerBossLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/SewerLevel.java b/core/src/com/watabou/pixeldungeon/levels/SewerLevel.java
index bc7af42..e538eff 100644
--- a/core/src/com/watabou/pixeldungeon/levels/SewerLevel.java
+++ b/core/src/com/watabou/pixeldungeon/levels/SewerLevel.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/Terrain.java b/core/src/com/watabou/pixeldungeon/levels/Terrain.java
index 05965e2..c21302b 100644
--- a/core/src/com/watabou/pixeldungeon/levels/Terrain.java
+++ b/core/src/com/watabou/pixeldungeon/levels/Terrain.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/features/AlchemyPot.java b/core/src/com/watabou/pixeldungeon/levels/features/AlchemyPot.java
index c7144fb..2d4fee8 100644
--- a/core/src/com/watabou/pixeldungeon/levels/features/AlchemyPot.java
+++ b/core/src/com/watabou/pixeldungeon/levels/features/AlchemyPot.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/features/Chasm.java b/core/src/com/watabou/pixeldungeon/levels/features/Chasm.java
index 0ec36c8..57b892b 100644
--- a/core/src/com/watabou/pixeldungeon/levels/features/Chasm.java
+++ b/core/src/com/watabou/pixeldungeon/levels/features/Chasm.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/features/Door.java b/core/src/com/watabou/pixeldungeon/levels/features/Door.java
index 1b0ac15..2990491 100644
--- a/core/src/com/watabou/pixeldungeon/levels/features/Door.java
+++ b/core/src/com/watabou/pixeldungeon/levels/features/Door.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/features/HighGrass.java b/core/src/com/watabou/pixeldungeon/levels/features/HighGrass.java
index fcd66da..9a58495 100644
--- a/core/src/com/watabou/pixeldungeon/levels/features/HighGrass.java
+++ b/core/src/com/watabou/pixeldungeon/levels/features/HighGrass.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/ArmoryPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/ArmoryPainter.java
index 32cab68..4cad6ac 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/ArmoryPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/ArmoryPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/BlacksmithPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/BlacksmithPainter.java
index 1ad1bda..ac98fc7 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/BlacksmithPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/BlacksmithPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/BossExitPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/BossExitPainter.java
index 637dcfb..e2fa8be 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/BossExitPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/BossExitPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/CryptPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/CryptPainter.java
index 9627dad..c12102c 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/CryptPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/CryptPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/EntrancePainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/EntrancePainter.java
index c9bdde9..8f89496 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/EntrancePainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/EntrancePainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/ExitPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/ExitPainter.java
index 80d8ea5..ca9a96e 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/ExitPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/ExitPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/GardenPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/GardenPainter.java
index 4096409..3189ed9 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/GardenPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/GardenPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/LaboratoryPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/LaboratoryPainter.java
index a447033..9a70b4c 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/LaboratoryPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/LaboratoryPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/LibraryPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/LibraryPainter.java
index 0ca027f..f14be56 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/LibraryPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/LibraryPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/MagicWellPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/MagicWellPainter.java
index d760261..a5ab94f 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/MagicWellPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/MagicWellPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/Painter.java b/core/src/com/watabou/pixeldungeon/levels/painters/Painter.java
index aa14474..cef7487 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/Painter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/Painter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/PassagePainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/PassagePainter.java
index 91be67d..5c3627f 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/PassagePainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/PassagePainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/PitPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/PitPainter.java
index b9f6459..5dc60e6 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/PitPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/PitPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/PoolPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/PoolPainter.java
index 0606cec..92a117d 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/PoolPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/PoolPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/RatKingPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/RatKingPainter.java
index 26efc49..3af1d78 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/RatKingPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/RatKingPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/ShopPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/ShopPainter.java
index f2f8747..59b92f4 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/ShopPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/ShopPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/StandardPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/StandardPainter.java
index 34b4b35..e941a07 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/StandardPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/StandardPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/StatuePainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/StatuePainter.java
index 47c9f95..b90c7a6 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/StatuePainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/StatuePainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/StoragePainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/StoragePainter.java
index 2da6869..c9e32d1 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/StoragePainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/StoragePainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/TrapsPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/TrapsPainter.java
index bf99885..45ba75f 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/TrapsPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/TrapsPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/TreasuryPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/TreasuryPainter.java
index c9fcd1f..4d27444 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/TreasuryPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/TreasuryPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/TunnelPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/TunnelPainter.java
index 4270b10..2544f77 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/TunnelPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/TunnelPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/VaultPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/VaultPainter.java
index 13534bd..de7f57e 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/VaultPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/VaultPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/painters/WeakFloorPainter.java b/core/src/com/watabou/pixeldungeon/levels/painters/WeakFloorPainter.java
index 1ba9269..5da8bd3 100644
--- a/core/src/com/watabou/pixeldungeon/levels/painters/WeakFloorPainter.java
+++ b/core/src/com/watabou/pixeldungeon/levels/painters/WeakFloorPainter.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/AlarmTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/AlarmTrap.java
index c21995b..7eeca71 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/AlarmTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/AlarmTrap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/FireTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/FireTrap.java
index 8bc6d19..64d638d 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/FireTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/FireTrap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/GrippingTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/GrippingTrap.java
index 4a03122..7e5878e 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/GrippingTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/GrippingTrap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/LightningTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/LightningTrap.java
index 1051e7b..d1b16a5 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/LightningTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/LightningTrap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/ParalyticTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/ParalyticTrap.java
index 0030e61..a858fef 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/ParalyticTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/ParalyticTrap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/PoisonTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/PoisonTrap.java
index d2fefc9..84fd46e 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/PoisonTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/PoisonTrap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/SummoningTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/SummoningTrap.java
index 6822f2f..8f74085 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/SummoningTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/SummoningTrap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/levels/traps/ToxicTrap.java b/core/src/com/watabou/pixeldungeon/levels/traps/ToxicTrap.java
index 8600c71..61957c5 100644
--- a/core/src/com/watabou/pixeldungeon/levels/traps/ToxicTrap.java
+++ b/core/src/com/watabou/pixeldungeon/levels/traps/ToxicTrap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/mechanics/Ballistica.java b/core/src/com/watabou/pixeldungeon/mechanics/Ballistica.java
index bb71821..56d5fcd 100644
--- a/core/src/com/watabou/pixeldungeon/mechanics/Ballistica.java
+++ b/core/src/com/watabou/pixeldungeon/mechanics/Ballistica.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/mechanics/ShadowCaster.java b/core/src/com/watabou/pixeldungeon/mechanics/ShadowCaster.java
index 9629ba3..696bd7a 100644
--- a/core/src/com/watabou/pixeldungeon/mechanics/ShadowCaster.java
+++ b/core/src/com/watabou/pixeldungeon/mechanics/ShadowCaster.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Blindweed.java b/core/src/com/watabou/pixeldungeon/plants/Blindweed.java
deleted file mode 100644
index 0e3f806..0000000
--- a/core/src/com/watabou/pixeldungeon/plants/Blindweed.java
+++ /dev/null
@@ -1,80 +0,0 @@
-/*
- * Pixel Dungeon
- * Copyright (C) 2012-2014  Oleg Dolya
- *
- * This program is free software: you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation, either version 3 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program.  If not, see <http://www.gnu.org/licenses/>
- */
-package com.watabou.pixeldungeon.plants;
-
-import com.watabou.pixeldungeon.Dungeon;
-import com.watabou.pixeldungeon.actors.Char;
-import com.watabou.pixeldungeon.actors.buffs.Blindness;
-import com.watabou.pixeldungeon.actors.buffs.Buff;
-import com.watabou.pixeldungeon.actors.mobs.Mob;
-import com.watabou.pixeldungeon.actors.mobs.Mob.State;
-import com.watabou.pixeldungeon.effects.CellEmitter;
-import com.watabou.pixeldungeon.effects.Speck;
-import com.watabou.pixeldungeon.items.potions.PotionOfInvisibility;
-import com.watabou.pixeldungeon.sprites.ItemSpriteSheet;
-import com.watabou.utils.Random;
-
-public class Blindweed extends Plant {
-
-	private static final String TXT_DESC = 
-		"Upon touching a Blindweed it perishes in a blinding flash of light.";
-	
-	{
-		image = 3;
-		plantName = "Blindweed";
-	}
-	
-	@Override
-	public void activate( Char ch ) {
-		super.activate( ch );
-		
-		if (ch != null) {
-			Buff.prolong( ch, Blindness.class, Random.Int( 5, 10 ) );
-			if (ch instanceof Mob) {
-				((Mob)ch).state = State.WANDERING;
-				((Mob)ch).beckon( Dungeon.level.randomDestination() );
-			}
-		}
-		
-		if (Dungeon.visible[pos]) {
-			CellEmitter.get( pos ).burst( Speck.factory( Speck.LIGHT ), 4 );
-		}
-	}
-	
-	@Override
-	public String desc() {
-		return TXT_DESC;
-	}
-	
-	public static class Seed extends Plant.Seed {
-		{
-			plantName = "Blindweed";
-			
-			name = "seed of " + plantName;
-			image = ItemSpriteSheet.SEED_BLINDWEED;
-			
-			plantClass = Blindweed.class;
-			alchemyClass = PotionOfInvisibility.class;
-		}
-		
-		@Override
-		public String desc() {
-			return TXT_DESC;
-		}
-	}
-}
diff --git a/core/src/com/watabou/pixeldungeon/plants/Dreamweed.java b/core/src/com/watabou/pixeldungeon/plants/Dreamweed.java
index 2b20b8c..a0935f9 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Dreamweed.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Dreamweed.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Earthroot.java b/core/src/com/watabou/pixeldungeon/plants/Earthroot.java
index e57b144..400614e 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Earthroot.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Earthroot.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Fadeleaf.java b/core/src/com/watabou/pixeldungeon/plants/Fadeleaf.java
index 4baa06b..fda8c78 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Fadeleaf.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Fadeleaf.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Firebloom.java b/core/src/com/watabou/pixeldungeon/plants/Firebloom.java
index c003f7d..8b5e9a1 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Firebloom.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Firebloom.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Icecap.java b/core/src/com/watabou/pixeldungeon/plants/Icecap.java
index dd48070..6bb1c25 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Icecap.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Icecap.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Plant.java b/core/src/com/watabou/pixeldungeon/plants/Plant.java
index c705db5..5772c88 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Plant.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Plant.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Sorrowmoss.java b/core/src/com/watabou/pixeldungeon/plants/Sorrowmoss.java
index 9360b00..b5a8b7c 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Sorrowmoss.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Sorrowmoss.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/plants/Sungrass.java b/core/src/com/watabou/pixeldungeon/plants/Sungrass.java
index 2d6ea82..c1a1e82 100644
--- a/core/src/com/watabou/pixeldungeon/plants/Sungrass.java
+++ b/core/src/com/watabou/pixeldungeon/plants/Sungrass.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java b/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java
index a9de8b1..2d20bc7 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/AboutScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/AmuletScene.java b/core/src/com/watabou/pixeldungeon/scenes/AmuletScene.java
index cc8e265..c7f9ed8 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/AmuletScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/AmuletScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/BadgesScene.java b/core/src/com/watabou/pixeldungeon/scenes/BadgesScene.java
index 2d33043..cd6ca4d 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/BadgesScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/BadgesScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/CellSelector.java b/core/src/com/watabou/pixeldungeon/scenes/CellSelector.java
index 6e1feac..6346616 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/CellSelector.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/CellSelector.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/GameScene.java b/core/src/com/watabou/pixeldungeon/scenes/GameScene.java
index 2a78970..8323425 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/GameScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/GameScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/InterlevelScene.java b/core/src/com/watabou/pixeldungeon/scenes/InterlevelScene.java
index bfbb914..e88d8e5 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/InterlevelScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/InterlevelScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/IntroScene.java b/core/src/com/watabou/pixeldungeon/scenes/IntroScene.java
index 6ab063d..a28d32e 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/IntroScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/IntroScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/PixelScene.java b/core/src/com/watabou/pixeldungeon/scenes/PixelScene.java
index 26fc9ef..04337cd 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/PixelScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/PixelScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java b/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java
index 3b48420..090cc8b 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/RankingsScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
index 5764f7c..d9342cb 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/SurfaceScene.java b/core/src/com/watabou/pixeldungeon/scenes/SurfaceScene.java
index 190e159..53933b2 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/SurfaceScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/SurfaceScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java b/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java
index c2f3636..4d89955 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/TitleScene.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/AcidicSprite.java b/core/src/com/watabou/pixeldungeon/sprites/AcidicSprite.java
index 49558e7..eeac79c 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/AcidicSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/AcidicSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/AlbinoSprite.java b/core/src/com/watabou/pixeldungeon/sprites/AlbinoSprite.java
index ba405d8..473dcec 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/AlbinoSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/AlbinoSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BanditSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BanditSprite.java
index b6ac238..a4d8cc6 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BanditSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BanditSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BatSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BatSprite.java
index e3aef16..050e139 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BatSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BatSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BlacksmithSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BlacksmithSprite.java
index b6f485f..fb8e6be 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BlacksmithSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BlacksmithSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BruteSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BruteSprite.java
index 17947d4..90ccc92 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BruteSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BruteSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/BurningFistSprite.java b/core/src/com/watabou/pixeldungeon/sprites/BurningFistSprite.java
index c636d51..ae56f1d 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/BurningFistSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/BurningFistSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/CharSprite.java b/core/src/com/watabou/pixeldungeon/sprites/CharSprite.java
index 74b5a12..e09d263 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/CharSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/CharSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/CrabSprite.java b/core/src/com/watabou/pixeldungeon/sprites/CrabSprite.java
index dc12ea3..f06c2f5 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/CrabSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/CrabSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/DM300Sprite.java b/core/src/com/watabou/pixeldungeon/sprites/DM300Sprite.java
index 7e464fa..29527ef 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/DM300Sprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/DM300Sprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/DiscardedItemSprite.java b/core/src/com/watabou/pixeldungeon/sprites/DiscardedItemSprite.java
index 20ebaee..1f14ba9 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/DiscardedItemSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/DiscardedItemSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ElementalSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ElementalSprite.java
index c002bdb..a74a358 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ElementalSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ElementalSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/EyeSprite.java b/core/src/com/watabou/pixeldungeon/sprites/EyeSprite.java
index 3fde2dd..f56bd60 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/EyeSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/EyeSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/FetidRatSprite.java b/core/src/com/watabou/pixeldungeon/sprites/FetidRatSprite.java
index 5392aaf..3942f40 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/FetidRatSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/FetidRatSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/GhostSprite.java b/core/src/com/watabou/pixeldungeon/sprites/GhostSprite.java
index ee58ab7..340708f 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/GhostSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/GhostSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/GnollSprite.java b/core/src/com/watabou/pixeldungeon/sprites/GnollSprite.java
index 37812af..a4bc706 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/GnollSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/GnollSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/GolemSprite.java b/core/src/com/watabou/pixeldungeon/sprites/GolemSprite.java
index 08cefb0..7179e9d 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/GolemSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/GolemSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/GooSprite.java b/core/src/com/watabou/pixeldungeon/sprites/GooSprite.java
index e42eccf..ae730e8 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/GooSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/GooSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java b/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java
index 34e066d..85d0d5b 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/HeroSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ImpSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ImpSprite.java
index 7f2912d..abd6ede 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ImpSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ImpSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java
index a90df16..0acd80b 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ItemSpriteSheet.java b/core/src/com/watabou/pixeldungeon/sprites/ItemSpriteSheet.java
index 6897297..713966a 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ItemSpriteSheet.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ItemSpriteSheet.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/KingSprite.java b/core/src/com/watabou/pixeldungeon/sprites/KingSprite.java
index b067f2c..30b45ae 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/KingSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/KingSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/LarvaSprite.java b/core/src/com/watabou/pixeldungeon/sprites/LarvaSprite.java
index 2212ea4..bb11bd4 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/LarvaSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/LarvaSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/MirrorSprite.java b/core/src/com/watabou/pixeldungeon/sprites/MirrorSprite.java
index 047501b..0f9335a 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/MirrorSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/MirrorSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/MissileSprite.java b/core/src/com/watabou/pixeldungeon/sprites/MissileSprite.java
index c184163..cbd2710 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/MissileSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/MissileSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/MobSprite.java b/core/src/com/watabou/pixeldungeon/sprites/MobSprite.java
index 9301535..9445724 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/MobSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/MobSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/MonkSprite.java b/core/src/com/watabou/pixeldungeon/sprites/MonkSprite.java
index be75d80..6dedb1d 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/MonkSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/MonkSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/PiranhaSprite.java b/core/src/com/watabou/pixeldungeon/sprites/PiranhaSprite.java
index 3d55f61..77d1285 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/PiranhaSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/PiranhaSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/PlantSprite.java b/core/src/com/watabou/pixeldungeon/sprites/PlantSprite.java
index 9fdae8f..25517de 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/PlantSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/PlantSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/RatKingSprite.java b/core/src/com/watabou/pixeldungeon/sprites/RatKingSprite.java
index 12a9839..c0350bf 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/RatKingSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/RatKingSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/RatSprite.java b/core/src/com/watabou/pixeldungeon/sprites/RatSprite.java
index 735f148..5cf5494 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/RatSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/RatSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/RottingFistSprite.java b/core/src/com/watabou/pixeldungeon/sprites/RottingFistSprite.java
index 96d693d..76872c5 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/RottingFistSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/RottingFistSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ScorpioSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ScorpioSprite.java
index 4d10d5a..c730ca2 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ScorpioSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ScorpioSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SeniorSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SeniorSprite.java
index 759ead3..c32d2d4 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SeniorSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SeniorSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ShamanSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ShamanSprite.java
index 2f8d1bd..8aefaf3 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ShamanSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ShamanSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SheepSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SheepSprite.java
index e2ab3cd..bd733e9 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SheepSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SheepSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ShieldedSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ShieldedSprite.java
index 0958c0b..705232b 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ShieldedSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ShieldedSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ShopkeeperSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ShopkeeperSprite.java
index 8c85773..a7094e0 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ShopkeeperSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ShopkeeperSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SkeletonSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SkeletonSprite.java
index 590584d..4340d0d 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SkeletonSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SkeletonSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SpinnerSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SpinnerSprite.java
index 3f503e6..87f73c5 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SpinnerSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SpinnerSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/StatueSprite.java b/core/src/com/watabou/pixeldungeon/sprites/StatueSprite.java
index f7034f2..39be305 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/StatueSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/StatueSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SuccubusSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SuccubusSprite.java
index 04d11d1..95fd8cd 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SuccubusSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SuccubusSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/SwarmSprite.java b/core/src/com/watabou/pixeldungeon/sprites/SwarmSprite.java
index bae1938..d9a97ef 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/SwarmSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/SwarmSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/TenguSprite.java b/core/src/com/watabou/pixeldungeon/sprites/TenguSprite.java
index 5f2f0ca..be7580c 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/TenguSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/TenguSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ThiefSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ThiefSprite.java
index 33085f6..b1cb86f 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ThiefSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ThiefSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/UndeadSprite.java b/core/src/com/watabou/pixeldungeon/sprites/UndeadSprite.java
index 0db8e93..52c5d5d 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/UndeadSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/UndeadSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/WandmakerSprite.java b/core/src/com/watabou/pixeldungeon/sprites/WandmakerSprite.java
index f4156fd..a736878 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/WandmakerSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/WandmakerSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/WarlockSprite.java b/core/src/com/watabou/pixeldungeon/sprites/WarlockSprite.java
index d631e85..21c51ab 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/WarlockSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/WarlockSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/WraithSprite.java b/core/src/com/watabou/pixeldungeon/sprites/WraithSprite.java
index 78976ff..1364948 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/WraithSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/WraithSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/sprites/YogSprite.java b/core/src/com/watabou/pixeldungeon/sprites/YogSprite.java
index 68c54c5..848f324 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/YogSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/YogSprite.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Archs.java b/core/src/com/watabou/pixeldungeon/ui/Archs.java
index e3bfab9..5d0e0bf 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Archs.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Archs.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/AttackIndicator.java b/core/src/com/watabou/pixeldungeon/ui/AttackIndicator.java
index 1b42f44..240fbc3 100644
--- a/core/src/com/watabou/pixeldungeon/ui/AttackIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/AttackIndicator.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/BadgesList.java b/core/src/com/watabou/pixeldungeon/ui/BadgesList.java
index b8a887f..044f6d0 100644
--- a/core/src/com/watabou/pixeldungeon/ui/BadgesList.java
+++ b/core/src/com/watabou/pixeldungeon/ui/BadgesList.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Banner.java b/core/src/com/watabou/pixeldungeon/ui/Banner.java
index e38b580..2dcb59d 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Banner.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Banner.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/BuffIndicator.java b/core/src/com/watabou/pixeldungeon/ui/BuffIndicator.java
index 10067aa..28bca07 100644
--- a/core/src/com/watabou/pixeldungeon/ui/BuffIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/BuffIndicator.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/BusyIndicator.java b/core/src/com/watabou/pixeldungeon/ui/BusyIndicator.java
index c461154..3486aa0 100644
--- a/core/src/com/watabou/pixeldungeon/ui/BusyIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/BusyIndicator.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/CheckBox.java b/core/src/com/watabou/pixeldungeon/ui/CheckBox.java
index c65775c..e736891 100644
--- a/core/src/com/watabou/pixeldungeon/ui/CheckBox.java
+++ b/core/src/com/watabou/pixeldungeon/ui/CheckBox.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Compass.java b/core/src/com/watabou/pixeldungeon/ui/Compass.java
index 3f29c21..8bba032 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Compass.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Compass.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/DangerIndicator.java b/core/src/com/watabou/pixeldungeon/ui/DangerIndicator.java
index e7f7ac9..c8e997e 100644
--- a/core/src/com/watabou/pixeldungeon/ui/DangerIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/DangerIndicator.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/ExitButton.java b/core/src/com/watabou/pixeldungeon/ui/ExitButton.java
index 0346ae1..38abf45 100644
--- a/core/src/com/watabou/pixeldungeon/ui/ExitButton.java
+++ b/core/src/com/watabou/pixeldungeon/ui/ExitButton.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/GameLog.java b/core/src/com/watabou/pixeldungeon/ui/GameLog.java
index 52e3d2a..987016f 100644
--- a/core/src/com/watabou/pixeldungeon/ui/GameLog.java
+++ b/core/src/com/watabou/pixeldungeon/ui/GameLog.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/GoldIndicator.java b/core/src/com/watabou/pixeldungeon/ui/GoldIndicator.java
index 858102d..8586eb4 100644
--- a/core/src/com/watabou/pixeldungeon/ui/GoldIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/GoldIndicator.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/HealthIndicator.java b/core/src/com/watabou/pixeldungeon/ui/HealthIndicator.java
index 8df196f..6415569 100644
--- a/core/src/com/watabou/pixeldungeon/ui/HealthIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/HealthIndicator.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Icons.java b/core/src/com/watabou/pixeldungeon/ui/Icons.java
index 28741b6..40432fa 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Icons.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Icons.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/ItemSlot.java b/core/src/com/watabou/pixeldungeon/ui/ItemSlot.java
index cda1172..c75ccaa 100644
--- a/core/src/com/watabou/pixeldungeon/ui/ItemSlot.java
+++ b/core/src/com/watabou/pixeldungeon/ui/ItemSlot.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/LootIndicator.java b/core/src/com/watabou/pixeldungeon/ui/LootIndicator.java
index 734d862..dfaeee3 100644
--- a/core/src/com/watabou/pixeldungeon/ui/LootIndicator.java
+++ b/core/src/com/watabou/pixeldungeon/ui/LootIndicator.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/PrefsButton.java b/core/src/com/watabou/pixeldungeon/ui/PrefsButton.java
index dd0dafd..38548fd 100644
--- a/core/src/com/watabou/pixeldungeon/ui/PrefsButton.java
+++ b/core/src/com/watabou/pixeldungeon/ui/PrefsButton.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/QuickSlot.java b/core/src/com/watabou/pixeldungeon/ui/QuickSlot.java
index f7b5911..b084240 100644
--- a/core/src/com/watabou/pixeldungeon/ui/QuickSlot.java
+++ b/core/src/com/watabou/pixeldungeon/ui/QuickSlot.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/RedButton.java b/core/src/com/watabou/pixeldungeon/ui/RedButton.java
index ef9d980..5edc3b8 100644
--- a/core/src/com/watabou/pixeldungeon/ui/RedButton.java
+++ b/core/src/com/watabou/pixeldungeon/ui/RedButton.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/ScrollPane.java b/core/src/com/watabou/pixeldungeon/ui/ScrollPane.java
index 03549b4..31872d5 100644
--- a/core/src/com/watabou/pixeldungeon/ui/ScrollPane.java
+++ b/core/src/com/watabou/pixeldungeon/ui/ScrollPane.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/SimpleButton.java b/core/src/com/watabou/pixeldungeon/ui/SimpleButton.java
index 74df5da..ad20805 100644
--- a/core/src/com/watabou/pixeldungeon/ui/SimpleButton.java
+++ b/core/src/com/watabou/pixeldungeon/ui/SimpleButton.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/StatusPane.java b/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
index bcab28d..8ad234f 100644
--- a/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
+++ b/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Tag.java b/core/src/com/watabou/pixeldungeon/ui/Tag.java
index 8c7700d..33c46e7 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Tag.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Tag.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Toast.java b/core/src/com/watabou/pixeldungeon/ui/Toast.java
index 14abbb4..118b732 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Toast.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Toast.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Toolbar.java b/core/src/com/watabou/pixeldungeon/ui/Toolbar.java
index 72b0f55..a3672fd 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Toolbar.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Toolbar.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/ui/Window.java b/core/src/com/watabou/pixeldungeon/ui/Window.java
index f125d9e..7aed16a 100644
--- a/core/src/com/watabou/pixeldungeon/ui/Window.java
+++ b/core/src/com/watabou/pixeldungeon/ui/Window.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/utils/BArray.java b/core/src/com/watabou/pixeldungeon/utils/BArray.java
index b513b66..c109f09 100644
--- a/core/src/com/watabou/pixeldungeon/utils/BArray.java
+++ b/core/src/com/watabou/pixeldungeon/utils/BArray.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/utils/GLog.java b/core/src/com/watabou/pixeldungeon/utils/GLog.java
index 6a0f04a..f854d41 100644
--- a/core/src/com/watabou/pixeldungeon/utils/GLog.java
+++ b/core/src/com/watabou/pixeldungeon/utils/GLog.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/utils/Utils.java b/core/src/com/watabou/pixeldungeon/utils/Utils.java
index 6bdb978..4cff2ab 100644
--- a/core/src/com/watabou/pixeldungeon/utils/Utils.java
+++ b/core/src/com/watabou/pixeldungeon/utils/Utils.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/IconTitle.java b/core/src/com/watabou/pixeldungeon/windows/IconTitle.java
index 56996ba..1d852aa 100644
--- a/core/src/com/watabou/pixeldungeon/windows/IconTitle.java
+++ b/core/src/com/watabou/pixeldungeon/windows/IconTitle.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndBadge.java b/core/src/com/watabou/pixeldungeon/windows/WndBadge.java
index 837d013..b0cd1e0 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndBadge.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndBadge.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndBag.java b/core/src/com/watabou/pixeldungeon/windows/WndBag.java
index d7520af..c218aa3 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndBag.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndBag.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndBlacksmith.java b/core/src/com/watabou/pixeldungeon/windows/WndBlacksmith.java
index 4df3da5..49069ce 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndBlacksmith.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndBlacksmith.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndCatalogus.java b/core/src/com/watabou/pixeldungeon/windows/WndCatalogus.java
index 76b608c..b7a8f7c 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndCatalogus.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndCatalogus.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndChallenges.java b/core/src/com/watabou/pixeldungeon/windows/WndChallenges.java
index 4e8f56a..444077b 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndChallenges.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndChallenges.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndChooseWay.java b/core/src/com/watabou/pixeldungeon/windows/WndChooseWay.java
index 937bf50..c6daf2c 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndChooseWay.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndChooseWay.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndClass.java b/core/src/com/watabou/pixeldungeon/windows/WndClass.java
index 0388b2d..b7a843f 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndClass.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndClass.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndError.java b/core/src/com/watabou/pixeldungeon/windows/WndError.java
index 8633455..099f86e 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndError.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndError.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndGame.java b/core/src/com/watabou/pixeldungeon/windows/WndGame.java
index 270bc5c..bd16731 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndGame.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndGame.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndHero.java b/core/src/com/watabou/pixeldungeon/windows/WndHero.java
index 834db06..d32cc39 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndHero.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndHero.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndImp.java b/core/src/com/watabou/pixeldungeon/windows/WndImp.java
index c9855e5..8f51447 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndImp.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndImp.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndInfoCell.java b/core/src/com/watabou/pixeldungeon/windows/WndInfoCell.java
index 299000a..4220c0f 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndInfoCell.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndInfoCell.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndInfoItem.java b/core/src/com/watabou/pixeldungeon/windows/WndInfoItem.java
index 814deb6..8188d33 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndInfoItem.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndInfoItem.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndInfoMob.java b/core/src/com/watabou/pixeldungeon/windows/WndInfoMob.java
index 47057bc..6f3b3b7 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndInfoMob.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndInfoMob.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndInfoPlant.java b/core/src/com/watabou/pixeldungeon/windows/WndInfoPlant.java
index e7bb85a..f749828 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndInfoPlant.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndInfoPlant.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndItem.java b/core/src/com/watabou/pixeldungeon/windows/WndItem.java
index 98e3f60..66326a2 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndItem.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndItem.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndJournal.java b/core/src/com/watabou/pixeldungeon/windows/WndJournal.java
index 203be12..3439134 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndJournal.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndJournal.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndMessage.java b/core/src/com/watabou/pixeldungeon/windows/WndMessage.java
index 9e1aafd..3d8833e 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndMessage.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndMessage.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndOptions.java b/core/src/com/watabou/pixeldungeon/windows/WndOptions.java
index 73836cc..db236db 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndOptions.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndOptions.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndQuest.java b/core/src/com/watabou/pixeldungeon/windows/WndQuest.java
index b31378f..293e681 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndQuest.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndQuest.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndRanking.java b/core/src/com/watabou/pixeldungeon/windows/WndRanking.java
index 5ead9c9..7ad87e8 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndRanking.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndRanking.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndResurrect.java b/core/src/com/watabou/pixeldungeon/windows/WndResurrect.java
index f4d3dac..8a8ce7f 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndResurrect.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndResurrect.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndSadGhost.java b/core/src/com/watabou/pixeldungeon/windows/WndSadGhost.java
index d598e74..35287fe 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndSadGhost.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndSadGhost.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndSettings.java b/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
index 478a191..467ec36 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndStory.java b/core/src/com/watabou/pixeldungeon/windows/WndStory.java
index 2e0e0ac..f302e15 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndStory.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndStory.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndTabbed.java b/core/src/com/watabou/pixeldungeon/windows/WndTabbed.java
index 7386202..7cfa544 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndTabbed.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndTabbed.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndTitledMessage.java b/core/src/com/watabou/pixeldungeon/windows/WndTitledMessage.java
index 8f29fd5..7e94cef 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndTitledMessage.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndTitledMessage.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndTradeItem.java b/core/src/com/watabou/pixeldungeon/windows/WndTradeItem.java
index f100211..e485597 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndTradeItem.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndTradeItem.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndWandmaker.java b/core/src/com/watabou/pixeldungeon/windows/WndWandmaker.java
index 41630f5..50e808f 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndWandmaker.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndWandmaker.java
@@ -1,4 +1,5 @@
 /*
+ * Pixel Dungeon
  * Copyright (C) 2012-2014  Oleg Dolya
  *
  * This program is free software: you can redistribute it and/or modify
-- 
2.1.2


From b6e43bca8fb3e13f7dbb9cb980cfcbc38bbc3014 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 06:20:29 -0400
Subject: [PATCH 04/13] Merged the update correcting the typos

---
 core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java | 4 ++--
 core/src/com/watabou/pixeldungeon/actors/hero/Hero.java       | 2 --
 core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java        | 1 -
 core/src/com/watabou/pixeldungeon/items/keys/IronKey.java     | 2 +-
 core/src/com/watabou/pixeldungeon/ui/StatusPane.java          | 2 +-
 5 files changed, 4 insertions(+), 7 deletions(-)

diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java b/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java
index 45ab3cb..0f87d74 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/Belongings.java
@@ -120,11 +120,11 @@ public class Belongings implements Iterable<Item> {
 	
 	public void countIronKeys() {
 		
-		IronKey.curDethQuantity = 0;
+		IronKey.curDepthQuantity = 0;
 		
 		for (Item item : backpack) {
 			if (item instanceof IronKey && ((IronKey)item).depth == Dungeon.depth) {
-				IronKey.curDethQuantity++;
+				IronKey.curDepthQuantity++;
 			}
 		}
 	}
diff --git a/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java b/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java
index 18d7235..f51a8ef 100644
--- a/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java
+++ b/core/src/com/watabou/pixeldungeon/actors/hero/Hero.java
@@ -152,7 +152,6 @@ public class Hero extends Char {
 	public int STR;
 	public boolean weakened = false;
 	
-	/**  , */
 	public float awareness;
 	
 	public int lvl = 1;
@@ -1157,7 +1156,6 @@ public class Hero extends Char {
 	
 	public static void reallyDie( Object cause ) {
 		
-		//   
 		int length = Level.LENGTH;
 		int[] map = Dungeon.level.map;
 		boolean[] visited = Dungeon.level.visited;
diff --git a/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java b/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java
index 1b8fe37..79c2498 100644
--- a/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java
+++ b/core/src/com/watabou/pixeldungeon/actors/mobs/Eye.java
@@ -71,7 +71,6 @@ public class Eye extends Mob {
 		
 		hitCell = Ballistica.cast( pos, enemy.pos, true, false );
 		
-		//   1 ,   0- -   
 		for (int i=1; i < Ballistica.distance; i++) {
 			if (Ballistica.trace[i] == enemy.pos) {
 				return true;
diff --git a/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java b/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java
index 7e0ff93..a04d8a8 100644
--- a/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java
+++ b/core/src/com/watabou/pixeldungeon/items/keys/IronKey.java
@@ -26,7 +26,7 @@ public class IronKey extends Key {
 
 	private static final String TXT_FROM_DEPTH = "iron key from depth %d";
 
-	public static int curDethQuantity = 0;
+	public static int curDepthQuantity = 0;
 	
 	{
 		name = "iron key";
diff --git a/core/src/com/watabou/pixeldungeon/ui/StatusPane.java b/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
index 8ad234f..60f2381 100644
--- a/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
+++ b/core/src/com/watabou/pixeldungeon/ui/StatusPane.java
@@ -215,7 +215,7 @@ public class StatusPane extends Component {
 			level.y = PixelScene.align( 27.5f - level.baseLine() / 2 );
 		}
 		
-		int k = IronKey.curDethQuantity;
+		int k = IronKey.curDepthQuantity;
 		if (k != lastKeys) {
 			lastKeys = k;
 			keys.text( Integer.toString( lastKeys ) );
-- 
2.1.2


From a98e5247a3914b3aff44fe516561b111b42975d0 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 06:21:28 -0400
Subject: [PATCH 05/13] Updated the version string to 1.7.2a

---
 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/build.gradle b/build.gradle
index 7e2d737..13a61b0 100644
--- a/build.gradle
+++ b/build.gradle
@@ -15,7 +15,7 @@ allprojects {
     apply plugin: "eclipse"
     apply plugin: "idea"
 
-    version = '1.7.1c-1'
+    version = '1.7.2a-1'
     ext {
         versionCode = 59
         appName = 'pixel-dungeon'
-- 
2.1.2


From 7116e8e938e8c56727c487727483cf35859381a5 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 06:31:25 -0400
Subject: [PATCH 06/13] The PD-classes update up until things stop merging
 nicely

---
 PD-classes/src/com/watabou/glwrap/Quad.java        |  2 +-
 PD-classes/src/com/watabou/noosa/BitmapText.java   |  7 ++++-
 .../src/com/watabou/noosa/BitmapTextMultiline.java |  2 ++
 PD-classes/src/com/watabou/noosa/Camera.java       | 15 ++++++----
 PD-classes/src/com/watabou/noosa/ColorBlock.java   |  1 +
 PD-classes/src/com/watabou/noosa/Game.java         |  3 +-
 PD-classes/src/com/watabou/noosa/Gizmo.java        |  1 +
 PD-classes/src/com/watabou/noosa/Group.java        | 10 +++----
 PD-classes/src/com/watabou/noosa/Image.java        |  1 +
 PD-classes/src/com/watabou/noosa/MovieClip.java    |  1 +
 PD-classes/src/com/watabou/noosa/NinePatch.java    |  1 +
 PD-classes/src/com/watabou/noosa/NoosaScript.java  |  1 +
 PD-classes/src/com/watabou/noosa/PseudoPixel.java  |  1 +
 PD-classes/src/com/watabou/noosa/Resizable.java    |  1 +
 PD-classes/src/com/watabou/noosa/Scene.java        |  1 +
 PD-classes/src/com/watabou/noosa/SkinnedBlock.java |  9 ++++++
 PD-classes/src/com/watabou/noosa/TextureFilm.java  |  1 +
 PD-classes/src/com/watabou/noosa/Tilemap.java      |  1 +
 PD-classes/src/com/watabou/noosa/TouchArea.java    |  5 ++--
 PD-classes/src/com/watabou/noosa/Visual.java       |  1 +
 PD-classes/src/com/watabou/noosa/audio/Music.java  |  1 +
 PD-classes/src/com/watabou/noosa/audio/Sample.java |  1 +
 .../src/com/watabou/noosa/particles/Emitter.java   |  7 +++--
 .../com/watabou/noosa/particles/PixelParticle.java |  1 +
 .../com/watabou/noosa/tweeners/AlphaTweener.java   |  1 +
 .../noosa/tweeners/CameraScrollTweener.java        |  1 +
 .../src/com/watabou/noosa/tweeners/Delayer.java    |  1 +
 .../src/com/watabou/noosa/tweeners/PosTweener.java |  1 +
 .../com/watabou/noosa/tweeners/ScaleTweener.java   |  1 +
 .../src/com/watabou/noosa/tweeners/Tweener.java    |  1 +
 PD-classes/src/com/watabou/noosa/ui/Button.java    |  1 +
 PD-classes/src/com/watabou/noosa/ui/CheckBox.java  |  1 +
 PD-classes/src/com/watabou/noosa/ui/Component.java |  1 +
 PD-classes/src/com/watabou/utils/Bundle.java       | 34 +++++++++++++++++++++-
 34 files changed, 98 insertions(+), 20 deletions(-)

diff --git a/PD-classes/src/com/watabou/glwrap/Quad.java b/PD-classes/src/com/watabou/glwrap/Quad.java
index 9f35f0b..d7046b6 100644
--- a/PD-classes/src/com/watabou/glwrap/Quad.java
+++ b/PD-classes/src/com/watabou/glwrap/Quad.java
@@ -59,7 +59,7 @@ public class Quad {
 		ShortBuffer indices = cache.get(size);
 		if (indices == null) {
 			
-			// Can be optimized
+			// TODO: Optimize it!
 			
 			indices = ByteBuffer.
 				allocateDirect( size * SIZE * Short.SIZE / 8 ).
diff --git a/PD-classes/src/com/watabou/noosa/BitmapText.java b/PD-classes/src/com/watabou/noosa/BitmapText.java
index 1602387..b2b3057 100644
--- a/PD-classes/src/com/watabou/noosa/BitmapText.java
+++ b/PD-classes/src/com/watabou/noosa/BitmapText.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import java.nio.FloatBuffer;
@@ -36,7 +37,7 @@ public class BitmapText extends Visual {
 	protected float[] vertices = new float[16];
 	protected FloatBuffer quads;
 	
-	protected int realLength;
+	public int realLength;
 	
 	protected boolean dirty = true;
 	
@@ -151,6 +152,10 @@ public class BitmapText extends Visual {
 			}
 		}
 		
+		if (length > 0) {
+			width -= font.tracking;
+		}
+		
 		dirty = false;
 		
 	}
diff --git a/PD-classes/src/com/watabou/noosa/BitmapTextMultiline.java b/PD-classes/src/com/watabou/noosa/BitmapTextMultiline.java
index 911684f..6eb991f 100644
--- a/PD-classes/src/com/watabou/noosa/BitmapTextMultiline.java
+++ b/PD-classes/src/com/watabou/noosa/BitmapTextMultiline.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import java.util.ArrayList;
@@ -78,6 +79,7 @@ public class BitmapTextMultiline extends BitmapText {
 					continue;
 				}
 				
+				
 				getWordMetrics( word, metrics );	
 				writer.addSymbol( metrics.x, metrics.y );
 				
diff --git a/PD-classes/src/com/watabou/noosa/Camera.java b/PD-classes/src/com/watabou/noosa/Camera.java
index adfeb5d..93500d3 100644
--- a/PD-classes/src/com/watabou/noosa/Camera.java
+++ b/PD-classes/src/com/watabou/noosa/Camera.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import java.util.ArrayList;
@@ -47,9 +48,10 @@ public class Camera extends Gizmo {
 	public PointF scroll;
 	public Visual target;
 	
-	private float shakeMagX = 10f;
-	private float shakeMagY = 10f;
-	private float shakeTime = 0f;
+	private float shakeMagX		= 10f;
+	private float shakeMagY		= 10f;
+	private float shakeTime		= 0f;
+	private float shakeDuration	= 1f;
 	
 	protected float shakeX;
 	protected float shakeY;
@@ -155,8 +157,9 @@ public class Camera extends Gizmo {
 		}
 		
 		if ((shakeTime -= Game.elapsed) > 0) {
-			shakeX = Random.Float( -shakeMagX, +shakeMagX );
-			shakeY = Random.Float( -shakeMagY, +shakeMagY );
+			float damping = shakeTime / shakeDuration;
+			shakeX = Random.Float( -shakeMagX, +shakeMagX ) * damping;
+			shakeY = Random.Float( -shakeMagY, +shakeMagY ) * damping;
 		} else {
 			shakeX = 0;
 			shakeY = 0;
@@ -224,6 +227,6 @@ public class Camera extends Gizmo {
 	
 	public void shake( float magnitude, float duration ) {
 		shakeMagX = shakeMagY = magnitude;
-		shakeTime = duration;
+		shakeTime = shakeDuration = duration;
 	}
 }
diff --git a/PD-classes/src/com/watabou/noosa/ColorBlock.java b/PD-classes/src/com/watabou/noosa/ColorBlock.java
index 2a39996..9d43755 100644
--- a/PD-classes/src/com/watabou/noosa/ColorBlock.java
+++ b/PD-classes/src/com/watabou/noosa/ColorBlock.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import com.watabou.gltextures.TextureCache;
diff --git a/PD-classes/src/com/watabou/noosa/Game.java b/PD-classes/src/com/watabou/noosa/Game.java
index f4e4d94..e021220 100644
--- a/PD-classes/src/com/watabou/noosa/Game.java
+++ b/PD-classes/src/com/watabou/noosa/Game.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import com.badlogic.gdx.ApplicationListener;
@@ -53,7 +54,7 @@ public abstract class Game<GameActionType> implements ApplicationListener {
 
 	// Current scene
 	protected Scene scene;
-	// New scene wea re going to switch to
+	// New scene we are going to switch to
 	protected Scene requestedScene;
 	// true if scene switch is requested
 	protected boolean requestedReset = true;
diff --git a/PD-classes/src/com/watabou/noosa/Gizmo.java b/PD-classes/src/com/watabou/noosa/Gizmo.java
index cba4025..a6d83a7 100644
--- a/PD-classes/src/com/watabou/noosa/Gizmo.java
+++ b/PD-classes/src/com/watabou/noosa/Gizmo.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 public class Gizmo {
diff --git a/PD-classes/src/com/watabou/noosa/Group.java b/PD-classes/src/com/watabou/noosa/Group.java
index e7ba9a7..719c988 100644
--- a/PD-classes/src/com/watabou/noosa/Group.java
+++ b/PD-classes/src/com/watabou/noosa/Group.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import com.badlogic.gdx.utils.reflect.ClassReflection;
@@ -25,7 +26,7 @@ public class Group extends Gizmo {
 	protected ArrayList<Gizmo> members;
 	
 	// Accessing it is a little faster, 
-	// than calling memebers.getSize(
+	// than calling memebers.getSize()
 	public int length;
 	
 	public Group() {
@@ -122,7 +123,6 @@ public class Group extends Gizmo {
 		}
 		
 		if (members.get( 0 ) == null) {
-			// Here we dond't try really hard to find an empty space...
 			members.set( 0, g );
 			g.parent = this;
 			return g;
@@ -138,15 +138,15 @@ public class Group extends Gizmo {
 
 		Gizmo g = getFirstAvailable( c );
 		if (g != null) {
-
+			
 			return g;
 			
 		} else if (c == null) {
-
+			
 			return null;
 			
 		} else {
-
+			
 			try {
 				return add( ClassReflection.newInstance(c) );
 			} catch (Exception e) {
diff --git a/PD-classes/src/com/watabou/noosa/Image.java b/PD-classes/src/com/watabou/noosa/Image.java
index 9f92f00..c529ce0 100644
--- a/PD-classes/src/com/watabou/noosa/Image.java
+++ b/PD-classes/src/com/watabou/noosa/Image.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import java.nio.FloatBuffer;
diff --git a/PD-classes/src/com/watabou/noosa/MovieClip.java b/PD-classes/src/com/watabou/noosa/MovieClip.java
index 0f5bcba..9808593 100644
--- a/PD-classes/src/com/watabou/noosa/MovieClip.java
+++ b/PD-classes/src/com/watabou/noosa/MovieClip.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import com.watabou.utils.RectF;
diff --git a/PD-classes/src/com/watabou/noosa/NinePatch.java b/PD-classes/src/com/watabou/noosa/NinePatch.java
index e88621a..7544ea7 100644
--- a/PD-classes/src/com/watabou/noosa/NinePatch.java
+++ b/PD-classes/src/com/watabou/noosa/NinePatch.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import java.nio.FloatBuffer;
diff --git a/PD-classes/src/com/watabou/noosa/NoosaScript.java b/PD-classes/src/com/watabou/noosa/NoosaScript.java
index dcec4d4..5858042 100644
--- a/PD-classes/src/com/watabou/noosa/NoosaScript.java
+++ b/PD-classes/src/com/watabou/noosa/NoosaScript.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import java.nio.FloatBuffer;
diff --git a/PD-classes/src/com/watabou/noosa/PseudoPixel.java b/PD-classes/src/com/watabou/noosa/PseudoPixel.java
index d4cdec6..96139d2 100644
--- a/PD-classes/src/com/watabou/noosa/PseudoPixel.java
+++ b/PD-classes/src/com/watabou/noosa/PseudoPixel.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import com.watabou.gltextures.TextureCache;
diff --git a/PD-classes/src/com/watabou/noosa/Resizable.java b/PD-classes/src/com/watabou/noosa/Resizable.java
index f686d37..9319386 100644
--- a/PD-classes/src/com/watabou/noosa/Resizable.java
+++ b/PD-classes/src/com/watabou/noosa/Resizable.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 public interface Resizable {
diff --git a/PD-classes/src/com/watabou/noosa/Scene.java b/PD-classes/src/com/watabou/noosa/Scene.java
index 350e4d1..7f18c27 100644
--- a/PD-classes/src/com/watabou/noosa/Scene.java
+++ b/PD-classes/src/com/watabou/noosa/Scene.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import com.badlogic.gdx.Input;
diff --git a/PD-classes/src/com/watabou/noosa/SkinnedBlock.java b/PD-classes/src/com/watabou/noosa/SkinnedBlock.java
index ca76eaa..2b8df95 100644
--- a/PD-classes/src/com/watabou/noosa/SkinnedBlock.java
+++ b/PD-classes/src/com/watabou/noosa/SkinnedBlock.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import com.badlogic.gdx.graphics.Texture.TextureWrap;
@@ -86,6 +87,14 @@ public class SkinnedBlock extends Image {
 		updateFrame();
 	}
 	
+	public float offsetX() {
+		return offsetX;
+	}
+	
+	public float offsetY() {
+		return offsetY;
+	}
+	
 	public void scale( float x, float y ) {
 		scaleX = x;
 		scaleY = y;
diff --git a/PD-classes/src/com/watabou/noosa/TextureFilm.java b/PD-classes/src/com/watabou/noosa/TextureFilm.java
index 9a3a61c..7a03778 100644
--- a/PD-classes/src/com/watabou/noosa/TextureFilm.java
+++ b/PD-classes/src/com/watabou/noosa/TextureFilm.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import java.util.HashMap;
diff --git a/PD-classes/src/com/watabou/noosa/Tilemap.java b/PD-classes/src/com/watabou/noosa/Tilemap.java
index 35b2ba4..d3eea25 100644
--- a/PD-classes/src/com/watabou/noosa/Tilemap.java
+++ b/PD-classes/src/com/watabou/noosa/Tilemap.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import java.nio.FloatBuffer;
diff --git a/PD-classes/src/com/watabou/noosa/TouchArea.java b/PD-classes/src/com/watabou/noosa/TouchArea.java
index 052384e..7052681 100644
--- a/PD-classes/src/com/watabou/noosa/TouchArea.java
+++ b/PD-classes/src/com/watabou/noosa/TouchArea.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import com.watabou.input.NoosaInputProcessor;
@@ -112,7 +113,7 @@ public class TouchArea<T> extends Visual implements Signal.Listener<NoosaInputPr
 				onTouchDown( touch );
 				
 			} else {
-
+				
 				onTouchUp( touch );
 				
 				if (this.touch == touch) {
@@ -123,7 +124,7 @@ public class TouchArea<T> extends Visual implements Signal.Listener<NoosaInputPr
 			}
 			
 		} else {
-
+			
 			if (touch == null && this.touch != null) {
 				onDrag( this.touch );
 			}
diff --git a/PD-classes/src/com/watabou/noosa/Visual.java b/PD-classes/src/com/watabou/noosa/Visual.java
index e535dc0..b5c92f8 100644
--- a/PD-classes/src/com/watabou/noosa/Visual.java
+++ b/PD-classes/src/com/watabou/noosa/Visual.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa;
 
 import com.watabou.glwrap.Matrix;
diff --git a/PD-classes/src/com/watabou/noosa/audio/Music.java b/PD-classes/src/com/watabou/noosa/audio/Music.java
index 2ad0c47..e1551ee 100644
--- a/PD-classes/src/com/watabou/noosa/audio/Music.java
+++ b/PD-classes/src/com/watabou/noosa/audio/Music.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.audio;
 
 import com.badlogic.gdx.Gdx;
diff --git a/PD-classes/src/com/watabou/noosa/audio/Sample.java b/PD-classes/src/com/watabou/noosa/audio/Sample.java
index 92d8d99..e641ab7 100644
--- a/PD-classes/src/com/watabou/noosa/audio/Sample.java
+++ b/PD-classes/src/com/watabou/noosa/audio/Sample.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.audio;
 
 import com.badlogic.gdx.Gdx;
diff --git a/PD-classes/src/com/watabou/noosa/particles/Emitter.java b/PD-classes/src/com/watabou/noosa/particles/Emitter.java
index e0592c0..b08a896 100644
--- a/PD-classes/src/com/watabou/noosa/particles/Emitter.java
+++ b/PD-classes/src/com/watabou/noosa/particles/Emitter.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.particles;
 
 import com.badlogic.gdx.Gdx;
@@ -38,13 +39,13 @@ public class Emitter extends Group {
 	protected float interval;
 	protected int quantity;
 	
-	protected int count;
-	protected float time;
-	
 	public boolean on = false;
 	
 	public boolean autoKill = true;
 	
+	protected int count;
+	protected float time;
+	
 	protected Factory factory;
 	
 	public void pos( float x, float y ) {
diff --git a/PD-classes/src/com/watabou/noosa/particles/PixelParticle.java b/PD-classes/src/com/watabou/noosa/particles/PixelParticle.java
index b11e76d..826ddb4 100644
--- a/PD-classes/src/com/watabou/noosa/particles/PixelParticle.java
+++ b/PD-classes/src/com/watabou/noosa/particles/PixelParticle.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.particles;
 
 import com.watabou.noosa.Game;
diff --git a/PD-classes/src/com/watabou/noosa/tweeners/AlphaTweener.java b/PD-classes/src/com/watabou/noosa/tweeners/AlphaTweener.java
index 1336146..f53e87f 100644
--- a/PD-classes/src/com/watabou/noosa/tweeners/AlphaTweener.java
+++ b/PD-classes/src/com/watabou/noosa/tweeners/AlphaTweener.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.tweeners;
 
 import com.watabou.noosa.Visual;
diff --git a/PD-classes/src/com/watabou/noosa/tweeners/CameraScrollTweener.java b/PD-classes/src/com/watabou/noosa/tweeners/CameraScrollTweener.java
index 03d4337..3edbccc 100644
--- a/PD-classes/src/com/watabou/noosa/tweeners/CameraScrollTweener.java
+++ b/PD-classes/src/com/watabou/noosa/tweeners/CameraScrollTweener.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.tweeners;
 
 import com.watabou.noosa.Camera;
diff --git a/PD-classes/src/com/watabou/noosa/tweeners/Delayer.java b/PD-classes/src/com/watabou/noosa/tweeners/Delayer.java
index eee340c..b8b99a7 100644
--- a/PD-classes/src/com/watabou/noosa/tweeners/Delayer.java
+++ b/PD-classes/src/com/watabou/noosa/tweeners/Delayer.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.tweeners;
 
 public class Delayer extends Tweener {
diff --git a/PD-classes/src/com/watabou/noosa/tweeners/PosTweener.java b/PD-classes/src/com/watabou/noosa/tweeners/PosTweener.java
index 3de28ca..1388708 100644
--- a/PD-classes/src/com/watabou/noosa/tweeners/PosTweener.java
+++ b/PD-classes/src/com/watabou/noosa/tweeners/PosTweener.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.tweeners;
 
 import com.watabou.noosa.Visual;
diff --git a/PD-classes/src/com/watabou/noosa/tweeners/ScaleTweener.java b/PD-classes/src/com/watabou/noosa/tweeners/ScaleTweener.java
index 32f2003..cc4bfaa 100644
--- a/PD-classes/src/com/watabou/noosa/tweeners/ScaleTweener.java
+++ b/PD-classes/src/com/watabou/noosa/tweeners/ScaleTweener.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.tweeners;
 
 import com.watabou.noosa.Visual;
diff --git a/PD-classes/src/com/watabou/noosa/tweeners/Tweener.java b/PD-classes/src/com/watabou/noosa/tweeners/Tweener.java
index 2fcf5fc..c94f490 100644
--- a/PD-classes/src/com/watabou/noosa/tweeners/Tweener.java
+++ b/PD-classes/src/com/watabou/noosa/tweeners/Tweener.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.tweeners;
 
 import com.watabou.noosa.Game;
diff --git a/PD-classes/src/com/watabou/noosa/ui/Button.java b/PD-classes/src/com/watabou/noosa/ui/Button.java
index 9074304..402001c 100644
--- a/PD-classes/src/com/watabou/noosa/ui/Button.java
+++ b/PD-classes/src/com/watabou/noosa/ui/Button.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.ui;
 
 import com.watabou.input.NoosaInputProcessor;
diff --git a/PD-classes/src/com/watabou/noosa/ui/CheckBox.java b/PD-classes/src/com/watabou/noosa/ui/CheckBox.java
index faf0efb..147e336 100644
--- a/PD-classes/src/com/watabou/noosa/ui/CheckBox.java
+++ b/PD-classes/src/com/watabou/noosa/ui/CheckBox.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.ui;
 
 public class CheckBox<T> extends Button<T> {
diff --git a/PD-classes/src/com/watabou/noosa/ui/Component.java b/PD-classes/src/com/watabou/noosa/ui/Component.java
index 1bb18a4..62c7b1b 100644
--- a/PD-classes/src/com/watabou/noosa/ui/Component.java
+++ b/PD-classes/src/com/watabou/noosa/ui/Component.java
@@ -14,6 +14,7 @@
  * You should have received a copy of the GNU General Public License
  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  */
+
 package com.watabou.noosa.ui;
 
 import com.watabou.noosa.Group;
diff --git a/PD-classes/src/com/watabou/utils/Bundle.java b/PD-classes/src/com/watabou/utils/Bundle.java
index e266acc..5db99e6 100644
--- a/PD-classes/src/com/watabou/utils/Bundle.java
+++ b/PD-classes/src/com/watabou/utils/Bundle.java
@@ -47,6 +47,10 @@ public class Bundle {
 		this( new JSONObject() );
 	}
 	
+	public String toString() {
+		return data.toString();
+	}
+	
 	private Bundle( JSONObject data ) {
 		this.data = data;
 	}
@@ -74,7 +78,7 @@ public class Bundle {
 	public String getString( String key ) {
 		return data.optString( key );
 	}
-
+	
 	public Bundle getBundle( String key ) {
 		return new Bundle( data.optJSONObject( key ) );
 	}
@@ -104,6 +108,14 @@ public class Bundle {
 		return getBundle( key ).get();	
 	}
 	
+	public <E extends Enum<E>> E getEnum( String key, Class<E> enumClass ) {
+		try {
+			return (E)Enum.valueOf( enumClass, data.getString( key ) );
+		} catch (JSONException e) {
+			return enumClass.getEnumConstants()[0];
+		}
+	}
+	
 	public int[] getIntArray( String key ) {
 		try {
 			JSONArray array = data.getJSONArray( key );
@@ -214,6 +226,15 @@ public class Bundle {
 		}
 	}
 	
+	public void put( String key, Enum<?> value ) {
+		if (value != null) {
+			try {
+				data.put( key, value.name() );
+			} catch (JSONException e) {
+			}
+		}
+	}
+	
 	public void put( String key, int[] array ) {
 		try {
 			JSONArray jsonArray = new JSONArray();
@@ -293,6 +314,17 @@ public class Bundle {
 		}
 	}
 	
+	public static Bundle read( byte[] bytes ) {
+		try {
+			
+			JSONObject json = (JSONObject)new JSONTokener( new String( bytes ) ).nextValue();
+			return new Bundle( json );
+			
+		} catch (JSONException e) {
+			return null;
+		}
+	}
+	
 	public static boolean write( Bundle bundle, OutputStream stream ) {
 		try {
 			BufferedWriter writer = new BufferedWriter( new OutputStreamWriter( stream ) );
-- 
2.1.2


From 3d958edba80bf12017b640cfe28b5e14dde724d1 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 06:35:06 -0400
Subject: [PATCH 07/13] Merged the unclean part of the PD-classes update

---
 PD-classes/src/com/watabou/gltextures/TextureCache.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/PD-classes/src/com/watabou/gltextures/TextureCache.java b/PD-classes/src/com/watabou/gltextures/TextureCache.java
index 7fa4495..0c92cfa 100644
--- a/PD-classes/src/com/watabou/gltextures/TextureCache.java
+++ b/PD-classes/src/com/watabou/gltextures/TextureCache.java
@@ -25,8 +25,8 @@ import java.util.HashMap;
 
 public class TextureCache {
 
-	private static HashMap<Object, SmartTexture> all = new HashMap<Object, SmartTexture>();
-
+	private static HashMap<Object,SmartTexture> all = new HashMap<Object, SmartTexture>();
+	
 	public static SmartTexture createSolid( int color ) {
 		String key = "1x1:" + color;
 		
-- 
2.1.2


From 845c02d0e02bba0f2e73fa89c949bfa53779a289 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 08:49:20 -0400
Subject: [PATCH 08/13] Removing immersive-mode stuff as it seems to be
 incompatible

---
 core/src/com/watabou/pixeldungeon/PixelDungeon.java       |  9 ---------
 core/src/com/watabou/pixeldungeon/Preferences.java        |  1 -
 .../src/com/watabou/pixeldungeon/windows/WndSettings.java | 15 ---------------
 3 files changed, 25 deletions(-)

diff --git a/core/src/com/watabou/pixeldungeon/PixelDungeon.java b/core/src/com/watabou/pixeldungeon/PixelDungeon.java
index f71089a..60d8144 100644
--- a/core/src/com/watabou/pixeldungeon/PixelDungeon.java
+++ b/core/src/com/watabou/pixeldungeon/PixelDungeon.java
@@ -235,15 +235,6 @@ public class PixelDungeon extends Game<GameAction> {
 		return Preferences.INSTANCE.getBoolean( Preferences.KEY_INTRO, true );
 	}
 	
-	@Override
-	public void onWindowFocusChanged( boolean hasFocus ) {
-		
-		super.onWindowFocusChanged( hasFocus );
-		
-		if (hasFocus) {
-			updateImmersiveMode();
-		}
-	}
 	
 	public static void switchNoFade( Class<? extends PixelScene> c ) {
 		PixelScene.noFade = true;
diff --git a/core/src/com/watabou/pixeldungeon/Preferences.java b/core/src/com/watabou/pixeldungeon/Preferences.java
index 2fba0c0..6be6bfe 100644
--- a/core/src/com/watabou/pixeldungeon/Preferences.java
+++ b/core/src/com/watabou/pixeldungeon/Preferences.java
@@ -24,7 +24,6 @@ public enum Preferences {
 	INSTANCE;
 
 	public static final String KEY_LANDSCAPE	= "landscape";
-	public static final String KEY_IMMERSIVE	= "immersive";
 	public static final String KEY_SCALE_UP		= "scaleup";
 	public static final String KEY_MUSIC		= "music";
 	public static final String KEY_SOUND_FX		= "soundfx";
diff --git a/core/src/com/watabou/pixeldungeon/windows/WndSettings.java b/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
index 467ec36..87af523 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
@@ -36,7 +36,6 @@ public class WndSettings extends Window {
 	private static final String TXT_ZOOM_DEFAULT	= "Default Zoom";
 
 	private static final String TXT_SCALE_UP		= "Scale up UI";
-	private static final String TXT_IMMERSIVE		= "Immersive mode";
 	
 	private static final String TXT_MUSIC	= "Music";
 	
@@ -62,7 +61,6 @@ public class WndSettings extends Window {
 	public WndSettings( boolean inGame ) {
 		super();
 		
-		CheckBox btnImmersive = null;
 		
 		if (inGame) {
 			int w = BTN_HEIGHT;
@@ -105,18 +103,6 @@ public class WndSettings extends Window {
 			btnScaleUp.checked( PixelDungeon.scaleUp() );
 			add( btnScaleUp );
 			
-			btnImmersive = new CheckBox( TXT_IMMERSIVE ) {
-				@Override
-				protected void onClick() {
-					super.onClick();
-					PixelDungeon.immerse( checked() );
-				}
-			};
-			btnImmersive.setRect( 0, btnScaleUp.bottom() + GAP, WIDTH, BTN_HEIGHT );
-			btnImmersive.checked( PixelDungeon.immersed() );
-			btnImmersive.enable( android.os.Build.VERSION.SDK_INT >= 19 );
-			add( btnImmersive );
-			
 		}
 		
 		CheckBox btnMusic = new CheckBox( TXT_MUSIC ) {
@@ -126,7 +112,6 @@ public class WndSettings extends Window {
 				PixelDungeon.music( checked() );
 			}
 		};
-		btnMusic.setRect( 0, (btnImmersive != null ? btnImmersive.bottom() : BTN_HEIGHT) + GAP, WIDTH, BTN_HEIGHT );
 		btnMusic.checked( PixelDungeon.music() );
 		add( btnMusic );
 		
-- 
2.1.2


From cd7e362525759e51215829fd6d46c43c3c4b6557 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 09:10:51 -0400
Subject: [PATCH 09/13] Fixed a typo and made some final changes for
 compatibility

---
 core/src/com/watabou/pixeldungeon/Dungeon.java            | 2 +-
 core/src/com/watabou/pixeldungeon/scenes/StartScene.java  | 4 ++--
 core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java | 2 --
 3 files changed, 3 insertions(+), 5 deletions(-)

diff --git a/core/src/com/watabou/pixeldungeon/Dungeon.java b/core/src/com/watabou/pixeldungeon/Dungeon.java
index f93365e..45981c9 100644
--- a/core/src/com/watabou/pixeldungeon/Dungeon.java
+++ b/core/src/com/watabou/pixeldungeon/Dungeon.java
@@ -466,7 +466,7 @@ public class Dungeon {
 		Bundle bundle = new Bundle();
 		bundle.put( LEVEL, level );
 		
-		OutputStream output = Game.instance.openFileOutput( Utils.format( depthFile( hero.heroClass ), depth ), Game.MODE_PRIVATE );
+		OutputStream output = Game.instance.openFileOutput( Utils.format( depthFile( hero.heroClass ), depth ) );
 		Bundle.write( bundle, output );
 		output.close();
 	}
diff --git a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
index d9342cb..c915171 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
@@ -134,7 +134,7 @@ public class StartScene extends PixelScene {
 				Game.switchScene( InterlevelScene.class );
 			}
 		};
-		add( btnLoad ); 
+		add( btnLoad );	
 		
 		HeroClass[] classes = {
 			HeroClass.WARRIOR, HeroClass.MAGE, HeroClass.ROGUE, HeroClass.HUNTRESS	
@@ -294,12 +294,12 @@ public class StartScene extends PixelScene {
 				text.y = align( y + (height - text.baseLine()) / 2 );
 			}
 		}
-	}
 		
 		public void secondary( String text ) {
 			secondary.text( text );
 			secondary.measure();
 		}
+	}
 	
 	private class ClassShield extends Button<GameAction> {
 		
diff --git a/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java b/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java
index 0acd80b..ade8584 100644
--- a/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java
+++ b/core/src/com/watabou/pixeldungeon/sprites/ItemSprite.java
@@ -141,8 +141,6 @@ public class ItemSprite extends MovieClip {
 	
 			speed.offset( (px-x) / DROP_INTERVAL, (py-y) / DROP_INTERVAL );
 			
-			Log.d( "GAME", toString() );
-			Log.d( "GAME", String.format( "drop aside: %.1f %.1f", speed.x, speed.y ) );
 		}
 	}
 	
-- 
2.1.2


From 31bc4bed33189dd35e4e01c33cf553f3e82a3a12 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 09:46:51 -0400
Subject: [PATCH 10/13] Updated version to 1.7.2a for iOS

---
 ios/robovm.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ios/robovm.properties b/ios/robovm.properties
index 5275d10..a0a53d1 100644
--- a/ios/robovm.properties
+++ b/ios/robovm.properties
@@ -1,6 +1,6 @@
 #Sat, 06 Sep 2014 12:33:01 +1000
 
-app.version=1.7.1c
+app.version=1.7.2a
 app.build=59
 app.name=Pixel Dungeon
 app.id=com.watabou.pixeldungeon
-- 
2.1.2


From 26934d2207b66c2a037f09cf96394204894b04d1 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 09:58:59 -0400
Subject: [PATCH 11/13] Fixed a bug I created when removing the immersive mode
 code

---
 core/src/com/watabou/pixeldungeon/windows/WndSettings.java | 1 +
 1 file changed, 1 insertion(+)

diff --git a/core/src/com/watabou/pixeldungeon/windows/WndSettings.java b/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
index 87af523..ad53fa3 100644
--- a/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
+++ b/core/src/com/watabou/pixeldungeon/windows/WndSettings.java
@@ -112,6 +112,7 @@ public class WndSettings extends Window {
 				PixelDungeon.music( checked() );
 			}
 		};
+		btnMusic.setRect( 0, BTN_HEIGHT + GAP, WIDTH, BTN_HEIGHT );
 		btnMusic.checked( PixelDungeon.music() );
 		add( btnMusic );
 		
-- 
2.1.2


From 6d13d0f33897ca1f4597f80230a88c4b297ec297 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 10:28:36 -0400
Subject: [PATCH 12/13] Fixed a mistake I made when merging that caused the
 char select bug

---
 core/src/com/watabou/pixeldungeon/scenes/StartScene.java | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
index c915171..2b323c3 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
@@ -378,7 +378,12 @@ public class StartScene extends PixelScene {
 		public void update() {
 			super.update();
 			
-			Sample.INSTANCE.play( Assets.SND_CLICK, 1, 1, 1.2f );
+			if (brightness < 1.0f && brightness > MIN_BRIGHTNESS) {
+				if ((brightness -= Game.elapsed) <= MIN_BRIGHTNESS) {
+					brightness = MIN_BRIGHTNESS;
+				}
+				updateBrightness();
+			}
 		}
 		
 		public void highlight( boolean value ) {
-- 
2.1.2


From 61eb40b0f8bf6a78268b8334ae32b7b01f894be5 Mon Sep 17 00:00:00 2001
From: Kevin MacMartin <prurigro@gmail.com>
Date: Thu, 16 Oct 2014 10:40:30 -0400
Subject: [PATCH 13/13] This fixes last commit, which should have been a move
 instead of a copy

---
 core/src/com/watabou/pixeldungeon/scenes/StartScene.java | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
index 2b323c3..605c92b 100644
--- a/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
+++ b/core/src/com/watabou/pixeldungeon/scenes/StartScene.java
@@ -365,12 +365,7 @@ public class StartScene extends PixelScene {
 			emitter.revive();
 			emitter.start( Speck.factory( Speck.LIGHT ), 0.05f, 7 );
 			
-			if (brightness < 1.0f && brightness > MIN_BRIGHTNESS) {
-				if ((brightness -= Game.elapsed) <= MIN_BRIGHTNESS) {
-					brightness = MIN_BRIGHTNESS;
-				}
-				updateBrightness();
-			}
+			Sample.INSTANCE.play( Assets.SND_CLICK, 1, 1, 1.2f );
 			updateClass( cl );
 		}
 		
-- 
2.1.2

