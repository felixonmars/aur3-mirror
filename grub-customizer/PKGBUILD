# Maintainer: David Runge <david.runge@frqrec.com>
pkgname=grub-customizer
pkgver=2.5.4
pkgbranch=2.5
pkgrel=1
pkgdesc="Customize the bootloader (GRUB2 or BURG)"
url="https://launchpad.net/grub-customizer"
arch=('i686' 'x86_64')
license=("GPL3")
depends=('gettext' 'gtkmm' 'openssl' 'hicolor-icon-theme' 'gksu')
optdepends=('hwinfo')
makedepends=('cmake')
provides=(grub-customizer)
backup=('etc/grub-customizer/grub.cfg')
options=()
install='grub-customizer.install'
source=("http://launchpad.net/${pkgname}/${pkgbranch}/${pkgver}/+download/${pkgname}_${pkgver}.tar.gz")
md5sums=('4c7fa54e6a495fef658ea831809b6ff2')

build() {
cd ${srcdir}/
msg "Starting make..."
cmake .&& make
make install DESTDIR=${pkgdir} || return 1

msg "Converting Ubuntu package"
cd ${pkgdir}/usr/local/
mv bin ${pkgdir}/usr
mv lib ${pkgdir}/usr
mv share/* ${pkgdir}/usr/share
cd ${pkgdir}/usr
rm -r local
sed -i '/^Exec=/s/grub-customizer$/gksu\ grub-customizer/' share/applications/grub-customizer.desktop
sed -i '/^X-Ubuntu/d' share/applications/grub-customizer.desktop

msg "Creating Arch specific config"
install -d ${pkgdir}/etc/grub-customizer
cd ${pkgdir}/etc/grub-customizer/
echo "MKCONFIG_CMD=grub-mkconfig" >> grub.cfg
echo "UPDATE_CMD=grub-mkconfig -o /boot/grub/grub.cfg" >> grub.cfg
echo "INSTALL_CMD=grub-install" >>grub.cfg
echo "MKFONT_CMD=grub-mkfont" >>grub.cfg
echo "CFG_DIR=/etc/grub.d" >>grub.cfg
echo "OUTPUT_DIR=/boot/grub" >>grub.cfg
echo "OUTPUT_FILE=/boot/grub/grub.cfg" >>grub.cfg
echo "SETTINGS_FILE=/etc/default/grub" >>grub.cfg
}
# vim:set ts=2 sw=2 et:
