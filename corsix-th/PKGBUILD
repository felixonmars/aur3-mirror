# Maintainer: Gaetan Bisson <bisson@archlinux.org>

pkgname=corsix-th
pkgver=Beta8
pkgrel=2
pkgdesc='Reimplementation of the game engine of Theme Hospital'
arch=('i686' 'x86_64')
url='http://corsix-th.googlecode.com/'
license=('MIT')
depends=('lua' 'sdl_mixer' 'sdl_ttf' 'timidity++')
makedepends=('cmake')
source=("${url}files/CorsixTH-${pkgver}-Source.tar.gz"
        'bin')
sha1sums=('c3110004703a1607d0b720950e0d2933bc5c6abe'
          '7fd6ae8db366b7f9c4671708e8ea7beb48f1bea3')

install=install

build() {
	cd "${srcdir}/CorsixTH"
	cmake \
		-D CMAKE_INSTALL_PREFIX=/usr/share/ \
		-D CMAKE_BUILD_TYPE=Release \
		-D WITH_FREETYPE2=ON \
		-Wno-dev .
}

package() {
	cd "${srcdir}/CorsixTH"
	make DESTDIR="${pkgdir}" install
	install -Dm755 ../bin "${pkgdir}/usr/bin/CorsixTH"
	install -Dm644 CorsixTH/LICENSE.txt "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"

	sed -i 's/games/share/g' DebianPackage/usr/share/applications/CorsixTH.desktop
	install -Dm644 DebianPackage/usr/share/applications/CorsixTH.desktop "${pkgdir}/usr/share/applications/CorsixTH.desktop"
}
