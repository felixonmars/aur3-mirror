# Maintainer: Julian Labus <belzebub40k at gmail dot com>

pkgname=tvheadend
pkgver=3.2.18
pkgrel=2
pkgdesc="TV streaming server for Linux"
arch=('i686' 'x86_64')
url="http://www.lonelycoder.com/hts/tvheadend_overview.html"
license=('GPL3')
depends=('avahi' 'openssl' 'python2' 'systemd')
optdepends=('xmltv: For an alternative source of programme listings')
provides=('tvheadend')
conflicts=('tvheadend-git')
install=tvheadend.install
source=("https://github.com/downloads/tvheadend/tvheadend/${pkgname}-${pkgver}.tar.gz"
        'tvheadend.service')
md5sums=('e1cf63cf2ae8b000e77eb313968f6b7b'
         'd6860adb7464db26fb94b69b10846e86')

build() {
  cd ${srcdir}/${pkgname}-${pkgver}
  ./configure --prefix=/usr --python=python2.7 --release
  make
}

package() {
  cd ${srcdir}/${pkgname}-${pkgver}

  # Install binary
  make DESTDIR="$pkgdir/" install

  # Install systemd service
  install -D -m 644 "$srcdir/tvheadend.service" "$pkgdir/usr/lib/systemd/system/tvheadend.service"
}
