# Maintainer: Jonathan Lestrelin <zanko@daemontux.org>
pkgname=media-explorer
pkgver=0.1.0
pkgrel=6
pkgdesc="Media Explorer is a media centre application for Linux (including MeeGo)."
arch=('i686' 'x86_64')
url="http://media-explorer.github.com/"
license=('LGPL')
depends=('gtk-doc' 'mx-1.1' 'rest' 'hicolor-icon-theme' ' xdg-utils' 'grilo' 'grilo-plugins' 'udev' 'gnome-desktop2' 'libxtst' 'clutter-gst') 
makedepends=('gnome-common' 'intltool' 'pkg-config')
source=(https://github.com/media-explorer/${pkgname}/tarball/${pkgver})
install=media-explorer.install
sha256sums=('31f9358980586ad67f39021bbfd60d8ad2e7aec3c1ef01f28724307d65a08fc5')

build() {
  cd "${srcdir}"/${pkgname}*

  #Dirty stuff...
  sed -i -e "s#python#python2.7#" mex/Makefile* applets/rebinder/Makefile*
  sed -i -e "s/#include \"mex-version.h\"//" shell/mex-main.c
  sed -i -e "s#data.version = mx_label_new_with_text#//data.version = mx_label_new_with_text#" shell/mex-main.c

  ./autogen.sh --prefix=/usr --sysconfdir=/etc
  make
}

package() {
  cd "${srcdir}"/${pkgname}*

  DESTDIR=${pkgdir} make install

  #Dirty stuff again to avoid name clashes with texlive-bin
  mv ${pkgdir}/usr/bin/mex ${pkgdir}/usr/bin/mexp
  sed -i -e "s/mex/mexp/g" ${pkgdir}/usr/share/applications/mex.desktop
}
