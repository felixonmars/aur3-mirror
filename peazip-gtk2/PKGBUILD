# Maintainer: TuxSpirit<tuxspiritATarchlinuxDOTfr> 

pkgname=peazip-gtk2 
pkgver=3.8
_namefile=peazip-$pkgver.LINUX.GTK2
_namedest=peazip
pkgrel=1
pkgdesc="GTK2 archiver utility (FINAL VERSION)" 
arch=('i686' 'x86_64')
url="http://www.peazip.org/peazip-linux.html" 
license=('LGPL') 
depends=('gcc-libs' 'gdk-pixbuf2' 'p7zip' 'quad' 'balz' 'unace' 'upx' 'curl' 'gmp' 'gtk2') 
replaces=('peazip-portable-gtk2' 'peazip-portable-beta-gtk2' 'peazip-beta-gtk2') 
conflicts=('peazip-portable-gtk2' 'peazip-gtk1' 'peazip-portable-gtk1' 'peazip-portable-gtk2' 'peazip-portable-qt' 'peazip-beta-qt' 'peazip-qt') 
install=${pkgname}.install
source=(http://peazip.googlecode.com/files/$_namefile.tgz)

md5sums=('d7eba081c2dd616f970cc658cc0d5cba')
        
build() { 
    
  # Addtional structures  
  install -d -m 755 ${pkgdir}/usr/lib/${_namedest}/res 
  install -d -m 755 ${pkgdir}/usr/lib/${_namedest}/res/{7z,arc,icons,lang,lpaq,paq,quad,themes,unace,upx,zpaq} 
  install -d -m 755 ${pkgdir}/usr/lib/${_namedest}/res/7z/Codecs 
  install -d -m 755 ${pkgdir}/usr/lib/${_namedest}/res/themes/{firecrystal,nographic} 
  
  #Program
  install -D -m 755 ${srcdir}/usr/local/share/PeaZip/peazip ${pkgdir}/usr/lib/${_namedest}/peazip

  # Additional files
  # res 
  install -m 755 ${srcdir}/usr/local/share/PeaZip/res/{altconf.txt,pea,pealauncher,rnd} ${pkgdir}/usr/lib/${_namedest}/res 
  install -m 644 ${srcdir}/usr/local/share/PeaZip/peazip_help.pdf ${pkgdir}/usr/lib/${_namedest}/res/peazip_help.pdf
 
  # icons
  install -m 644 ${srcdir}/usr/local/share/icons/peazip.png ${pkgdir}/usr/lib/${_namedest}/res/icons/peazip.png

  # Lang 
  install -m 644 ${srcdir}/usr/local/share/PeaZip/res/lang/* ${pkgdir}/usr/lib/${_namedest}/res/lang/ 
  
  # arc
  install -m 755 ${srcdir}/usr/local/share/PeaZip/res/arc/arc* ${pkgdir}/usr/lib/${_namedest}/res/arc/ 
  install -m 755 ${srcdir}/usr/local/share/PeaZip/res/arc/freearc* ${pkgdir}/usr/lib/${_namedest}/res/arc/  

  # lpaq 
  install -m 755 ${srcdir}/usr/local/share/PeaZip/res/lpaq/lpaq* ${pkgdir}/usr/lib/${_namedest}/res/lpaq/ 

  # paq 
  install -m 755 ${srcdir}/usr/local/share/PeaZip/res/paq/paq* ${pkgdir}/usr/lib/${_namedest}/res/paq/ 

  # Theme - firecrystal
  install -m 644 ${srcdir}/usr/local/share/PeaZip/res/themes/firecrystal/* ${pkgdir}/usr/lib/${_namedest}/res/themes/firecrystal/ 
  #       - nographic
  install -m 644 ${srcdir}/usr/local/share/PeaZip/res/themes/nographic/* ${pkgdir}/usr/lib/${_namedest}/res/themes/nographic/

  # zpac
  install -m 644 ${srcdir}/usr/local/share/PeaZip/res/zpaq/* ${pkgdir}/usr/lib/${_namedest}/res/zpaq/

  # Users - Desktop 
  install -D -m 644 ${srcdir}/usr/local/share/applications/peazip.desktop ${pkgdir}/usr/share/applications/peazip.desktop 
  
  #Fix peazip.desktop : icon, name
  sed -i "s|Icon=peazip.png|Icon=/usr/lib/peazip/res/icons/peazip.png|" ${pkgdir}/usr/share/applications/peazip.desktop || return 1
  sed -i "s|peazip.desktop|PeaZip|" ${pkgdir}/usr/share/applications/peazip.desktop || return 1

} 

