# Contributor: graysky <graysky AT archlinux dot us>
pkgname=linpack
pkgver=10.3.4.007
pkgvershort=10.3.4
pkgrel=1
pkgdesc='Benchmark and stability test based on linear algebra. Intel CPUs only.'
arch=('i686' 'x86_64')
source=(http://registrationcenter-download.intel.com/akdlm/irc_nas/2169/l_lpk_p_$pkgver.tgz \
lininput.template runme.template)
license=('custom')
url="http://software.intel.com/en-us/articles/intel-math-kernel-library-linpack-download"

install=('readme.install')

build() {
if [ "$CARCH" = "x86_64" ]; then
 bit=64
else
 bit=32
fi

eval "sed -e 's/TT/$bit/g' <runme.template >linpack_runme_xeon$bit"
install -D -m755 linpack_runme_xeon${bit} ${pkgdir}/usr/bin/linpack_runme_xeon${bit}
install -D -m644 lininput.template ${pkgdir}/etc/lininput_xeon${bit}

cd $srcdir/${pkgname}_${pkgvershort}/doc
install -D -m644 lpkEULA.txt ${pkgdir}/usr/share/licenses/${pkgname}/lpkEULA.txt
install -D -m644 lpksupport.txt ${pkgdir}/usr/share/doc/${pkgname}/lpksupport.txt
install -D -m644 userguide.pdf ${pkgdir}/usr/share/doc/${pkgname}/userguide.pdf

cd $srcdir/${pkgname}_${pkgvershort}/benchmarks/linpack
install -D -m644 xhelp.lpk ${pkgdir}/usr/share/doc/${pkgname}/xhelp.lpk
install -D -m755 linpack_runme_xeon${bit} ${pkgdir}/usr/bin/linpack_runme_xeon${bit}
install -D -m755 xlinpack_xeon${bit} ${pkgdir}/usr/bin/xlinpack_xeon${bit}
}
sha256sums=('20614ebe460588de28e60d04d885cb4e8dac30e45dd0a0f8b34925225380f3b0'
            '0e42a99435c2868db007be6df7334f60213fb34d591cc557891a67b40e5f2862'
            'defdf56eac12cd607b3d153584fe935d344a5e4b31a7492d25ac154da513e0c5')
