# Maintainer: Adrien Sohier <adrien.sohier@art-software.fr>

pkgname=visound_sfml-git
_gitname=visound
_gitrepo="http://git.art-software.fr/git"
pkgver=0.1.6
pkgrel=1
pkgdesc="Modular Sound Visualizer"

arch=('i686' 'x86_64' 'armv6h')
url="http://www.art-software.fr/index.php"
license=(GPLv3)
source=("git+${_gitrepo}/${_gitname}.git")
md5sums=(SKIP)

depends=('csfml>=2.1')
makedepends=('git')
conflicts=('visoun_sdl-git' 'visound_sdl2-git')


build() {
	cd ${srcdir}/${_gitname}
	git checkout $(git tag|sort -V|tail -1)
	mkdir build

	pushd build &&
	cmake .. -DCMAKE_BUILD_TYPE=Release -DBACKEND=SFML2 &&
	make clean &&
	make &&
	popd
}

pkgver() {
	cd ${srcdir}/${_gitname}
	git tag|sort -V|tail -1|tr "-" "."|sed "s@^v@@"
}

package() {
	cd ${srcdir}/${_gitname}
	install -dm755 ${pkgdir}/usr/bin
	install -dm755 ${pkgdir}/usr/share/man/man1

	install -m755 bin/vs ${pkgdir}/usr/bin/
	install -m644 doc/man/vs.1 ${pkgdir}/usr/share/man/man1/
}
