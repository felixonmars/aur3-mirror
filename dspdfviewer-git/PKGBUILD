# Maintainer: rich_o <rich_o@lavabit.com>

pkgname=dspdfviewer-git
pkgver=20121210
pkgrel=2
pkgdesc="Viewer for latex-beamer presentations that are built with the «show notes on second screen»-option"
arch=('i686' 'x86_64')
url="https://github.com/dannyedel/dspdfviewer"
license=('unknown')
depends=('boost-libs' 'poppler-qt')
makedepends=('git' 'cmake' 'boost')
conflicts=('dspdfviewer')

_gitroot=git://github.com/dannyedel/dspdfviewer.git
_gitname=dspdfviewer

build() {
    cd "$srcdir"
    msg "Connecting to GIT server...."

    if [[ -d "$_gitname" ]]; then
        cd "$_gitname" && git pull origin
        msg "The local files are updated."
    else
        git clone "$_gitroot" "$_gitname"
        cd $_gitname
        git submodule init
    fi
    git submodule update

    msg "GIT checkout done or server timeout"
    msg "Starting build..."

    [[ -d build ]] || mkdir build
    cd build
    cmake -DCMAKE_INSTALL_PREFIX="/usr/" -DSYSCONFDIR="/etc" -DCMAKE_BUILD_TYPE=Release ../ 
    make
    make DESTDIR="$pkgdir" install
}

package() {
    cd "$srcdir/$_gitname/build"
    make DESTDIR="$pkgdir" install
}

# vim:set ts=2 sw=2 et:

