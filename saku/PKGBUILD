# Maintainer: 10sr <your email>

# TODO: fix config.py (add patch? or add /etc/saku.ini?)

pkgname=saku
pkgver=4.2.0
pkgrel=1
pkgdesc="A clone of P2P anonymous BBS shinGETsu"
arch=('any')
url="http://shingetsu.info/saku"
license=('2-clause BSD license')
#groups=allyourbase

depends=('python' 'python-jinja' 'python-markupsafe')
optdepends=('python-pillow: Python Imaging Library')

#provides=('lol-git')
#conflicts=('pyful-git')

install=$pkgname.install

source=(
    "http://shingetsu.info/saku/$pkgname-$pkgver.tar.gz"
    "$pkgname.service"
    "defaultpath.patch"
)
md5sums=('418fc5d2b7efaa376145aa1d9fcc208a'
         '405694a84e66e6043bb61188d5e766ac'
         '094ae2d9e64e0d445c616fae22b19051')

prepare(){
    cd "$srcdir"/$pkgname-$pkgver
    patch -p1 <../defaultpath.patch
}

package(){
    cd "$srcdir"/$pkgname-$pkgver
    make clean
    python3 setup.py install --root="$pkgdir"

    install -Dvm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
    install -Dvm644 ../$pkgname.service \
        "$pkgdir"/usr/lib/systemd/system/$pkgname.service
}
